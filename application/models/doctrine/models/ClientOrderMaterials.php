<?php

/**
 * ClientOrderMaterials
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ISPC
 * @subpackage Application (2018-12-13)
 * @author     carmen <office@originalware.com>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class ClientOrderMaterials extends BaseClientOrderMaterials
{
	/**
	 * define the FORMID and FORMNAME, if you want to piggyback some triggers
	 * @var unknown
	 */
	const TRIGGER_FORMID    = null;
	const TRIGGER_FORMNAME  = '';
	
	public function client_order_materials_by_category($clientid = null, $category = null)
	{
	    $client_is_follower  = ConnectionMasterTable::_check_client_connection_follower2category('ClientOrderMaterials',$clientid,$category);
	    
		$actions_sql = Doctrine_Query::create()
		->select('*')
		->from('ClientOrderMaterials')
		->where('clientid =?', $clientid)
		->andWhere('category =?', $category);
		if($client_is_follower){
		    $actions_sql->andWhere('connection_id is NOT null');
		    $actions_sql->andWhere('master_id is NOT null');
		}
		$actions_sql->andWhere("isdelete = 0");//  ISPC-2464 Ancuta 01.11.2019
		
		$actionsarray = $actions_sql->fetchArray();
	
		if($actionsarray)
		{
			return $actionsarray;
		}
	}

}