<?php

/**
 * InvoiceSystemItems
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ISPC
 * @subpackage Application (2018-06-19)
 * @author     Ancuta <office@originalware.com>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class InvoiceSystemItems extends BaseInvoiceSystemItems
{

		public function getInvoicesItems($invoice_type = false, $invoices, $separate_custom = false)
		{
		    if( ! $invoice_type || empty($invoices)){
		        return false;
		    }
		    
			$invoice_items = Doctrine_Query::create()
				->select('*')
				->from('InvoiceSystemItems')
				->whereIn('invoice', $invoices)
				->andWhere('invoice_type = ?',$invoice_type)
				->andWhere('isdelete="0"')
				->orderBy('id ASC');
			$invoice_items_res = $invoice_items->fetchArray();

			if($invoice_items_res)
			{ 
				
				foreach($invoice_items_res as $k_invoice_item => $v_invoice_item)
				{
					$v_invoice_item['description'] = html_entity_decode($v_invoice_item['description'], ENT_QUOTES, 'UTF-8');
					$v_invoice_item['shortcut'] = html_entity_decode($v_invoice_item['shortcut'], ENT_QUOTES, 'UTF-8');
					
					$invoice_items_arr[$v_invoice_item['invoice']][] = $v_invoice_item;
				}
				
				return $invoice_items_arr;
				
			}
			else
			{
				return false;
			}
		}
 

	}