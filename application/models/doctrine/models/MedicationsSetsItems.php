<?php

/**
 * MedicationsSetsItems
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ISPC
 * @subpackage Application (2018-10-26)
 * @author     carmen <office@originalware.com>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class MedicationsSetsItems extends BaseMedicationsSetsItems
{
	/**
	 * define the FORMID and FORMNAME, if you want to piggyback some triggers
	 * @var unknown
	 */
	const TRIGGER_FORMID    = null;
	const TRIGGER_FORMNAME  = '';
	
	public function findOrCreateOneById($bid = 0 , array $data = array(), $save = false, $hydrationMode = Doctrine_Core::HYDRATE_RECORD)
	{
			if ( !empty($bid))
			{
				$entity = $this->getTable()->findBy('bid', $bid, Doctrine_Core::HYDRATE_RECORD);
				return $entity;
			}
			else
			{
				return;
			}
	}
	
	public function get_medications_by_set($bid = null)
	{
		$actions_sql = Doctrine_Query::create()
		->select('*')
		->from('MedicationsSetsItems')
		->where('bid =?', $bid);
	
		$actionsarray = $actions_sql->fetchArray();
	
		if($actionsarray)
		{
			return $actionsarray;
		}
	}
	
	public function get_medications_group_by_set()
	{
		$actions_sql = Doctrine_Query::create()
		->select('*, count(*) as entries')
		->from('MedicationsSetsItems')
		->groupBy('bid');
	
		$actionsarray = $actions_sql->fetchArray();
	
		if($actionsarray)
		{
			return $actionsarray;
		}
	}
	
	public function get_all_sets_medications($clientid = null)
	{
		$actions_sql = Doctrine_Query::create()
		->select('*')
		->from('MedicationsSetsItems si')
		->leftJoin('si.MedicationsSetsList sl ON sl.id = si.bid')
		->where('sl.clientid =?', $clientid);
		
		$actionsarray = $actions_sql->fetchArray();
	
		if($actionsarray)
		{
			return $actionsarray;
		}
	}

}