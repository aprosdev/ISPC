<?php

/**
 * WlAssessment
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ISPC
 * @subpackage Application (2017-12-12)
 * @author     claudiu <office@originalware.com>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class WlAssessment extends BaseWlAssessment
{
    /**
     * translations are grouped into an array
     * @var unknown
     */
    const LANGUAGE_ARRAY    = 'wlassessment_lang';
    
    /**
     * define the FORMID and FORMNAME, if you want to piggyback some triggers
     * @var unknown
     */
    const TRIGGER_FORMID    = null;
    const TRIGGER_FORMNAME  = 'frmWlAssessment_2017';
    
    /**
     * insert into patient_files will use this 
     */
    const PATIENT_FILE_TABNAME  = 'wlassessment_ispc2070';
    const PATIENT_FILE_TITLE    = 'Wlassessment_PDF 2017'; //this will be translated
    
    /**
     * insert into patient_course will use this
     */
    //const PATIENT_COURSE_TITLE      = 'Wlassessment_PDF 2017 was created';
    const PATIENT_COURSE_TITLE      = 'Wlassessment_PDF 2017 wurde erstellt';           //TODO-3930 Lore 08.03.2021
    
    const PATIENT_COURSE_TABNAME    = 'WlAssessment';
    const PATIENT_COURSE_TYPE       = 'F';
    
    
    
    /**
     * @claudiu
     * @param string $fieldName
     * @param unknown $value
     * @param array $data
     * @param unknown $hydrationMode
     * @return Doctrine_Record
     */
    public function findOrCreateOneBy($fieldName = '', $value = null, array $data = array(), $hydrationMode = Doctrine_Core::HYDRATE_RECORD)
    {
        if ( is_null($value) || ! $entity = $this->getTable()->findOneBy($fieldName, $value, $hydrationMode)) {
            
            if ($fieldName != $this->getTable()->getIdentifier()) {
                $entity = $this->getTable()->create(array( $fieldName => $value));
            } else {
                $entity = $this->getTable()->create();
            }
        }
        
        $entity->fromArray($data); //update
    
        $entity->save(); //at least one field must be dirty in order to persist
    
        return $entity;
    }
    
    
    public function findOrCreateOneByIdAndIpid($id = 0 , $ipid = '', array $data = array(), $hydrationMode = Doctrine_Core::HYDRATE_RECORD)
    {
        if ( empty($id) || ! $entity = $this->getTable()->findOneByIdAndIpid($id, $ipid)) {
                
            $entity = $this->getTable()->create(array( 'ipid' => $ipid));            
        }
        
        unset($data[$this->getTable()->getIdentifier()]);
        
        $entity->fromArray($data); //update
    
        $entity->save(); //at least one field must be dirty in order to persist
    
        return $entity;
    }
    
    
    
    /**
     * @claudiu
     * @param string $ipid
     * @param unknown $hydrationMode
     * @return void|Ambigous <Doctrine_Collection, multitype:>
     */
    public function findByIpid( $ipid = '', $hydrationMode = Doctrine_Core::HYDRATE_ARRAY )
    {
        if (empty($ipid) || ! is_string($ipid)) {
    
            return;
    
        } else {
            return $this->getTable()->findBy('ipid', $ipid, $hydrationMode);
    
        }
    }
}