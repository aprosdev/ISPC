<!-- Maria:: Migration ISPC to CISPC 08.08.2020 -->
<?php
/*
 * $this->clientModules is an array with all allowed modules... 
 */

$this->headScript()->appendFile(RES_FILE_PATH.'/javascript/livesearch/patientcourse.js?'.date('Ymd'));
$this->headScript()->appendFile(RES_FILE_PATH.'/javascript/autogrow/jquery.elastic.source_new.js?'.date('Ymd'));
//$this->headScript()->appendFile(RES_FILE_PATH.'/javascript/jquery.blockUI.js?'.date('Ymd'));
$this->headScript()->appendFile(RES_FILE_PATH.'/javascript/ias/jquery.ias.js?'.date('Ymd'));
if ($this->module_al == "1") {$this->headScript()->appendFile(RES_FILE_PATH.'/javascript/livesearch/settlement_services.js?'.date('Ymd'));}

/*
$this->headScript()->appendFile(RES_FILE_PATH.'/javascript/chosen_v1.6.2/chosen.jquery.js');
$this->headLink()->appendStylesheet(RES_FILE_PATH.'/javascript/chosen_v1.6.2/chosen_2016.09.22.css');
*/

$this->headLink()->appendStylesheet(RES_FILE_PATH.'/css/page-css/patient_course_new.css?'.date('Ymd'));
//ISPC-2486  Ancuta 20.11.2019
?>
<style type="text/css">
.ui-datepicker-trigger {
	padding-left: 2px;
	padding-top: 8px;
	margin-bottom: -4px;
	float: left;
}
</style>
<script type="text/javascript">
	var jscount = "1";
	var jcount = "1";
	var ltrjs = <?php echo $this->ltrjs ?>;
	var hotkeysjs = <?php echo $this->hotkeysjs ?>;
	var filterkeysjs = <?php echo $this->filterkeysjs ?>;
	var isdischarged = "<?php echo $this->isdischarged ?>";
	var jarr = <?php echo $this->jdarr ?>;
	var jsdiagnosismeta = <?php echo $this->jsdiagnosismeta?>;
	var jcount = jscount+1;
	var dcntr = jscount;
	var diagnosisblur = Array();
	var icddiagnosisblur = Array();
	var diagnosisblur_ed = Array();
	var $disable_hs_insert = '<?php echo $this->disable_hs_insert; ?>';
    var moduleprivl = "<?php echo $this->modulepriv_l ?>";
    var module_le = "<?php echo $this->module_le ?>";
	var module_sd = '<?php echo $this->module_sd; ?>';
	var module_al = '<?php echo $this->module_al; ?>';
	var module_xs = '<?php echo $this->module_xs; ?>';
	var module_xe = '<?php echo $this->module_xe; ?>';
	var module_vo_ve = '<?php echo $this->module_vo_ve; ?>';
	
	var module_pk = '<?php echo $this->module_pk; ?>';
	var module_xn = '<?php echo $this->module_xn; ?>';
	
	var module203_rlp_special_sh = '<?php echo $this->module203_rlp_special_sh; ?>';
	var module209_demstepcare_special_sh = '<?php echo $this->module209_demstepcare_special_sh; ?>';
	var module_ml = '<?php echo $this->module_ml; ?>';
	
	//TODO-2942 Carmen 24.02.2020 shortcut xm, xh like xt and xg like v
	var module_xm = '<?php echo $this->module_xm; ?>';
	var module_xh = '<?php echo $this->module_xh; ?>';
	var module_xg = '<?php echo $this->module_xg; ?>';
	//--
	
	var module_lysocare = '<?=(int)$this->clientModules[182]?>';
	var module_takinghint = '<?=(int)$this->clientModules[230]?>'; //ISPC-2554 Carmen 17.06.2020
	var inputExtra = '';
	var inputExtraAtc = ''; //ISPC-2554 pct.3 Carmen 31.03.2020
	var inputExtraPzn = ''; //ISPC-2329 Ancuta 03.04.2020
	var inputExtraDBF_id = ''; //ISPC-2329 Ancuta 03.04.2020
	var inputExtraDosage_form = ''; //ISPC-2554 Carmen 14.05.2020
	var inputExtraUnit = ''; //ISPC-2554 Carmen 14.05.2020

	var module_wt = '<?=(int)$this->clientModules[252]?>';		//TODO-3897 Lore 15.03.2021

	var module_companion_xt = '<?=(int)$this->clientModules[255]?>';		//ISPC-2902 Lore 27.04.2021

	//TODO-3365 Carmen 21.08.2020
    var js_pharmaindex_settings = <?php echo $this->js_pharmaindex_settings ?>;
    //--
	$('.anlage').each(function() {
		$(this).parent().parent().parent().parent().prev().remove(); //remove all anlage checkboxes
		$(this).remove(); // remove the curent selector to avoid conflicts
	});

	function isInteger(k, edit)
	{
	    var box = '';
	    if(edit == 1) {
			box = 'edit_value';
	    } else {
			box = 'sym_value';
	    }
		
	    var s = document.getElementById(box+k).value;
	    var chars = "0123456789";

	    if(s>10) {
			document.getElementById(box+k).value = "";
			return false;
	    }

	    var i;
	    s = s.toString();
	    for (i = 0; i < s.length; i++) {
			var c = s.charAt(i);
			if (chars.indexOf(c)==-1) {
				document.getElementById(box+k).value = "";
				return false;
			}
	    }
	    return true;
	}


	function chkmask(ltr,cnt)
	{
		var cnts = 0;
		for(i=0; i<ltrjs.length;i++) {
			if(ltrjs[i] == ltr) {
				cnts++;
			}
		}

		if(cnts<1){
			document.getElementById('course_type'+cnt).value="";
		} else {
			$('#course_title'+cnt).focus();
		}
	}


	$(function() 
	  {
		$('textarea').elastic();

		$('.divcheckbox').click(function(){
			var id = $(this).attr('id');

			if(this.checked==true) {
				$('.block_'+id).attr('checked', true);
			} else {
				$('.block_'+id).attr('checked', false);
			}
		})
	});

	
	
	 function save_filter(chkbx)
	{

		var shortcut_details = {};
		var cnt = 0;
		
		$('.course_filter').each(function(){
			var name =  $(this).attr('name');
			if($(this).is(':checked')){
				var value  = "1";
			}  else{
				var value   = "0";
			}
			shortcut_details[name] = value;
			cnt++;
		});
		
		
		var array_shortcuts = JSON.stringify(shortcut_details)
		ajaxCallserver({
			url : 'ajax/saveuserfilter',
			method : 'POST',
			data : {
				details: array_shortcuts
			}
		});
	}
	 
	 
	function checkboxurl(chkbx,isfilter)
	{
	 
		if(!chkbx.checked) {
			var ltrs = document.getElementsByName(chkbx.name);

			for(var j=0;j<ltrs.length;j++) {
				ltrs[j].checked = false;
			}
		} else {
			var ltrs = document.getElementsByName(chkbx.name);

			for(var j=0;j<ltrs.length;j++) {
				ltrs[j].checked = true;
			}
		}
 
		if(isfilter==1) {
			check3(chkbx);
		} else {
			check2();
		}
	}

	function check2()
	{
		$(".parentdiv").hide();
		var cletters=[];
		var chkurl = "";
		var cnt = 0;
		var hide_all = 0;
		
		for (var i in ltrjs ) {
			if(ltrjs[i] != '_owned'){
				$("."+ltrjs[i]).hide();
			}

			var ltrs = document.getElementsByName(ltrjs[i]);

			for(var j=0;j<(ltrs.length-1);j++) {
				if($('#wrong').is(':checked')){
					$('.wrongfilter:not(.source_entry)').show();
					$('.wrongfilter *:not(.colleft2_inpwid):not(.source_entry)').each(function(){
						$(this).show();
						cnt++;
					});
				}

				if(ltrs[j].name == '_owned' && ltrs[j].checked==true) {
					hide_all = (hide_all+1);
				}

				if(ltrs[j].name == '_shared' && ltrs[j].checked==true) {
					hide_all = (hide_all+1);
				}

				if(ltrs[j].checked == true ) {
					$("."+ltrs[j].name).parent().parent().parent().show();
					$("."+ltrs[j].name).show();
					cnt++;
				} else if(ltrs[j].name != '_owned') {
					$("."+ltrs[j].name).hide();
				}
			}
		}

		if(cnt==0) {
			$(".parentdiv").show();
			for (var i in ltrjs ) {
				$("."+ltrjs[i]).show();
			}
		}

		if(hide_all>=2) {
			$(".parentdiv").hide();
		}
	}

	function check3(chks) 
	{
		var sel_chks = 1;
		var cletters=[];
		var chkurl = "";
		var cnt = 0;

		for(var i in ltrjs) {
			var ltrs = document.getElementsByName(ltrjs[i]);

			for(var j=0;j<(ltrs.length-1);j++) {
				if(ltrs[j].checked==true) {
					sel_chks = (sel_chks+1);
				}
			}
		}
		
		if(sel_chks ==1){
			$(".parentdiv").hide();
		}
		
		if(chks.checked) {
			$(".wrongfilter:not(.source_entry)").show();
			if($('#wrong').is(':checked')){
				$('.wrongfilter:not(.source_entry)').show();
				$('.wrongfilter *:not(.colleft2_inpwid):not(source_entry)').each(function(){
					$(this).show();
				});
			}
		} else {
			check2();
		}
	}


<?php echo $this->callcourse; ?>

	var delaytrimer;

	function keyupdelay(obj, cntr) 
	{
		//obj is _this... it's all you need
		clearTimeout(delaytrimer);
		delaytrimer = setTimeout(function applydelay(){
			upper(cntr);
			chkmask(obj.value, cntr);
			changeinput(obj.value, cntr, obj);
		}, 100);
	}

	function upper(v) {
		document.getElementById("course_type"+v).value = document.getElementById("course_type"+v).value.toUpperCase();
	}

	for(var k=0; k<hotkeysjs.length;k++) {
		var ads = k+1;
		shortcut.add('Ctrl+Alt+'+hotkeysjs[k],function(e) {
			if($('input[name='+String.fromCharCode(e.keyCode)+']').is(':checked')) {
				$('input[name='+String.fromCharCode(e.keyCode)+']').removeAttr('checked');
			} else {
				$('input[name='+String.fromCharCode(e.keyCode)+']').attr('checked','checked');
			}

			checkboxurl(document.getElementById($('input[name='+String.fromCharCode(e.keyCode)+']').attr('id')));
		});
	}

	function printaction() {
		document.frmcourse.action = "patientcourse/printcourse?id=<?echo $this->pid ?>";
		document.frmcourse.target = "_blank";
		document.frmcourse.submit();
	}

	function closepopup() {
		disablePopup();
	}

	function openPopup(chkbx,id, skip_modal) {
	
		var checkid = $(chkbx).attr('id');
		
		var ids = "";
		var quamma = "";

		for(i=0;i<$('.block_'+checkid).length;i++) {
			ids = ids + quamma + ($('.block_'+checkid)[i].id);
			quamma = ",";
		}
		
		if(chkbx.checked) {
			$("<input type='hidden' name='comments["+id+"]' id='comment_"+id+"' value='' />").appendTo("#frmcourse");

			$('#contactArea').html('<iframe id="add_family_doc" frameborder="0" src="" scrolling="no" style="margin:0 auto;"></iframe>');


			//centerPopup({sr:'about:blank',ht:250,wt:450});
			centerPopup({sr:'about:blank',ht:70,wt:450});				//ISPC-2571 Lore 18.08.2020
			
			//$('#contactArea').html('<div><?php echo $this->translate('wrongcomment'); ?><div align="right"><a id="popupContactClose" style="cursor:pointer;" onclick="uncheckbox(\''+checkid+'\');closepopup()">x</a></div></div><div><textarea name="comment" id="comment"></textarea></div><div><button name="" onClick="saveComment(\''+id+'\',\''+ids+'\',\''+checkid+'\');"><?php echo $this->translate('submit');?></button></div>');
			//ISPC-2571 Lore 18.08.2020
			$('#contactArea').html('<div><?php echo $this->translate('wrongcomment_formular'); ?><div align="right"><a id="popupContactClose" style="cursor:pointer;" onclick="uncheckbox(\''+checkid+'\');closepopup()">x</a></div></div><div><textarea name="comment" id="comment" style="width: 455px;height: 40px;"></textarea></div><div><button name="" onClick="saveComment(\''+id+'\',\''+ids+'\',\''+checkid+'\');"><?php echo $this->translate('submit');?></button></div>');

			loadPopup();		
			
			
		} else {

			$("#comment_"+id).remove();

			ajaxCallserver({url:'patientcourse/savewrongcd?ids='+ids+'&val=0&blockcnt='+checkid});
		}
	}

	function saveComment(id,ids,blockid)
	{
	   var val = "";
	   var modal_mode = '0';

		if($("#comment").val().length>0) {
			val="<?php echo ("Dieser Eintrag wurde als gelöscht markiert. Begründung : ") ?>" + $("#comment").val();

			$("#comment_"+id).val(val);

			ajaxCallserver({url:'patientcourse/savewrongcd', method:'POST', data:{comment:val,val:1,ids:ids,blockcnt:blockid}});
			disablePopup();

		   var arr_medis = ["M", "N", "I", "Q", "BP"];
		   var arr_diag = ["D","H","HS"];
		   var arr_xbdt_actions = ["LE"];

			$('.courses_types_'+blockid).each(function(){
				if(jQuery.inArray($(this).val(), arr_medis)>=0){

					if(modal_mode == '0'){
						if($(this).val() == 'Q' && $(this).attr('rel') != 0){
							modal_mode = '1';
						} else if($(this).val() == 'Q' && $(this).attr('rel') == 0) {
							modal_mode = '3';
						} else if($(this).val() != 'Q') {
							modal_mode = '1';
						}
					}
				}
				
				if(jQuery.inArray($(this).val(), arr_diag)>=0) {
					if(modal_mode == 0){
						modal_mode = '2';
					}
				}
				
				if(jQuery.inArray($(this).val(), arr_xbdt_actions)>=0 && module_le) {
					if(modal_mode == 0){
						modal_mode = '4';
					}
				}
			});

			switch (modal_mode) {
				case '1':
					//modal medis with ok
					$('#delete_medis').show();
					$('#modal_redir_type').val('M');

					$('#modal_delete').dialog('open');
					break;
				case '2':
					//modal diag with ok
					$('#delete_diag').show();
					$('#modal_redir_type').val('D');

					$('#modal_delete').dialog('open');
					break;

				case '3':
					//ispc 1864 12) if a user deletes a Q entry . the BTM ammount MUST not be affected!
					//modal btm dialog deleting medi with ok
					// $('#btm_medi_revert').val(ids);
					// $('#delete_btm_med').dialog('open');

					break;
					
				case '4':
					//modal diag with ok
					$('#delete_xbdt_action').show();
					$('#modal_redir_type').val('LE');

					$('#modal_delete').dialog('open');
					break;
				default:
			}
		}
		else
		{
			jAlert('<?php echo $this->translate('entercomment') ?>');
		}
	}

	function diag_button(){
		window.location = appbase+'patient/patdiagnoedit?id=<?php echo $_REQUEST['id']; ?>';
		$('#modal_delete').dialog('close');
	}

	function medi_button(){
		window.location = appbase+'patient/patientmedication?id=<?php echo $_REQUEST['id']; ?>';
		$('#modal_delete').dialog('close');
	}

		var callBackWrong = function(params){

			if(params.val==1)
			{
				$("#wrongcomment_"+params.id).show();
				$("#wrongcomment_"+params.id).html(params.comment);
				$('#maindiv_'+params.id).addClass('wrongfilter');

				$('#maindiv_'+params.id).addClass('greyclass');
				$('.wrc_'+params.id).find('font').attr('color','#cccccc');
				$('.wrt_'+params.id).find('font').attr('color','#cccccc');
			}
			else
			{
				$('#maindiv_'+params.id).removeClass('greyclass');
				$('#maindiv_'+params.id).removeClass('wrongfilter');

				$('#wrongcomment_'+params.id).hide();



				for(i=0;i<$('.wrc_'+params.id).length;i++)
				{
					var crid = ($('.wrc_'+params.id)[i].id);
					var crtid = ($('.wrt_'+params.id)[i].id);
					var oldcolor = $('#old_'+crid.substr(('wrc_').length)).val();

					$('#'+crid).find('font').attr('color','#'+oldcolor);
					$('#'+crtid).find('font').attr('color','#'+oldcolor);
				}
			}
			
			
			if( ! $.isEmptyObject(params.extra_params)) {
				
				if( params.extra_params.hasOwnProperty('refresh')) {

					//params.extra_params.refresh is intended to reload only parts of the page
					switch( params.extra_params.refresh) {
						case "vital_signs_icons":{
							refresh_weight_chart_block();//refresh the graph for the vitalsigns
						}
						break;
					}
				}
			}
			
		}

	function uncheckbox(chk)
	{
	       $('#'+chk).attr('checked',false);
	}

	function appendto(rowId,inputValue){
		var modulepriv = '<?php echo $this->modulepriv; ?>';
		var module_hb = '<?php echo $this->module_hb; ?>';
		var modulepriv_bavaria = '<?php echo $this->modulepriv_bav; ?>';
		var module_noauto = '<?php echo $this->module_noauto; ?>';
		var modulepriv_g = '<?php echo $this->modulepriv_g; ?>';//ISPC-2651 //Maria:: Migration CISPC to ISPC 20.08.2020
		//console.log('g', modulepriv_g);
		var module_le = '<?php echo $this->module_le; ?>';
		var module_sd = '<?php echo $this->module_sd; ?>';
		var module_al = '<?php echo $this->module_al; ?>';
		
		var module_xs = '<?php echo $this->module_xs; ?>';
		var module_xe = '<?php echo $this->module_xe; ?>';
		var module_vo_ve = '<?php echo $this->module_vo_ve; ?>';
		
		var module_pk = '<?php echo $this->module_pk; ?>';
		var module_xn = '<?php echo $this->module_xn; ?>';
		var module203_rlp_special_sh = '<?php echo $this->module203_rlp_special_sh; ?>';
		var module209_demstepcare_special_sh = '<?php echo $this->module209_demstepcare_special_sh; ?>';
		var module_ml = '<?php echo $this->module_ml; ?>';
		
		var module_xm = '<?php echo $this->module_xm; ?>';
		var module_xh = '<?php echo $this->module_xh; ?>';
		var module_xg = '<?php echo $this->module_xg; ?>';

		var module_companion_xt = '<?php echo $this->module_companion_xt; ?>';		//ISPC-2902 Lore 27.04.2021

		var text = '';
		
		 //we get all inputs values every time something changes so if user skip a box.. we have the rest 2 and so on
		if(($('#name'+rowId).val() != "Name" && $('#dosage'+rowId).val() != "Dosierung") || ($('#todo'+rowId).val() != "TODO" && $('#till'+rowId).val() != "Till When" && $('#user'+rowId).val() != "0") || ($('#diagnosis'+rowId).val() != "Beschreibung" ))
		{
			//ISPC - 2366
			if($('#course_type'+rowId).val() == "M" || $('#course_type'+rowId).val() == "N" || $('#course_type'+rowId).val() == "I")
			{
				text = $('#name'+rowId).val() != '' ? $('#name'+rowId).val() : '';
				text += $('#dosage'+rowId).val() != '' ? '|' + $('#dosage'+rowId).val() : '|';
				text += $('#komment'+rowId).val() != '' ? '|' + $('#komment'+rowId).val() : '|';
				text += inputExtra != '' ? '|' + inputExtra : '|';//ISPC-2329
				text += inputExtraAtc != '' ? '|' + inputExtraAtc : '|';//ISPC-2554 pct.3
				text += inputExtraPzn != '' ? '|' + inputExtraPzn : '|';//ISPC-2329 Ancuta 03.04.2020
				text += inputExtraDBF_id != '' ? '|' + inputExtraDBF_id : '|';//ISPC-2329 Ancuta 03.04.2020
				text += inputExtraDosage_form != '' ? '|' + inputExtraDosage_form : '|';//ISPC-2554 Carmen 14.05.2020
				text += inputExtraUnit != '' ? '|' + inputExtraUnit : '|';//ISPC-2554 Carmen 14.05.2020
				//text = $('#name'+rowId).val()+' | '+$('#dosage'+rowId).val()+' | '+$('#komment'+rowId).val()
			} 
			else if($('#course_type'+rowId).val() == "BP" )
			{
				text = $('#name'+rowId).val() != '' ? $('#name'+rowId).val() : '';
				text += $('#komment'+rowId).val() != '' ? '|' + $('#komment'+rowId).val() : '';
				
				//text = $('#name'+rowId).val()+' | '+$('#komment'+rowId).val()
			} 
			else if($('#course_type'+rowId).val() == "W")
		    {
				if($('#group'+rowId).is(':checked'))
				{
					var group = '1';
				} 
				else 
				{
					var group = '0';
				}
				
				text = $('#todo'+rowId).val()+' |---------| '+$('#user'+rowId).val()+' |---------| '+ $('#till' + rowId).val() + ' |---------| ' + group;				
				
			} 
			else if ($('#course_type' + rowId).val() == "P") 
		    {
				text = $('#name'+rowId).val() != '' ? $('#name'+rowId).val() : '';
				text += $('#dosage'+rowId).val() != '' ? '|' + $('#dosage'+rowId).val() : '';
				text += $('#komment'+rowId).val() != '' ? '|' + $('#komment'+rowId).val() : '|';
				
				//text = $('#medi_name' + rowId).val() + ' | ' + $('#dosage' + rowId).val() + '  | ' + $('#comments' + rowId).val();
			} 
			else if ($('#course_type' + rowId).val() == "PB") 
			{
				if ($('#komment' + rowId).val() == "Inhalt" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
				{//set time default value if left empty
					komment = "";
				} 
				else 
				{
					komment = $('#komment' + rowId).val();
				}
				text =  komment + ' | ' + $('#date' + rowId).val() + ' ' + $('#hourtime' + rowId).val();
			}
			else if ($('#course_type' + rowId).val() == "KX") 
			{
				if ($('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
				{//set time default value if left empty
					komment = "";
				} 
				else 
				{
					komment = $('#komment' + rowId).val();
				}
				text =  komment + ' | ' + $('#date' + rowId).val() + ' ' + $('#hourtime' + rowId).val();
			}
			else if ($('#course_type' + rowId).val() == "L") 
			{
						
				if ($('#lrownumber' + rowId).val() == "Leistugen" || $('#lrownumber' + rowId).val() == "" || $('#lrownumber' + rowId).val() == " ") 
				{//set time default value if left empty
					komment = "";
				} 
				else 
				{
					komment = $('#lrownumber' + rowId).val();
				}
				
				text =  komment ;
			}
			else if ( 
					($('#course_type' + rowId).val() == "U"	
					|| $('#course_type' + rowId).val() == "V") 
					|| (($('#course_type' + rowId).val() == "VO" || $('#course_type' + rowId).val() == "VE") && module_vo_ve == "1")
					|| ($('#course_type' + rowId).val() == "XT" && (modulepriv == "1" || modulepriv_bavaria == "1"))
					|| ($('#course_type' + rowId).val() == "G" && (modulepriv_g == "1" ))
					|| ($('#course_type' + rowId).val() == "LS" && module_lysocare == "1") 
					|| ($('#course_type' + rowId).val() == "SD" && module_sd == "1") 
					|| ($('#course_type' + rowId).val() == "HB" && module_hb == "1") 
					|| ($('#course_type' + rowId).val() == "AA" && (modulepriv == "1" || modulepriv_bavaria == "1"))
					|| ($('#course_type' + rowId).val() == "XS" && module_xs == "1") 
					|| ($('#course_type' + rowId).val() == "XE" && module_xe == "1") 
					
					|| ($('#course_type' + rowId).val() == "PK" && module_pk == "1") 
					|| ($('#course_type' + rowId).val() == "XN" && module_xn == "1") 
					|| ($('#course_type' + rowId).val() == "ME")
					
					|| ($('#course_type' + rowId).val() == "RK" && module203_rlp_special_sh == "1") 
					|| ($('#course_type' + rowId).val() == "RI" && module203_rlp_special_sh == "1") 
					|| ($('#course_type' + rowId).val() == "RO" && module203_rlp_special_sh == "1") 
					|| ($('#course_type' + rowId).val() == "RD" && module203_rlp_special_sh == "1") 
					|| ($('#course_type' + rowId).val() == "ML" && module_ml == "1") 
					|| ($('#course_type' + rowId).val() == "DD" && module209_demstepcare_special_sh == "1") 
					|| ($('#course_type' + rowId).val() == "DC" && module209_demstepcare_special_sh == "1")
					|| ($('#course_type' + rowId).val() == "XM" && module_xm == "1")
					|| ($('#course_type' + rowId).val() == "XH" && module_xh == "1")
					|| ($('#course_type' + rowId).val() == "XG" && module_xg == "1")					
					|| ($('#course_type' + rowId).val() == "WT" && module_wt == "1") 	//TODO-3897 Lore 15.03.2021
					 
					) 
			{

				if ($('#course_type' + rowId).val() == "U" && modulepriv != "1") 
				{
					//appended the select value to time
					if ($('#time' + rowId).val() == "Zeit (in Minuten)" || $('#time' + rowId).val() == "" || $('#time' + rowId).val() == " ") 
					{//set time default value if left empty
						time = $('#uSelect' + rowId).val() + " | 10";
					} 
					else 
					{
						time = $('#uSelect' + rowId).val() + " | " + $('#time' + rowId).val();
					}
				} 
				else if ($('#course_type' + rowId).val() == "U" && modulepriv == "1") 
				{ //LNR client only
					//appended the select value to time
					if ($('#time' + rowId).val() == "Zeit (in Minuten)" || $('#time' + rowId).val() == "" || $('#time' + rowId).val() == " ") 
					{//set time default value if left empty
						time = $('#uSelect' + rowId).val() + " | 15";
					} 
					else 
					{
						time = $('#uSelect' + rowId).val() + " | " + $('#time' + rowId).val();
					}
				} 
				else if (($('#course_type' + rowId).val() == "XT" && module_noauto ==  "1") ||
						($('#course_type' + rowId).val() == "G" && modulepriv_g ==  "1") ||
						 ($('#course_type' + rowId).val() == "LS") ||
						 ($('#course_type' + rowId).val() == "WT") ||			//TODO-3897 Lore 15.03.2021
						 ($('#course_type' + rowId).val() == "SD" && module_noauto ==  "1") ||
						 ($('#course_type' + rowId).val() == "HB" && module_noauto ==  "1")) 
				{ //module no auto comment active for xt shortcuts
					//appended the select value to time
					if ($('#time' + rowId).val() == "Zeit (in Minuten)" || $('#time' + rowId).val() == "" || $('#time' + rowId).val() == " ") 
					{//set time default value if left empty
						time = " ";
					} 
					else 
					{
						time = $('#time' + rowId).val();
					}
				
				
				} 
				else if (($('#course_type' + rowId).val() == "XT" && modulepriv == "1" && module_noauto !=  "1") || 
						 ($('#course_type' + rowId).val() == "SD" && modulepriv == "1" && module_noauto !=  "1") ||
						($('#course_type' + rowId).val() == "G" && modulepriv_g == "1" ) ||
						 ($('#course_type' + rowId).val() == "HB" && modulepriv == "1" && module_noauto !=  "1") ) 
				{//LNR CLient Z=>XT(telefon) shortcut
					//appended the select value to time
					if ($('#time' + rowId).val() == "Zeit (in Minuten)" || $('#time' + rowId).val() == "" || $('#time' + rowId).val() == " ") 
					{//set time default value if left empty
						time = "12";
					} 
					else 
					{
						time = $('#time' + rowId).val();
					}
				}
				else if (($('#course_type' + rowId).val() == "XT" && modulepriv_bavaria == "1"  && module_noauto !=  "1") || 
						 ($('#course_type' + rowId).val() == "SD" && modulepriv_bavaria == "1"  && module_noauto !=  "1") ||
						($('#course_type' + rowId).val() == "G" && modulepriv_g == "1" ) ||
						 ($('#course_type' + rowId).val() == "HB" && modulepriv_bavaria == "1"  && module_noauto !=  "1")) 
				{//LNR CLient Z=>XT(telefon) shortcut
					//appended the select value to time
					if ($('#time' + rowId).val() == "Zeit (in Minuten)" || $('#time' + rowId).val() == "" || $('#time' + rowId).val() == " ") 
					{//set time default value if left empty
						time = "5";
					} 
					else 
					{
						time = $('#time' + rowId).val();
					}
				}
	
				// NEW     Administration shortcut - like Koordination
				else if ($('#course_type' + rowId).val() == "AA" && modulepriv_bavaria == "1") 
				{//TP CLient Z=>AA(administration) shortcut
				
					if ($('#time' + rowId).val() == "Zeit (in Minuten)" || $('#time' + rowId).val() == "" || $('#time' + rowId).val() == " ") 
					{//set time default value if left empty
						time = "5";
					} 
					else 
					{
						time = $('#time' + rowId).val();
					}
				}
	
				if ( $('#course_type' + rowId).val() == "V"
						|| (($('#course_type' + rowId).val() == "VO" || $('#course_type' + rowId).val() == "VE") && module_vo_ve == "1")
						|| ($('#course_type' + rowId).val() == "XG" && module_xg == "1")
					)
				{
					if ($('#time' + rowId).val() == "Zeit (in Minuten)" || $('#time' + rowId).val() == "" || $('#time' + rowId).val() == " ") 
					{//set time default value if left empty
						time = "8";
					} 
					else 
					{
						time = $('#time' + rowId).val();
					}
				}
	
				if ($('#course_type' + rowId).val() == "U" && modulepriv != "1") 
				{
					if ($('#komment' + rowId).val() == "Grund / Anlass" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
					{//set kommentar default value if left empty
						komment = "Situation stabil, heute kein Besuch notwendig, Kontakt f. Folgetag vereinbart";
					} 
					else 
					{
						komment = $('#komment' + rowId).val();
					}
				} 
				else if ($('#course_type' + rowId).val() == "U" && modulepriv == "1") 
				{ //LNR Client Only
					
					if ($('#komment' + rowId).val() == "Grund / Anlass" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
					{//set kommentar default value if left empty
						komment = "Beratung";
					} 
					else 
					{
						komment = $('#komment' + rowId).val();
					}
				
				
				} 
				else if (($('#course_type' + rowId).val() == "XT" && module_noauto ==  "1") ||
						($('#course_type' + rowId).val() == "G" && modulepriv_g == "1" ) ||
						 ($('#course_type' + rowId).val() == "LS" ) ||
						 ($('#course_type' + rowId).val() == "WT" ) ||			//TODO-3897 Lore 15.03.2021
						 ($('#course_type' + rowId).val() == "SD" && module_noauto ==  "1") ||
						 ($('#course_type' + rowId).val() == "HB" && module_noauto ==  "1") ) 
				{ //module no auto comment active for xt shortcuts
					if ($('#komment' + rowId).val() == "Grund / Anlass" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
					{//set kommentar default value if left empty
						komment = " ";
					} 
					else 
					{
						komment = $('#komment' + rowId).val();
					}
				
				} 
				else if (($('#course_type' + rowId).val() == "XT" && modulepriv == "1" && module_noauto !=  "1") ||
						 ($('#course_type' + rowId).val() == "SD" && modulepriv == "1" && module_noauto !=  "1") ||
						 ($('#course_type' + rowId).val() == "HB" && modulepriv == "1" && module_noauto !=  "1") ) 
				{
					if ($('#komment' + rowId).val() == "Grund / Anlass" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
					{//set kommentar default value if left empty
						komment = "Situation stabil, heute kein Besuch notwendig, Kontakt f. Folgetag vereinbart";
					} 
					else 
					{
						komment = $('#komment' + rowId).val();
					}
				}
	
				else if (($('#course_type' + rowId).val() == "XT" && modulepriv_bavaria == "1" && module_noauto !=  "1") || 
						 ($('#course_type' + rowId).val() == "SD" && modulepriv_bavaria == "1" && module_noauto !=  "1") ||
						 ($('#course_type' + rowId).val() == "HB" && modulepriv_bavaria == "1" && module_noauto !=  "1") )
				{
					if ($('#komment' + rowId).val() == "Grund / Anlass" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
					{//set kommentar default value if left empty
						komment = "Telefonat bzgl. der aktuellen Situation";
					} 
					else 
					{
						komment = $('#komment' + rowId).val();
					}
				}
				else if ($('#course_type' + rowId).val() == "AA" && modulepriv_bavaria == "1")
				{
					if ($('#komment' + rowId).val() == "Grund / Anlass" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
					{//set time default value if left empty
						komment = "Administration Pflege";
					} 
					else 
					{
						komment = $('#komment' + rowId).val();
					}
				}
	
				if ( $('#course_type' + rowId).val() == "V"
						|| (($('#course_type' + rowId).val() == "VO" || $('#course_type' + rowId).val() == "VE") && module_vo_ve == "1")
				) 
				{
					if ($('#komment' + rowId).val() == "Grund / Anlass" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
					{//set time default value if left empty
						komment = "Koordinationsleistung";
					} 
					else 
					{
						komment = $('#komment' + rowId).val();
					}
				}
				
				if (($('#course_type' + rowId).val() == "XG" && module_xg == "1")
				) 
				{
					if ($('#komment' + rowId).val() == "Grund / Anlass" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
					{//set comment default value if left empty
						komment = "Teambesprechung";
					} 
					else 
					{
						komment = $('#komment' + rowId).val();
					}
				}
				
				if (   $('#course_type' + rowId).val() == "XS" 
						|| $('#course_type' + rowId).val() == "XE"
						|| $('#course_type' + rowId).val() == "PK"
						|| $('#course_type' + rowId).val() == "XN"
						|| $('#course_type' + rowId).val() == "ME"
						
						|| $('#course_type' + rowId).val() == "RK"
						|| $('#course_type' + rowId).val() == "RI"
						|| $('#course_type' + rowId).val() == "RO"
						|| $('#course_type' + rowId).val() == "RD"
						|| $('#course_type' + rowId).val() == "ML"
						|| $('#course_type' + rowId).val() == "DD"
						|| $('#course_type' + rowId).val() == "DC"
						|| $('#course_type' + rowId).val() == "XM"
						|| $('#course_type' + rowId).val() == "XH"
				) 
				{
					if ($('#komment' + rowId).val() == "Grund / Anlass" || $('#komment' + rowId).val() == "" || $('#komment' + rowId).val() == " ") 
					{//set time default value if left empty
						komment = "";
					} 
					else 
					{
						komment = $('#komment' + rowId).val();
					}
					if ($('#time' + rowId).val() == "Zeit (in Minuten)" || $('#time' + rowId).val() == "" || $('#time' + rowId).val() == " ") 
					{//set time default value if left empty
						time = "";
					} 
					else 
					{
						time = $('#time' + rowId).val();
					}
				
				}
				
				text = time + ' | ' + komment + ' | ' + $('#date' + rowId).val() + ' ' + $('#hourtime' + rowId).val();
				
				if ($('#course_type' + rowId).val() == "LS") {
					text += ' | ' + $('#uCategory' + rowId).val();
					text += ' | ' + $('#uCategory_2_' + rowId).val();
					text += ' | ' + $('#uCategory_3_' + rowId).val();
				}
				
				//TODO-3897 Lore 15.03.2021
				if ($('#course_type' + rowId).val() == "WT") {
					text += ' | ' + $('#uCategory' + rowId).val();
					text += ' | ' + $('#uCategory_2_' + rowId).val();
					text += ' | ' + $('#uCategory_3_' + rowId).val();
				}
				

				
			} 
			else if ($('#course_type' + rowId).val() == "D" || $('#course_type' + rowId).val() == "H" || $('#course_type' + rowId).val() == "HS") 
			{
				icdId = $('#hidd_icdnumber' + rowId).val();
				
				if($('#icdnumber' + rowId).val() == "ICD") 
				{
					icdField = "";
				} 
				else 
				{
					icdField = $('#icdnumber' + rowId).val();
				}
	
				text = icdId + ' | ' + icdField + ' | ' + $('#diagnosis' + rowId).val();
			} 
			else if ($('#course_type' + rowId).val() == "AL" && module_al == "1")  
			{
				
							
				if($('#actionid' + rowId).val() == "ID") {action_id_field = "";	} 
				else {action_id_field = $('#actionid' + rowId).val();}
				
				if($('#description' + rowId).val() == "Beschreibung"){description = "";} 
				else{ description = $('#description' + rowId).val(); }

				text = action_id_field + ' | ' + description + ' | ' + $('#al_date' + rowId).val();

			}
			else if ($('#course_type' + rowId).val() == "LE" && module_le == "1")  
			{
								
				action_id = $('#hidd_actionid' + rowId).val();
				
				if($('#actionid' + rowId).val() == "ID") 
				{
					action_id_field = "";
				} 
				else 
				{
					action_id_field = $('#actionid' + rowId).val();
				}
	
				text = action_id + ' |____| ' + action_id_field + ' |____| ' + $('#actionname' + rowId).val()+ ' |____| ' + $('#actionuser' + rowId).val()+ ' |____| ' + $('#date' + rowId).val() + ' ' + $('#hourtime' + rowId).val();;
			} 
			else if ($('#course_type' + rowId).val() == "SB") 
			{
				text = $('#sb_user' + rowId).val() + ' |__| ' +  $('#sb_order' + rowId).val() ;
			}
			
			$('#course_title' + rowId).val(text);
		} 
		else 
		{
			$('#course_title' + rowId).val('');
		}
	}

	//_this is the caller
	function changeinput(shortcut, id, _this) {
		
		var modulepriv = '<?php echo $this->modulepriv; ?>';
		var module_hb = '<?php echo $this->module_hb; ?>';
		var module_le = '<?php echo $this->module_le; ?>';
		var modulepriv_bavaria = '<?php echo $this->modulepriv_bav; ?>';
		var modulepriv_g = '<?php echo $this->modulepriv_g; ?>';//Maria:: Migration CISPC to ISPC 20.08.2020
		var module_sd = '<?php echo $this->module_sd; ?>';
		var module_al = '<?php echo $this->module_al; ?>';
		
		var module_xs = '<?php echo $this->module_xs; ?>';
		var module_xe = '<?php echo $this->module_xe; ?>';
		var module_vo_ve = '<?php echo $this->module_vo_ve; ?>';
		
		var module_pk = '<?php echo $this->module_pk; ?>';
		var module_xn = '<?php echo $this->module_xn; ?>';
		var module203_rlp_special_sh = '<?php echo $this->module203_rlp_special_sh; ?>';
		var module209_demstepcare_special_sh = '<?php echo $this->module209_demstepcare_special_sh; ?>';
		var module_ml = '<?php echo $this->module_ml; ?>';
	 
	 		
		var module_xm = '<?php echo $this->module_xm; ?>';
		var module_xh = '<?php echo $this->module_xh; ?>';
		var module_xg = '<?php echo $this->module_xg; ?>';
		
		var module_companion_xt = '<?php echo $this->module_companion_xt; ?>';		//ISPC-2902 Lore 27.04.2021

		idplus = id +1;
		idminus = id -1;
		var pid = $('#patientid').val();
		var total_cnt = $('.LeftList01').length;
		var has_hs_fields = false;
		inputExtra = '';
		inputExtraAtc = ''; //ISPC-2554 pct.3
		
		$('input[name="course_type[]"]').each(function(){
			if($(this).val() == 'HS' && $(this).attr('id') != 'course_type'+id) {
				has_hs_fields = true;
			}
		});
		
		//reset error for newly changed line
//		$('#error'+id).remove();
		$('.verlauf_error_div').hide();
		$('#course_title'+id).val('');
		
		if((shortcut == "M" || shortcut == "I" || shortcut == "N" || shortcut == "m" || shortcut == "i" || shortcut == "n"))
		{ //medications
			
			if($('#hidd'+id).length > 0)
			{
				$('#hidd'+id).hide().remove();
				$('#course_title'+id).val('');
			}
			//ISPC - 2366
			//newInputs = '<div id="hidd'+id+'"><input type="text" id="name'+id+'"class="caret course_med_name" name="name[]" value="Name" onfocus="if(this.value == \'Name\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Name\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" /><input type="text" id="dosage'+id+'" name="dosage[]" class="caret"  value="Dosierung" style="width:150px; text-align:left;" onfocus="if(this.value == \'Dosierung\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Dosierung\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" /><input type="text" id="komment'+id+'" name="komment[]" class="caret"  value="Kommentar" style="width:210px; text-align:left;" onfocus="if(this.value == \'Kommentar\') { this.value=\'\'};" onblur="if(this.value == \'\'){ this.value=\'Kommentar\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/></div>';
			newInputs = '<div id="hidd'+id+'"><input type="text" id="name'+id+'"class="caret course_med_name" name="name[]" placeholder="Name" value="" onfocus="if(this.value == \'Name\') { this.value=\'\'}" onblur="if(this.value != \'\'){ appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" /><input type="text" id="dosage'+id+'" name="dosage[]" class="caret"  placeholder="Dosierung" value="" style="width:150px; text-align:left;" onfocus="if(this.value == \'Dosierung\') { this.value=\'\'}" onblur="if(this.value != \'\'){ appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" /><input type="text" id="komment'+id+'" name="komment[]" class="caret"  placeholder="Kommentar" value="" style="width:210px; text-align:left;" onfocus="if(this.value == \'Kommentar\') { this.value=\'\'};" onblur="if(this.value != \'\'){ appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/></div>';
			$('#course_title'+id).hide();
			$('#listcoursesession_course_title'+id).append(newInputs);
			$('#listcoursesession_course_title'+id).show();
			
			<?php if($this->show_mmi == "1"):?>
			var healthinsuranceik = "<?php echo $this->kassen_no; ?>";
			var client = '<?php echo $this->clientid ?>';
			
			$('.course_med_name').live('change', function() {
				var input_row = parseInt($(this).attr('id').substr(('name').length));
			}).liveSearch({
				url: 'pharmaindex/getproductsmedils?ik_no='+healthinsuranceik+'&sm=0&client='+client+'&searchtext=',
				id: 'livesearch_admission_medications',
				aditionalWidth: '300',
				noResultsDelay: '900',

					typeDelay: '900',
				returnRowId: function (input) {return parseInt($(input).attr('id').substr(('name').length));}
			});
			<?php endif; ?>


			if(jQuery.inArray(shortcut, ltrjs))
			{
				$('#name'+id).focus();
			}

		} 
		else if((shortcut == "BP" || shortcut == "BP"))
		{ //medications
			
			if($('#hidd'+id).length > 0)
			{
				$('#hidd'+id).hide().remove();
				$('#course_title'+id).val('');
			}

			//newInputs = '<div id="hidd'+id+'"><input type="text" id="name'+id+'"class="caret course_med_name_treatment_care" name="name[]" value="Name" onfocus="if(this.value == \'Name\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Name\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" /><input type="text" id="komment'+id+'" name="komment[]" class="caret"  value="Kommentar" style="width:210px; text-align:left;" onfocus="if(this.value == \'Kommentar\') { this.value=\'\'};" onblur="if(this.value == \'\'){ this.value=\'Kommentar\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/></div>';
			newInputs = '<div id="hidd'+id+'"><input type="text" id="name'+id+'"class="caret course_med_name_treatment_care" name="name[]" placeholder="Name" value="" onfocus="if(this.value == \'Name\') { this.value=\'\'}" onblur="if(this.value != \'\'){ appendto(\''+id+'\',this.value)}  insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" /><input type="text" id="komment'+id+'" name="komment[]" class="caret"  placeholder="Kommentar" value="" style="width:210px; text-align:left;" onfocus="if(this.value == \'Kommentar\') { this.value=\'\'};" onblur="if(this.value != \'\'){ appendto(\''+id+'\',this.value)} insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/></div>';
			$('#course_title'+id).hide();
			$('#listcoursesession_course_title'+id).append(newInputs);
			$('#listcoursesession_course_title'+id).show();
			
			<?php if($this->show_mmi == "1"):?>
			var healthinsuranceik = "<?php echo $this->kassen_no; ?>";
			var client = '<?php echo $this->clientid ?>';
			
			$('.course_med_name_treatment_care').live('change', function() {
				var input_row = parseInt($(this).attr('id').substr(('name').length));
			}).liveSearch({
// 				url: 'pharmaindex/getproductsmedils?ik_no='+healthinsuranceik+'&sm=0&client='+client+'&searchtext=',
				url: 'ajax/medicationstreatmentcare?q=',
				id: 'livesearch_admission_medications',
				aditionalWidth: '300',
				noResultsDelay: '900',

					typeDelay: '900',
				returnRowId: function (input) {return parseInt($(input).attr('id').substr(('name').length));}
			});
			<?php endif; ?>


			if(jQuery.inArray(shortcut, ltrjs))
			{
				$('#name'+id).focus();
			}

		} 
		else if(shortcut == "W" || shortcut=="w") 
		{ // To Do

			if($('#hidd'+id).length > 0)
			{
				$('#hidd'+id).hide().remove();
				$('#course_title'+id).val('');
			}
	 
			<?php
				/*
				foreach($this->usersnewtodos as $sel_user_id=>$sel_user) {
					if($sel_user_id == "u000000" || $sel_user_id == "g000000" || $sel_user_id == "pseudogroups_header"){
						$dis_str = 'disabled="disabled"' ;
					}else{
						$dis_str ='';
					}
					$sel_str .= '<option value="'.$sel_user_id.'"    '.$dis_str.' >  '.$sel_user.'</option>';
				}
				*/
			
			$sel_box = $this->formSelect(
					"user{$cntr}[]", 
					null, 
					array(
						"id" => "user{$cntr}",
						"rel" => $cntr,
						"class" => "todo_selectbox",
						"multiple" => true,
						"size" => 1,
						"disable" => array("0"),
						"onchange" => "appendto('{$cntr}', this.value); insertsession('{$cntr}','{$pid}','{$cntr}');",
						"onchanges" => "insertsession('{$cntr}', '{$pid}', '{$cntr}');" 
						 
					),
					$this->usersnewtodos
				);
			
			$sel_str = '';
			if (preg_match_all('/<select(.*?)>(.*?)<\/select>/s', $sel_box, $matches)) {
				$sel_str = $matches[2][0];
			}
			?>
			/*
			var usersSelect = '<div class="sel_holder"><select name="user'+id+'" id="user'+id+'" multiple="multiple" size="5" onblur="appendto('+id+',this.value);" onchange="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" style="" class="caret multiselect_style"><?php echo $sel_str;?></select></div>';
			*/
			var usersSelect = '<div class="sel_holder"><select name="user'+id+'" id="user'+id+'" multiple="multiple" onchange="appendto('+id+',this.value); insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" class="todo_selectbox">' + <?php echo json_encode($sel_str);?> + '</select></div>';

			newInputs = '<div id="hidd'+id+'">\n\
			<textarea id="todo'+id+'"class="caret course_todo" name="todo[]" value="TODO" onfocus="if(this.value == \'TODO\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'TODO\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');">TODO</textarea>\n\
			'+usersSelect+'\n\
			<input type="text" id="till'+id+'" name="till[]" style="width: 100px;"  class="caret course_todo_date"  value="<?php echo date("d.m.Y"); ?>"  onfocus="appendto(\''+id+'\',this.value);" onchange="if(this.value == \'\'){ this.value=\'<?php echo date("d.m.Y")?>\' } else { appendto(\''+id+'\',this.value);} insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>\n\
			</div>';


			$('#listcoursesession_course_title'+id).append(newInputs);

			$('.todo_selectbox', $('#listcoursesession_course_title'+id)).chosen({
				placeholder_text_single: translate('please select'),
				placeholder_text_multiple : translate('please select'),
				multiple:1,
				width:'250px',
				style: "padding-top:10px",
				"search_contains": true,
				no_results_text: translate('noresultfound')
			});
			
			$('#todo'+id).elastic();
			$('#till' + id).mask("99.99.9999");
			$('#course_title'+id).hide();
			$('#till'+id).datepicker({
				dateFormat: 'dd.mm.yy',
				showOn: "both",
				buttonImage: $('#calImg').attr('src'),
				buttonImageOnly: true,
				changeMonth: true,
				changeYear: true,
				nextText: '',
				prevText: '',
				onSelect: function(date) {
					appendto(id,date.value);
					insertsession(id,pid,id);
					$(this).focus();
					return false;
				}
			});

			$('#listcoursesession_course_title'+id).show();
			appendto(id,'<?php echo date("d.m.Y"); ?>');
			if(jQuery.inArray(shortcut, ltrjs)){
				$('#todo'+id).focus();
			}

		}
		else if( 
				   shortcut == "U"  || shortcut == "u" 
				|| shortcut == "V"  || shortcut == "v"
				|| ((shortcut == "VO"  || shortcut == "vo" || shortcut == "VE"  || shortcut == "ve") && module_vo_ve == "1")
				|| ((shortcut == "XT" || shortcut == "xt") && (modulepriv == "1" || modulepriv_bavaria == "1" ))
				|| ((shortcut == "G" || shortcut == "g") && (modulepriv_g == "1"  ))
				|| ((shortcut == "LS" || shortcut == "ls") && module_lysocare == "1")
				|| ((shortcut == "SD" || shortcut == "sd") && module_sd == "1")
				|| ((shortcut == "HB" || shortcut == "hb") && module_hb == "1" )
				|| ((shortcut == "AA" || shortcut == "aa") && (modulepriv == "1" || modulepriv_bavaria == "1" ) )
				|| ((shortcut == "XS" || shortcut == "xs") && module_xs == "1" )
				|| ((shortcut == "XE" || shortcut == "xe") && module_xe == "1" )
				
				|| ((shortcut == "PK" || shortcut == "pk") && module_pk == "1" )
				|| ((shortcut == "XN" || shortcut == "xn") && module_xn == "1" )
				|| ((shortcut == "ME" || shortcut == "ME")  )
				
				|| ((shortcut == "RK" || shortcut == "rk") && module203_rlp_special_sh == "1" )
				|| ((shortcut == "RI" || shortcut == "ri") && module203_rlp_special_sh == "1" )
				|| ((shortcut == "RO" || shortcut == "ro") && module203_rlp_special_sh == "1" )
				|| ((shortcut == "RD" || shortcut == "rd") && module203_rlp_special_sh == "1" )
				|| ((shortcut == "ML" || shortcut == "ml") && module_ml == "1" )
				|| ((shortcut == "DD" || shortcut == "dd") && module209_demstepcare_special_sh == "1" )
				|| ((shortcut == "DC" || shortcut == "dc") && module209_demstepcare_special_sh == "1" )
				|| ((shortcut == "XM" || shortcut == "xm") && module_xm == "1" )
				|| ((shortcut == "XH" || shortcut == "xh") && module_xh == "1" )
				|| ((shortcut == "XG" || shortcut == "xg") && module_xg == "1" )
				|| ((shortcut == "WT" || shortcut == "wt") && module_wt == "1" )	//TODO-3897 Lore 15.03.2021
				
				)
		{ //Koordination and Telefon 
			if($('#hidd'+id).length > 0)
			{
				$('#hidd'+id).hide().remove();
				$('#course_title'+id).val('');
			}

/* 			$("#time"+id).live("keyup input paste", function(){
				setTimeout(jQuery.proxy(function() {
					this.val(this.val().replace(/[^0-9]/g, ''));
				}, $(this)), 0);
			}); */
			
			//ISPC-2770 Lore 17.12.2020
			if( shortcut == "XT" || shortcut == "xt" 
				|| shortcut == "U"  || shortcut == "u" 
				|| shortcut == "V"  || shortcut == "v"){
				
				$("#time"+id).live("keyup input paste click", function(){
					setTimeout(jQuery.proxy(function() {
						this.val(this.val().replace(/[^0-9]/g, ''));
					}, $(this)), 0);
					
					//bigger than 0
					if($(this).val() == "0")$(this).val("");

					//small than 360
					if ($(this).val() > 360){
						var str = $(this).val();
						var res = str.substring(0, 3);
						//console.log(res);
						if(res > 360){
							//alert('Only integers between 1-360 !');
							jAlert(translate('Only integers between 1-360 !'), 'Alert');
							$(this).val("");
							appendto(id, "");
							insertsession(id,pid,total_cnt);

						} else {
							$(this).val(res);
						}
					} 
				});

				$("#komment"+id).live("keyup input paste click", function(){
					setTimeout(jQuery.proxy(function() {
						this.val(this.val().replace("|", '/'));
					}, $(this)), 0);
					
				});
				
			} else {
				$("#time"+id).live("keyup input paste", function(){
					setTimeout(jQuery.proxy(function() {
						this.val(this.val().replace(/[^0-9]/g, ''));
					}, $(this)), 0);
				});
			}
			//.

			if(shortcut == "U" || shortcut == "u")
			{
				var uSelect = '<select id="uSelect'+id+'" name="uSelect[]" style="" class="course_uselect" onchange="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" onblur="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"><option value="mit Betroffenen">mit Betroffenen</option><option value="mit Leistungserbringer">mit Leistungserbringer</option></select>';
				var comment_class = 'course_comment_small';
			}
			//ISPC-2902 Lore 27.04.2021
			else if ( (shortcut == "XT" || shortcut == "xt") && module_companion_xt == '1' ) {
				//var uSelect = '<select id="uSelect'+id+'" name="uSelect[]" style="" class="course_uselect" onchange="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" onblur="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"> <option value="-">----</option> 	<option value="mit Patienten"> mit Patienten </option>  <option value="mit Angehörigen"> mit Angehörigen</option>  <option value="mit Professionellen"> mit Professionellen</option></select>';
				<?php
						$xt_sel_str="";
						foreach($this->shortcut_options['XT'] as $key => $value) {
							$xt_sel_str .= '<option value="'.$key.'">'.$value.'</option>';
						}
					?>
				var uSelect = '<select id="uSelect'+id+'" name="uSelect[]" style="" class="course_uselect" onchange="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" onblur="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');">  <?php echo $xt_sel_str;?>  </select>';
				
				var comment_class = 'course_comment_small';
			}
			//.	
			else 
			{
				var uSelect = '';
				var comment_class = 'course_comment';
			}
			var module_lysocare_select = '';
			if (shortcut == "LS" || shortcut == "ls") {
				//hardcoded select
				module_lysocare_select = '';
                var module_lysocare_select = '<br/><select id="uCategory'+id+'" name="uCategory[]"  style="clear:both;" class="course_uselect" onchange="appendto('+id+', this.value); insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" >\n\
                    <option value="-">----</option>\n\
                    <option value="Terminvereinbarung / Abstimmung Infusionstermin">Terminvereinbarung / Abstimmung Infusionstermin</option>\n\
                    <option value="Lieferung">Lieferung</option>\n\
                    <option value="Generelle Frage zu Produkt bzw. Therapie">Generelle Frage zu Produkt bzw. Therapie</option>\n\
                    <option value="Wohlbefinden">Wohlbefinden</option>\n\
                    <option value="Fragen zum Lysocare Vermittlungsservice">Fragen zum Lysocare Vermittlungsservice</option>\n\
                    <option value="Veränderungen der Stammdaten">Veränderungen der Stammdaten</option>\n\
                    <option value="Versorgungsforschung">Versorgungsforschung</option>\n\
                    <option value="Sonstiges">Sonstiges</option>\n\
                    <option value="Anfrage bzw. Organisation der Übernahme der Versorgung">Anfrage bzw. Organisation der Übernahme der Versorgung</option>\n\
                    <option value="Rezeptmanagement">Rezeptmanagement</option>\n\
                    <option value="Einholen von Dokumenten">Einholen von Dokumenten</option>\n\
                    <option value="Update Therapieverlauf">Update Therapieverlauf</option>\n\
                </select>\n\
                <select id="uCategory_2_'+id+'" name="uCategory2[]"  style="" class="course_uselect" onchange="appendto('+id+', this.value); insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" >\n\
                    <option value="-">----</option>\n\
                    <option value="Inbound">Inbound</option>\n\
                    <option value="Outbound">Outbound</option>\n\
                </select>\n\
                <select id="uCategory_3_'+id+'" name="uCategory3[]"  style="" class="course_uselect" onchange="appendto('+id+', this.value); insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" >\n\
                    <option value="-">----</option>\n\
                    <option value="eingeschriebener Patient">eingeschriebener Patient</option>\n\
                    <option value="eingeschriebener Arzt">eingeschriebener Arzt</option>\n\
                    <option value="interessierter Patient">interessierter Patient</option>\n\
                    <option value="interessierter Arzt">interessierter Arzt</option>\n\
                    <option value="Apotheke">Apotheke</option>\n\
                    <option value="eingeschriebener Pflegedienst">eingeschriebener Pflegedienst</option>\n\
                    <option value="potenzieller Pflegedienst">potenzieller Pflegedienst</option>\n\
                    <option value="Angehöriger">Angehöriger</option>\n\
                    <option value="Patientenorganisation">Patientenorganisation</option>\n\
                </select>';
			}

			//TODO-3897 Lore 15.03.2021
			var module_wt_select = '';
			if (shortcut == "WT" || shortcut == "wt") {
				//hardcoded select
				module_wt_select = '';
	            var module_wt_select = '<br/><select id="uCategory'+id+'" name="uCategory[]" style="" class="course_uselect" onchange="appendto(\''+id+'\',this.value);  insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" >\n\
	                <option value="-">----</option>\n\
	            	<option value="Terminvereinbarung">Terminvereinbarung</option>\n\
	                <option value="Abstimmung der Lieferung">Abstimmung der Lieferung</option>\n\
	                <option value="Generelle Fragen zum Produkt/zur Therapie">Generelle Fragen zum Produkt/zur Therapie</option>\n\
	                <option value="Wohlbefinden/Abfrage AZ">Wohlbefinden/Abfrage AZ</option>\n\
	                <option value="Veränderung der Stammdaten">Veränderung der Stammdaten</option>\n\
	                <option value="Rezeptmanagement">Rezeptmanagement</option>\n\
	                <option value="Einholen von Dokumenten ">Einholen von Dokumenten </option>\n\
		            <option value="Update Therapieverlauf">Update Therapieverlauf</option>\n\
		            <option value="Erinnerungsservice">Erinnerungsservice</option>\n\
		            <option value="Einholen von Laborwerten">Einholen von Laborwerten</option>\n\
	                <option value="Sonstiges">Sonstiges</option>\n\
	            </select>\n\
	            <select id="uCategory_2_'+id+'" name="uCategory2[]"  style="" class="course_uselect" onchange="appendto('+id+', this.value); insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" >\n\
		            <option value="-">----</option>\n\
		            <option value="Inbound">Inbound</option>\n\
		            <option value="Outbound">Outbound</option>\n\
		        </select>\n\
		        <select id="uCategory_3_'+id+'" name="uCategory3[]"  style="" class="course_uselect" onchange="appendto('+id+', this.value); insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" >\n\
		        	<option value="-">----</option>\n\
		            <option value="Eingeschriebener Patient ">Eingeschriebener Patient </option>\n\
		            <option value="Eingeschriebener Arzt ">Eingeschriebener Arzt </option>\n\
		            <option value="Interessierter Patient">Interessierter Patient</option>\n\
		            <option value="Interessierter Arzt">Interessierter Arzt</option>\n\
		            <option value="Apotheke">Apotheke</option>\n\
		            <option value="Angehöriger interessierter Patient ">Angehöriger interessierter Patient </option>\n\
		            <option value="Angehöriger eingeschriebener Patient">Angehöriger eingeschriebener Patient</option>\n\
		            <option value="Sonstige">Sonstige</option>\n\
		        </select>';
			}
			//.	
			
			
			var newInputs = '<div id="hidd'+id+'">\n\
				'+uSelect+'\n\
				<input type="text" id="time'+id+'"class="caret course_time" name="time[]" value="Zeit (in Minuten)" onfocus="if(this.value == \'Zeit (in Minuten)\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Zeit (in Minuten)\' } else { appendto (\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" onkeydown="appendto(\''+id+'\',this.value);"/>\n\
				<textarea name="komment[]" id="komment'+id+'" class="'+comment_class+'" onfocus="if(this.value == \'Grund / Anlass\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Grund / Anlass\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" >Grund / Anlass</textarea> \n\
				<input type="text" id="date'+id+'" name="date[]" class="caret course_date" value="<?php echo date("d.m.Y"); ?>" onfocus="appendto(\''+id+'\',this.value);"  onblur="if(this.value == \'\'){ this.value=\'<?php echo date("d.m.Y"); ?>\' } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\')"   onchange="if(this.value == \'\'){ this.value=\'<?php echo date("d.m.Y"); ?>\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>\n\
				<input type="text" id="hourtime'+id+'" name="hourtime[]" class="timepick course_timepicker"  value="<?php echo date("H:i"); ?>"   onfocus="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" onblur="if(this.value == \'\'){ this.value=\'<?php echo date("H:i"); ?>\' }"       onchange="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>\n\
				'+module_lysocare_select+module_wt_select+'\n\
			</div>';
			$('#listcoursesession_course_title'+id).append(newInputs);

			$('#komment'+id).elastic();
			
			$('#date' + id).mask("99.99.9999");
			$('#date'+id).datepicker({
				dateFormat: 'dd.mm.yy',
				showOn: "both",
				buttonImage: $('#calImg').attr('src'),
				buttonImageOnly: true,
				changeMonth: true,
				changeYear: true,
				nextText: '',
				prevText: '',
				onSelect: function(date) {
					appendto(id,date.value);
					insertsession(id,pid,total_cnt);
					$(this).focus();
					return false;
				}
			});

			$('#hourtime' + id).timepicker({
				onSelect : function(time_value) {
					if($('#date'+id).val()==""){
						$('#date'+id).val("<?php echo date('d.m.Y'); ?>");
					}
					appendto(id, time_value);
					insertsession(id, pid, total_cnt);
					$(this).focus();
					return false;
				},
				minutes : {
					interval : 5
				},
				showPeriodLabels : false,
				rows : 4,
				hourText : 'Stunde',
				minuteText : 'Minute'
			});

			$('#course_title' + id).hide();

			$('#listcoursesession_course_title' + id).show();
			appendto(id, '<?php echo date("d.m.Y"); ?>');
			if (jQuery.inArray(shortcut, ltrjs)) {
				$('#time' + id).focus();
			}

		}
		else if((shortcut == "PB" || shortcut == "pb")) 
		{ 
			if($('#hidd'+id).length > 0)
			{
				$('#hidd'+id).hide().remove();
				$('#course_title'+id).val('');
			}

			$("#time"+id).live("keyup input paste", function(){
				setTimeout(jQuery.proxy(function() {
					this.val(this.val().replace(/[^0-9]/g, ''));
				}, $(this)), 0);
			});

			var uSelect = '';
			var comment_class = 'course_comment_pb';

			var newInputs = '<div id="hidd'+id+'">\n\
				'+uSelect+'<textarea name="komment[]" id="komment'+id+'" class="'+comment_class+'" onfocus="if(this.value == \'Inhalt\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Inhalt\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" >Inhalt</textarea> \n\
				<input type="text" id="date'+id+'" name="date[]" class="caret course_date" value="<?php echo date("d.m.Y"); ?>" onfocus="appendto(\''+id+'\',this.value);"  onblur="if(this.value == \'\'){ this.value=\'<?php echo date("d.m.Y"); ?>\' }"   change="if(this.value == \'\'){ this.value=\'Date\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>\n\
				<input type="text" id="hourtime'+id+'" name="hourtime[]" class="timepick course_timepicker"  value="<?php echo date("H:i"); ?>"    onblur="if(this.value == \'\'){ this.value=\'<?php echo date("H:i"); ?>\' }"       onchange="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>\n\
			</div>';
			$('#listcoursesession_course_title'+id).append(newInputs);
			
			$('#komment'+id).elastic();
			$('#date'+id).datepicker({
				dateFormat: 'dd.mm.yy',
				showOn: "both",
				buttonImage: $('#calImg').attr('src'),
				buttonImageOnly: true,
				changeMonth: true,
				changeYear: true,
				nextText: '',
				prevText: '',
				onSelect: function(date) {
					appendto(id,date.value);
					insertsession(id,pid,total_cnt);
					$(this).focus();
					return false;
				}
			});

			$('#hourtime' + id).timepicker({
				onSelect : function(time_value) {
					if($('#date'+id).val()==""){
						$('#date'+id).val("<?php echo date('d.m.Y'); ?>");
					}
					appendto(id, time_value);
					insertsession(id, pid, total_cnt);
					$(this).focus();
					return false;
				},
				minutes : {
					interval : 5
				},
				showPeriodLabels : false,
				rows : 4,
				hourText : 'Stunde',
				minuteText : 'Minute'
			});

			$('#course_title' + id).hide();

			$('#listcoursesession_course_title' + id).show();
			appendto(id, '<?php echo date("d.m.Y"); ?>');
			if (jQuery.inArray(shortcut, ltrjs)) {
				$('#time' + id).focus();
			}	
	  	}
		else if(shortcut == "KX" || shortcut == "kx") 
		{
			if($('#hidd'+id).length > 0)
			{
				$('#hidd'+id).hide().remove();
				$('#course_title'+id).val('');
			}

			$("#time"+id).live("keyup input paste", function(){
				setTimeout(jQuery.proxy(function() {
					this.val(this.val().replace(/[^0-9]/g, ''));
				}, $(this)), 0);
			});

			var uSelect = '';
			var comment_class = 'course_comment_pb';

			var newInputs = '<div id="hidd'+id+'">\n\
				'+uSelect+'<textarea name="komment[]" id="komment'+id+'" class="'+comment_class+'" onfocus="if(this.value == \'Inhalt\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" ></textarea> \n\
				<input type="text" id="date'+id+'" name="date[]" class="caret course_date" value="<?php echo date("d.m.Y"); ?>" onfocus="appendto(\''+id+'\',this.value);"  onblur="if(this.value == \'\'){ this.value=\'<?php echo date("d.m.Y"); ?>\' }"   change="if(this.value == \'\'){ this.value=\'Date\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>\n\
				<input type="text" id="hourtime'+id+'" name="hourtime[]" class="timepick course_timepicker"  value="<?php echo date("H:i"); ?>"    onblur="if(this.value == \'\'){ this.value=\'<?php echo date("H:i"); ?>\' }"       onchange="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>\n\
			</div>';
			$('#listcoursesession_course_title'+id).append(newInputs);
			
			$('#komment'+id).elastic();
			$('#date'+id).datepicker({
				dateFormat: 'dd.mm.yy',
				showOn: "both",
				buttonImage: $('#calImg').attr('src'),
				buttonImageOnly: true,
				changeMonth: true,
				changeYear: true,
				nextText: '',
				prevText: '',
				onSelect: function(date) {
					appendto(id,date.value);
					insertsession(id,pid,total_cnt);
					$(this).focus();
					return false;
				}
			});

			$('#hourtime' + id).timepicker({
				onSelect : function(time_value) {
					if($('#date'+id).val()==""){
						$('#date'+id).val("<?php echo date('d.m.Y'); ?>");
					}
					appendto(id, time_value);
					insertsession(id, pid, total_cnt);
					$(this).focus();
					return false;
				},
				minutes : {
					interval : 5
				},
				showPeriodLabels : false,
				rows : 4,
				hourText : 'Stunde',
				minuteText : 'Minute'
			});

			$('#course_title' + id).hide();

			$('#listcoursesession_course_title' + id).show();
			appendto(id, '<?php echo date("d.m.Y"); ?>');
			if (jQuery.inArray(shortcut, ltrjs)) {
				$('#time' + id).focus();
			}
		}
		else if (shortcut == "D" || shortcut == "H" || shortcut == "d" || shortcut == "h" || ((shortcut == "HS" || shortcut == "hs") && has_hs_fields === false) ) 
	  	{ //Diagnosis and Hauptdiagnosen
			
			if ($('#hidd' + id).length > 0) 
			{
				$('#hidd' + id).hide().remove();
				$('#course_title' + id).val('');
			}
			
			var $error_div = '';
			if(shortcut == "HS" || shortcut == "hs")
			{
				if($disable_hs_insert == '1') {
					var $error_div = '<div id="error' + id + '" class="verlauf_error_div" style="display:block;clear: both;"><?php echo $this->translate('hs_limit_patient_reached'); ?></div>';
				} else {
					var $error_div = '<div id="error' + id + '" class="verlauf_error_div" style="display:none;clear: both;"><?php echo $this->translate('hs_limit_patient_reached'); ?></div>';
				}
			}
			
			newInputs = '<div id="hidd'+id+'"><input name="icdnumber['
					+ id
					+ ']" id="icdnumber'
					+ id
					+ '" class="livesearchicdinp caret" value="ICD"  style="width:45px;" type="text" onfocus="if(this.value == \'ICD\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'ICD\' } else { appendto(\''
					+ id
					+ '\',this.value) } insertsession(\''
					+ id
					+ '\',\''
					+ pid
					+ '\',\''
					+ total_cnt
					+ '\');" /><div id="icddiagnodropdown'+id+'"  class="icdlivesearchdropdown" style="position: absolute; display:none;"></div><input name="diagnosis['
					+ id
					+ ']" id="diagnosis'
					+ id
					+ '" value="Beschreibung" size="33" class="livesearchinp caret course_diag_name" type="text"  onfocus="if(this.value == \'Beschreibung\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Beschreibung\' } else { appendto(\''
					+ id
					+ '\',this.value) } insertsession(\''
					+ id
					+ '\',\''
					+ pid
					+ '\',\''
					+ total_cnt
					+ '\');" />     <input name="hidd_icdnumber['+id+']" value="" id="hidd_icdnumber'+id+'" type="hidden"> <input name="hidd_diagnosis['+id+']" value="" id="hidd_diagnosis'+id+'" type="hidden"><input name="hidd_tab['+id+']" value="" id="hidd_tab" type="hidden"></div> <div id="diagnodropdown'+id+'" class="samtablistDiognoDrp livesearchdropdown" style="position: absolute; display:none;"></div>'+$error_div+'';

			$('#listcoursesession_course_title' + id).append(newInputs);
			$('#course_title' + id).hide();
			$('#listcoursesession_course_title' + id).show();
			$('#icdnumber'+id).focus();

			//new version
			$('.livesearchicdinp').live('change', function() {
				var input_row = parseInt($(this).attr('id').substr(('icdnumber').length));
				reset_diagnosis(input_row);
			}).liveSearch({
				url : 'ajax/diagnosis?mode=icdnumber&q=',
				id : 'livesearch_admission_diagnosis',
				aditionalWidth : '560',
				noResultsDelay : '900',
				typeDelay : '900',
				returnRowId : function(input) {
					return parseInt($(input).attr('id').substr(('icdnumber').length));
				}
			});

			//livesearch diagnosis description ls
			$('.livesearchinp').live('change', function() {
				var input_row = parseInt($(this).attr('id').substr(('diagnosis').length));
				reset_diagnosis(input_row);
			}).liveSearch({
				url : 'ajax/diagnosis?q=',
				id : 'livesearch_admission_diagnosis',
				aditionalWidth : '0',
				noResultsDelay : '900',
				typeDelay : '900',
				returnRowId : function(input) {
					return parseInt($(input).attr('id').substr(('diagnosis').length));
				}
			});
			
			var has_hs_fields = true;//remove shortcut if user is trying to add more than one hs entry
			
			
		} 
		else if ((shortcut == "HS" || shortcut == "hs") && has_hs_fields === true) 
		{
			$('#course_type' + id).val('').focus();
			$('.verlauf_error_div').show();
			$('#course_title' + id).show();
			$('#hidd' + id).hide().remove();
			$('#course_title' + id).val('');
			
		}
		else if (shortcut == "AL" && module_al == "1"){
					
			if ($('#hidd' + id).length > 0) 
			{
				$('#hidd' + id).hide().remove();
				$('#course_title' + id).val('');
			}
			
			newInputs = '<div id="hidd'+id+'">';
			newInputs +='<input name="actionid['+ id+ ']" id="actionid'+id+'" class="live_search_al_action_id caret" value="ID"  style="width:45px;" type="text" onfocus="if(this.value == \'ID\') { this.value=\'\'}" 	onblur="if(this.value == \'\'){ this.value=\'ID\' } else { appendto(\''+ id+ '\',this.value) } trigger_insertsession(\''+ id+ '\',\''+ pid+ '\',\''+ total_cnt+ '\');"  autocomplete="off" />';
			newInputs +='<input name="description['+ id+ ']" id="description'+ id+ '" value="Beschreibung" style="width:450px!important" class="live_search_al_description caret course_action_name" type="text"  onfocus="if(this.value == \'Beschreibung\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Beschreibung\' } else { appendto(\''+ id+ '\',this.value) } trigger_insertsession(\''+ id+ '\',\''	+ pid + '\',\''	+ total_cnt	+ '\');" />';
			newInputs +='<input name="date[]" id="al_date'+id+'" style="height: 17px;width: 65px;" type="text" class="caret al_course_date" value="<?php echo date("d.m.Y"); ?>" onblur="if(this.value == \'\'){ this.value=\'<?php echo date("d.m.Y"); ?>\' }"   onchange="if(this.value == \'\'){ this.value=\'<?php echo date("d.m.Y"); ?>\' } else { appendto(\''+id+'\',this.value) } trigger_insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>';
						
			newInputs +='<input type="hidden" name="hidd_actionid['+ id+ ']" id="hidd_actionid'+id+'" value="" />';
			newInputs +='<input type="hidden" name="hidd_description['+ id+ ']" id="hidd_description'+ id+ '" value="" />';
			newInputs +='<input type="hidden" name="hidd_date['+ id+ ']" id="hidd_date'+id+'" value="<?php echo date("d.m.Y"); ?>" style="height:16px;" type="text" />';
			newInputs +='</div>';
			
			
			$('#listcoursesession_course_title' + id).append(newInputs);
			
			datapicker_al(id);
			liveSearch_al();
			
			$('#course_title' + id).hide();
			$('#listcoursesession_course_title' + id).show();
			$('#actionid'+id).focus();
	
			
		}
		else if (shortcut == "LE" && module_le == "1") 
	  	{ //XBDT ACTIONS
			if ($('#hidd' + id).length > 0) 
			{
				$('#hidd' + id).hide().remove();
				$('#course_title' + id).val('');
			}
	  	
			<?php
					foreach($this->users_le as $sel_user_id=>$sel_user) {
						if($this->userid == $sel_user_id){
							$u_selected = 'selected="selected"';						
						}else{
							$u_selected = "";						
						}
						//TODO-3925 Ancuta 05.03.2021
						$sel_user = str_replace("'",'&apos;',$sel_user);
						//--
						$le_sel_str .= '<option value="'.$sel_user_id.'" '.$u_selected.' >'.$sel_user.'</option>';
					}
				?>

			var le_users_select = '<select name="actionuser['+id+']" id="actionuser'+id+'" onblur="appendto('+id+',this.value);" onchange="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" style="width:120px; text-align:left; float:left;" class="caret"><?php echo $le_sel_str;?></select>';
			
			
			newInputs = '<div id="hidd'+id+'">';
			newInputs +='<input name="actionid['+ id+ ']" id="actionid'+id+'" class="live_search_action_id caret" value="ID"  style="width:65px;" type="text" onfocus="if(this.value == \'ID\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'ID\' } else { appendto(\''+ id+ '\',this.value) } insertsession(\''+ id+ '\',\''+ pid+ '\',\''+ total_cnt+ '\');"  autocomplete="off" />';
// 			newInputs +='<div id="icddiagnodropdown'+id+'"  class="icdlivesearchdropdown" style="position: absolute; display:none;"></div>';
			newInputs +='<div id="action_le_livesearch'+id+'"  class="action_le_livesearch" style="position: absolute; display:none;"></div>';
			newInputs +='<input name="actionname['+ id+ ']" id="actionname'+ id+ '" value="Leistungen" size="10" class="live_search_action_name caret course_action_name" type="text"  onfocus="if(this.value == \'Leistungen\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Leistungen\' } else { appendto(\''+ id+ '\',this.value) } insertsession(\''+ id+ '\',\''	+ pid + '\',\''	+ total_cnt	+ '\');" />';
			newInputs +='<input name="hidd_actionid['+id+']" value="" id="hidd_actionid'+id+'" type="hidden">';
			newInputs +='<input name="hidd_actionname['+id+']" value="" id="hidd_actionname'+id+'" type="hidden">';
			
			//user select 
			newInputs += le_users_select;
			// date field
			newInputs +='<input type="text" id="date'+id+'" name="date[]" class="caret course_date" value="<?php echo date("d.m.Y"); ?>" onfocus="appendto(\''+id+'\',this.value);"  onblur="if(this.value == \'\'){ this.value=\'<?php echo date("d.m.Y"); ?>\' } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\')"   onchange="if(this.value == \'\'){ this.value=\'<?php echo date("d.m.Y"); ?>\' } else { appendto(\''+id+'\',this.value) } insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>';
			newInputs +='<input type="text" id="hourtime'+id+'" name="hourtime[]" class="timepick course_timepicker"  value="<?php echo date("H:i"); ?>"   onfocus="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');" onblur="if(this.value == \'\'){ this.value=\'<?php echo date("H:i"); ?>\' }"       onchange="insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');"/>';
			
			newInputs +='</div>';
// 			newInputs +='<div id="diagnodropdown'+id+'" class="samtablistDiognoDrp livesearchdropdown" style="position: absolute; display:none;"></div>';
			
			$('#listcoursesession_course_title' + id).append(newInputs);
			$('#course_title' + id).hide();
			$('#listcoursesession_course_title' + id).show();
			$('#actionid'+id).focus();

			$('.live_search_action_id').live('change', function() {
				var input_row = parseInt($(this).attr('id').substr(('actionid').length));
				reset_actions(input_row);
			}).liveSearch({
				url : 'ajax/xbdtactions?mode=action_id&q=',
				id : 'livesearch_admission_diagnosis',
				aditionalWidth : '560',
				noResultsDelay : '900',
				typeDelay : '900',
				returnRowId : function(input) {
					return parseInt($(input).attr('id').substr(('actionid').length));
				}
			});
			
			$('.live_search_action_name').live('change', function() {
				var input_row = parseInt($(this).attr('id').substr(('actionname').length));
				reset_actions(input_row);
			}).liveSearch({
				url : 'ajax/xbdtactions?q=',
				id : 'livesearch_admission_diagnosis',
				aditionalWidth : '0',
				noResultsDelay : '900',
				typeDelay : '900',
				returnRowId : function(input) {
					return parseInt($(input).attr('id').substr(('actionname').length));
				}
			});
			
			$('#date' + id).mask("99.99.9999");
			$('#date'+id).datepicker({
				dateFormat: 'dd.mm.yy',
				showOn: "both",
				buttonImage: $('#calImg').attr('src'),
				buttonImageOnly: true,
				changeMonth: true,
				changeYear: true,
				nextText: '',
				prevText: '',
				onSelect: function(date) {
					appendto(id,date.value);
					insertsession(id,pid,total_cnt);
					$(this).focus();
					return false;
				}
			});

			$('#hourtime' + id).timepicker({
				onSelect : function(time_value) {
					if($('#date'+id).val()==""){
						$('#date'+id).val("<?php echo date('d.m.Y'); ?>");
					}
					appendto(id, time_value);
					insertsession(id, pid, total_cnt);
					$(this).focus();
					return false;
				},
				minutes : {
					interval : 5
				},
				showPeriodLabels : false,
				rows : 4,
				hourText : 'Stunde',
				minuteText : 'Minute'
			});

			$('#course_title' + id).hide();

			$('#listcoursesession_course_title' + id).show();
			
 
			
		} 		
		else if (shortcut == "P" || shortcut == "p") 
		{
			$('#hidd' + id).remove();

			var medications_list = <?php echo json_encode($this->patient_medications); ?>;

			//create medication dropdown!
			var dropdown_list = '<select id="medications-' + id
					+ '" class="medications_dd" rel="' + id
					+ '" style="width: 550px;" name="verlauf_edit[' + idminus
					+ ']" onchange="load_medi($(this)); insertsession(\'' + id
					+ '\',\'' + pid + '\',\'' + total_cnt + '\');">';

			$.each(medications_list, function(i, item) {

				if (i == '999999999') {
					dropdown_list += '<option value="0">' + item + '</option>';
				} else {
					dropdown_list += '<optgroup label="'+jsTranslate[i]+'">';
					$.each(item, function(key, value) {
						dropdown_list += '<option value="'+key+'">' + value
								+ '</option>';
					});
					dropdown_list += '</optgroup>';
				}
			});
			dropdown_list += '</select>';

			newInputs = '<div id="hidd'+id+'">'
					+ dropdown_list
					
					+ '<label for="delete'+id+'"><input type="checkbox" id="delete'+id+'" name="delete[]" value="1" style="margin-top:10px;" />absetzen</label><br />';
					
					+ '<div id="medication-content-'+id+'" style="display:none;">';
			newInputs += '<input type="hidden" id="medi_id'+id+'" name="id_medication['+idminus+']" value=""/>';
			newInputs += '<input type="hidden" id="drid'+id+'" name="drid['+idminus+']" value=""/>';
			newInputs += '<input type="text" id="medi_change'+id+'"  class="med_data" name="medication_change['+idminus+']" value="" style="width:62px; text-align:left; float:left; padding:5px; margin-right:3px;" />';
			newInputs += '<input type="hidden" id="medi_replace'+id+'"  name="replace_with['+idminus+']" value=""/>';
			/*newInputs += '<input type="text" id="medi_name'
					+ id
					+ '" name="medication['
					+ idminus
					+ ']" class="course_medi_name_edit" value="" onblur="insertsession(\''
					+ id + '\',\'' + pid + '\',\'' + total_cnt + '\');" />';
			newInputs += '<input type="text" id="dosage'
					+ id
					+ '" name="dosage['
					+ idminus
					+ ']" value="" style="width:80px; text-align:left; padding:5px; margin-left:5px; float:left;" onblur="insertsession(\''
					+ id + '\',\'' + pid + '\',\'' + total_cnt + '\');" />';
			newInputs += '<input type="text" id="comments'
					+ id
					+ '" name="comments['
					+ idminus
					+ ']" value="" style="width:150px; text-align:left; padding:5px; margin-left:5px; float:left;" onblur="insertsession(\''
					+ id + '\',\'' + pid + '\',\'' + total_cnt + '\');" />';*/
			newInputs += '<input type="text" id="medi_name'
				+ id
				+ '" name="medication['
				+ idminus
				+ ']" class="course_medi_name_edit" placeholder="Name" value="" onblur="insertsession(\''
				+ id + '\',\'' + pid + '\',\'' + total_cnt + '\');" />';
			newInputs += '<input type="text" id="dosage'
				+ id
				+ '" name="dosage['
				+ idminus
				+ ']" placeholder="Dosierung" value="" style="width:80px; text-align:left; padding:5px; margin-left:5px; float:left;" onblur="insertsession(\''
				+ id + '\',\'' + pid + '\',\'' + total_cnt + '\');" />';
			newInputs += '<input type="text" id="comments'
				+ id
				+ '" name="comments['
				+ idminus
				+ ']" placeholder="Kommentar" value="" style="width:150px; text-align:left; padding:5px; margin-left:5px; float:left;" onblur="insertsession(\''
				+ id + '\',\'' + pid + '\',\'' + total_cnt + '\');" />';
			//newInputs += '<label for="delete'+id+'" style="line-height: 32px; margin-left: 3px;">absetzen</label><input type="checkbox" id="delete'+id+'" name="delete[]" value="1" style="float:left; margin-left: 5px;line-height: 26px;margin-top: 10px;width: 15px" /><br />';
			newInputs += '</div></div>';

			$('#listcoursesession_course_title' + id).append(newInputs);

			$('#course_title' + id).hide();
			$('#listcoursesession_course_title' + id).show();
			
		} 
		else if (shortcut == "S" || shortcut == "s") 
		{
			$('#hidd' + id).remove();

			var symptoms = <?php echo json_encode($this->symptoms_data); ?>;
			var symptoms_select = '<?php echo $this->sympt_view_select; ?>';

			//create sym dropdown!
			var dropdown_list = '<table class="datatable" id="verlauf">';
			$.each(symptoms, function(i, item) {
				if (i != '999999999') {
					dropdown_list += '<tr><td colspan="3"><b>' + i + '</b></td></tr>';
					$.each(item, function(key, value) {
						dropdown_list += '<tr>';
						dropdown_list += '<td>';
						dropdown_list += '<span>'
								+ value
								+ '</span>';
						dropdown_list += '<input type="hidden" value="'+key+'" id="symptom-'+id+'" name="symptom['+idminus+'][]" />';
						dropdown_list += '</td>';
						dropdown_list += '<td>';
						if (symptoms_select == "a") {
							dropdown_list += '<select  id="sym_value'+key+'-'+id+'" name="sym_value['+idminus+'][]"  class="sym_val" ><option value=""></option><option value="0">kein</option><option value="4">leicht</option><option value="7">mittel</option><option value="10">schwer</option> </select>';
						} else {
							dropdown_list += '<input type="text" id="sym_value'
									+ key
									+ '-'
									+ id
									+ '" name="sym_value['
									+ idminus
									+ '][]" value="" class="sym_val" onkeyup="isInteger(\''
									+ key
									+ '-'
									+ id
									+ '\')" style="width:25px; margin-left:5px; text-align:left; float:left; padding: auto;" />';
						}

						dropdown_list += '</td>';
						dropdown_list += '<td>';
						dropdown_list += '<input type="text" id="sym_coment'+id+'" name="sym_coment['+idminus+'][]" value="" class="sym_coment" style="width:235px; margin-left:5px; text-align:left; float:left; padding: auto;" />';
						dropdown_list += '</td>';
						dropdown_list += '</tr>';
					});
				}
			});
			dropdown_list += '</table>';

			newInputs = '<div id="hidd'+id+'">' + dropdown_list + '';
			newInputs += '</div>';

			$('#course_title' + id).hide();
			$('#listcoursesession_course_title' + id).append(newInputs);
			$('#listcoursesession_course_title' + id).show();
		} 
		else if (shortcut == "SB" || shortcut == "sb") 
		{ //  Sanitatshausbestellung -> medical supply order

			if ($('#hidd' + id).length > 0) 
			{
				$('#hidd' + id).hide().remove();
				$('#course_title' + id).val('');
			}

			//var sb_usersSelect = '<?php $attrs = array("onblur" => "appendto(\''+id+'\',this.value);", "onchange"=>"insertsession(\''+id+'\',\''+pid+'\',\''+total_cnt+'\');", "style" => "width:150px; text-align:left; float:left;", "class" => "caret"); echo str_replace("\n", "", $this->formSelect("sb_user'+id+'", "", $attrs, $this->sb_users)); ?>';

			<?php
				foreach($this->sb_users as $sel_sb_user_id=>$sel_sb_user) {
					$sel_sb_str .= '<option value="'.$sel_sb_user_id.'">'.$sel_sb_user.'</option>';
				}
			?>

			var sb_usersSelect = '<select name="sb_user'
					+ id
					+ '" id="sb_user'
					+ id
					+ '" onblur="appendto('
					+ id
					+ ',this.value);" onchange="insertsession(\''
					+ id
					+ '\',\''
					+ pid
					+ '\',\''
					+ total_cnt
					+ '\');" style="width:150px; text-align:left; float:left;" class="caret"><?php echo $sel_sb_str;?></select>';
			newInputs = '<div id="hidd'+id+'">'
					+ sb_usersSelect
					+ '<textarea id="sb_order'
					+ id
					+ '"class="caret course_sb_order" name="sb_order[]" value="Sanitätshausbestellung" onfocus="if(this.value == \'Sanitätshausbestellung\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Sanitätshausbestellung\' } else { appendto(\''
					+ id + '\',this.value) } insertsession(\'' + id + '\',\''
					+ pid + '\',\'' + total_cnt
					+ '\');">Sanitätshausbestellung</textarea></div>';

			$('#listcoursesession_course_title' + id).append(newInputs);

			$('#sb_order' + id).elastic();

			$('#course_title' + id).hide();

			$('#listcoursesession_course_title' + id).show();

			appendto(id, '<?php echo date("d.m.Y"); ?>');

			if (jQuery.inArray(shortcut, ltrjs)) 
			{
				$('#sb_order' + id).focus();
			}
		}
		else if(shortcut == "L" || shortcut == "l")
		{
			if($('#hidd'+id).length > 0)
			{
				$('#hidd'+id).hide().remove();
				$('#course_title'+id).val('');
			}
			
			newInputs = ' <div id="hidd'+id+'"><textarea name="services['+ id+ ']" id="lrownumber'+ id+ '" class="serviceslivesearvh caret" style="   width: 614px; margin: 3px 0; display: block;   height: 26px;   overflow: hidden;" onfocus="if(this.value == \'Leistungen\') { this.value=\'\'}" onblur="if(this.value == \'\'){ this.value=\'Leistungen\' } else { appendto(\''+ id	+ '\',this.value) } insertsession(\''+ id+ '\',\''	+ pid	+ '\',\''+ total_cnt+ '\');" >Leistungen</textarea></div>';
           
			$('#course_title' + id).hide();
			$('#course_title' + id).hide();
			$('#listcoursesession_course_title' + id).append(newInputs);
			$('#listcoursesession_course_title' + id).show();
			$('#lrownumber'+id).elastic(); // TODO-1595< line moved under append
				//new version
			
			if(moduleprivl == "1")
			{
				$('.serviceslivesearvh').live('change', function() {
					var input_row = parseInt($(this).attr('id').substr(('lrownumber').length));
					//reset_diagnosis(input_row);
				}).liveSearch({
					url : 'ajax/services?q=',
					id : 'livesearch_services',
					aditionalWidth : '560',
					noResultsDelay : '900',
					typeDelay : '900',
					returnRowId : function(input) {
						return parseInt($(input).attr('id').substr(('lrownumber').length));
					}
				});
			}
		} 
		else 
		{
			$('#course_title' + id).show();
			$('#hidd' + id).hide().remove();
			$('#course_title' + id).val('');
		}
		
		
        //disable write untill you select the shortcut
        if (shortcut == null || shortcut == '') {
            $(_this).parents('div.shortcutRow')
            .find('textarea.defaultTextarea').attr('disabled', true).attr('placeholder', translate("Please select action first"));
        } else {
            $(_this).parents('div.shortcutRow')
            .find('textarea.defaultTextarea').attr('disabled', false).attr('placeholder', '').end()
            .find('.RightList01 input[type=text], .RightList01 textarea').filter(':input:visible:first').focus();
            
            //TODO : change into addNewShortcutActionRow 
          	//check to see if we must add a new empty rowthis
          	//_this is not realy needed, it's just sent as a precaution for the selector
          	//give a ID to your actions holder and will use that to count the rows (row = div.shortcutRow)
          	//if enabled also check to see if we must add a new empty row
            //addNewShortcutActionRow(_this);
        }
		
		
	}

	
	
	
	function reset_actions(input_row) {
		if ($('#hidd_tab' + input_row).val() != 'text') {
			$('#hidd_actionid' + input_row).val('');
			$('#hidd_actionname' + input_row).val('');
		}
	}
	function select_actions(did, row) {
		$('#actionid' + row).val($('#action_id_' + did).val());
		$('#actionname' + row).val($('#action_name_' + did).val());
		$('#hidd_actionid' + row).val($('#action_row_id_' + did).val());
		$('#hidd_actionname' + row).val($('#action_row_id_' + did).val());
		$('#actionid' + row).blur(); //why you no lost focus?
		$('#actionname' + row).focus();
	}
	
	
	function reset_diagnosis(input_row) {
		if ($('#hidd_tab' + input_row).val() != 'text') {
			$('#hidd_icdnumber' + input_row).val('');
			$('#hidd_diagnosis' + input_row).val('');
			$('#hidd_tab' + input_row).val('text');
		}
	}
	function selectDiagnosis(did, row) {
		$('#icdnumber' + row).val($('#diag_icd_' + did).val());
		$('#diagnosis' + row).val($('#diag_de_' + did).val());
		$('#hidd_icdnumber' + row).val($('#diag_id_' + did).val());
		$('#hidd_diagnosis' + row).val($('#diag_id_' + did).val());
		$('#hidd_tab' + row).val('dig');
		$('#icdnumber' + row).blur(); //why you no lost focus?
		$('#diagnosis' + row).focus();
	}
	
	
	
	function selectServices(did, row) {
		$('#lrownumber' + row).val($('#diag_icd_' + did).val());
// 		$('#diagnosis' + row).val($('#diag_de_' + did).val());
    	$('#hidd_icdnumber' + row).val($('#diag_id_' + did).val());
//		$('#hidd_diagnosis' + row).val($('#diag_id_' + did).val());
// 		$('#hidd_tab' + row).val('dig');
// 		$('#icdnumber' + row).blur(); //why you no lost focus?
		$('#lrownumber' + row).focus();
	}

	function checkFields(formname) {
		$('.caret').each(function() {
			if ($(this).val() != "Name" && $(this).val != "Kommentar" && $(this).val() != "Dosierung" && $(this).val() != "TODO" && $(this).val() != "Beschreibung") {
				if (checkdischargednew(formname)) {
					var submitstr = "document." + formname + ".submit()";
					eval(submitstr);
				}
			} else {
				jConfirm('Empty fields, do you want to continue', '', function(r) {
					if (r && checkdischargednew(formname)) {
						var submitstr = "document." + formname + ".submit()";
						eval(submitstr);
						//return true;
					}
				});
				return false;
			}
		});
		return false;
	}
	
	function closediaearch(ele) {
		id = $(ele).attr('id');

		$('#diagnodropdown' + id).hide();
		$('#icddiagnodropdown' + id).hide();
		$('.focused').removeClass('focused');
	}
	
	$(document).ready(function() {
		var pid = $('#patientid').val();
		
		// USER Filter settings
		if(filterkeysjs.length > 0){
			$.each(filterkeysjs,function(i, item) {
				if($('input[name='+item+']').is(':checked')) {
					$('input[name='+item+']').removeAttr('checked');
				} else {
					$('input[name='+item+']').attr('checked','checked');
				}
				
			$('.verlauf_li_filter').addClass("filter_available");
			
			$('.filter_display_img').hide();
			checkboxurl(document.getElementById($('input[name='+item+']').attr('id')));
			});
		} else{
			$('.verlauf_filter_apply').hide();
			$('.verlauf_filter_remove').hide();
		}
		
		//calls for elastic, datepicker, timepicker
		$('.course_comment').elastic();

		$('.course_date').mask("99.99.9999");
		$('.course_date').datepicker({
			dateFormat : 'dd.mm.yy',
			showOn : "both",
			buttonImage : $('#calImg').attr('src'),
			buttonImageOnly : true,
			changeMonth : true,
			changeYear : true,
			nextText : '',
			prevText : '',
			onSelect : function(date) {
				appendto($(this).attr('id').replace("date", ""), $(this).val());
				insertsession($(this).attr('id').replace("date", ""), pid, $('.LeftList01').length);
				$(this).focus();
				return false;
			}
		});
		$('.course_todo_date').mask("99.99.9999");
		$('.course_todo_date').datepicker({
			dateFormat : 'dd.mm.yy',
			showOn : "both",
			buttonImage : $('#calImg').attr('src'),
			buttonImageOnly : true,
			changeMonth : true,
			changeYear : true,
			nextText : '',
			prevText : '',
			onSelect : function(date) {
				appendto($(this).attr('id').replace("till", ""), $(this).val());
				insertsession($(this).attr('id').replace("till", ""), pid, $('.LeftList01').length);
				$(this).focus();
				return false;
			}
		});
		$('.course_timepicker').timepicker({
			onSelect : function(time_value) {

				if($('#date'+$(this).attr('id')).val()==""){
					$('#date'+$(this).attr('id')).val("<?php echo date('d.m.Y'); ?>");
				}
				appendto($(this).attr('id').replace("hourtime",""), $(this).val());
				insertsession($(this).attr('id').replace("hourtime",""),pid,$('.LeftList01').length);
				$(this).focus();
				return false;
			},
			minutes : {
				interval : 5
			},
			showPeriodLabels : false,
			rows : 4,
			hourText : 'Stunde',
			minuteText : 'Minute'
		});

		$('.livesearchicdinp').bind('change', function() {
			var input_row = parseInt($(this).attr('id').substr(('icdnumber').length));
			reset_diagnosis(input_row);
		}).liveSearch({
			url : 'ajax/diagnosis?mode=icdnumber&q=',
			id : 'livesearch_admission_diagnosis',
			aditionalWidth : '560',
			noResultsDelay : '900',
			typeDelay : '900',
			returnRowId : function(input) {
				return parseInt($(input).attr('id').substr(('icdnumber').length));
			}
		});

		//livesearch diagnosis description ls
		$('.livesearchinp').bind('change', function() {
			var input_row = parseInt($(this).attr('id').substr(('diagnosis').length));
			reset_diagnosis(input_row);
		}).liveSearch({
			url : 'ajax/diagnosis?q=',
			id : 'livesearch_admission_diagnosis',
			aditionalWidth : '0',
			noResultsDelay : '900',
			typeDelay : '900',
			returnRowId : function(input) {
				return parseInt($(input).attr('id').substr(('diagnosis').length));
			}
		});
		
		if(moduleprivl == "1")
		{
	      	$('.serviceslivesearvh').bind('change', function() {
			var input_row = parseInt($(this).attr('id').substr(('lrownumber').length));
			//reset_diagnosis(input_row);
		    }).liveSearch({
			url : 'ajax/services?q=',
			id : 'livesearch_services',
			aditionalWidth : '560',
			noResultsDelay : '900',
			typeDelay : '900',
			returnRowId : function(input) {
				return parseInt($(input).attr('id').substr(('lrownumber').length));
			   }
		     });
	      }
	
		if(module_al == "1"){
			
			liveSearch_al();
			$('.al_course_date').each(function(){
				datapicker_al(parseInt($(this).attr('id').substr(('al_date').length)))
			});	
			
		}
		if(module_le == "1")
		{

		$('.live_search_action_id').bind('change', function() {
			var input_row = parseInt($(this).attr('id').substr(('actionid').length));
			reset_actions(input_row);
		}).liveSearch({
			url : 'ajax/xbdtactions?mode=action_id&q=',
			id : 'livesearch_admission_diagnosis',
			aditionalWidth : '560',
			noResultsDelay : '900',
			typeDelay : '900',
			returnRowId : function(input) {
				return parseInt($(input).attr('id').substr(('actionid').length));
			}
		});

		//livesearch actions name
		$('.live_search_action_name').bind('change', function() {
			var input_row = parseInt($(this).attr('id').substr(('actionname').length));
			reset_actions(input_row);
		}).liveSearch({
			url : 'ajax/xbdtactions?q=',
			id : 'livesearch_admission_diagnosis',
			aditionalWidth : '0',
			noResultsDelay : '900',
			typeDelay : '900',
			returnRowId : function(input) {
				return parseInt($(input).attr('id').substr(('actionname').length));
			}
		});
			
		}
		
		
		
		// new display for filters
		//top
		$('.filter_block').hide();
		$('#filter_block_int').val('0');

		$('#verlauf_filter_options').click(function() {
			if ($('#filter_block_int').val() == '0') {
				$('.filter_block').show();
				$('#filter_block_int').val('1');
			} else {
				$('.filter_block').hide();
				$('#filter_block_int').val('0');
			}
		});

		
		// New filter settings -TOP
		$('#filter_remove').val('0');
		$('#filter_apply').val('0');
		$('#verlauf_filter_apply').hide();
		
		$('#verlauf_filter_remove').click(function() {
			if ($('#filter_remove').val() == '0') {
				$('#filter_remove').val('1');
				$('#filter_apply').val('0');
				
				$('.verlauf_filter_remove').hide();
				$('.verlauf_filter_apply').show();
				
				$('.verlauf_li_filter').removeClass("filter_available");
				$.each(filterkeysjs,function(i, item) {
					if($('input[name='+item+']').is(':checked')) {
						$('input[name='+item+']').removeAttr('checked');
					} 
				checkboxurl(document.getElementById($('input[name='+item+']').attr('id')));
				});
			}
		});
		
		$('#verlauf_filter_apply').click(function() {
			if ($('#filter_apply').val() == '0') {
				$('#filter_apply').val('1');
				$('#filter_remove').val('0');
				
				$('.verlauf_filter_remove').show();
				$('.verlauf_filter_apply').hide();
				
				
				$('.verlauf_li_filter').addClass("filter_available");
				$.each(filterkeysjs,function(i, item) {
					if($('input[name='+item+']').is(':checked')) {
						$('input[name='+item+']').removeAttr('checked');
					} else {
						$('input[name='+item+']').attr('checked','checked');
					}
				checkboxurl(document.getElementById($('input[name='+item+']').attr('id')));
				});
			}
		});
		
		
		
		
		//bottom
		$('.filter_block_bt').hide();
		$('#filter_block_bt_int').val('0');

		$('#verlauf_filter_options_bottom').click(function() {
			if ($('#filter_block_bt_int').val() == '0') {
				$('.filter_block_bt').show();
				$('#filter_block_bt_int').val('1');
			} else {
				$('.filter_block_bt').hide();
				$('#filter_block_bt_int').val('0');
			}

		});
		

		
		
		// New filter settings -BOTTOM
		$('#filter_remove_b').val('0');
		$('#filter_apply_b').val('0');
		$('#verlauf_filter_apply_bottom').hide();
		
		$('#verlauf_filter_remove_bottom').click(function() {
			
			if ($('#filter_remove_b').val() == '0') {
				$('#filter_remove_b').val('1');
				$('#filter_apply_b').val('0');
				
				$('.verlauf_filter_remove').hide();
				$('.verlauf_filter_apply').show();
				
				$('.verlauf_li_filter').removeClass("filter_available");
				$.each(filterkeysjs,function(i, item) {
					if($('input[name='+item+']').is(':checked')) {
						$('input[name='+item+']').removeAttr('checked');
					} 
				checkboxurl(document.getElementById($('input[name='+item+']').attr('id')));
				});
			}
		});
		
		
		$('#verlauf_filter_apply_bottom').click(function() {
			if ($('#filter_apply_b').val() == '0') {
				$('#filter_apply_b').val('1');
				$('#filter_remove_b').val('0');
				
				$('.verlauf_filter_remove').show();
				$('.verlauf_filter_apply').hide();
				
				
				$('.verlauf_li_filter').addClass("filter_available");
				$.each(filterkeysjs,function(i, item) {
					if($('input[name='+item+']').is(':checked')) {
						$('input[name='+item+']').removeAttr('checked');
					} else {
						$('input[name='+item+']').attr('checked','checked');
					}
				checkboxurl(document.getElementById($('input[name='+item+']').attr('id')));
				});
			}
		});

		//ajax loader facebook
		jQuery.ias({
			container : '#ListBox',
			history : false,
			item : '.master_row',
			pagination : 'div.navigation',
			next : 'div.navigation a.next_link_button',
			loader : '<div class="row clearer parentdiv iefirst" id="maindiv_loading" style="width: 99.9%; text-align:center;"><?php echo $this->translate('fb_verlauf_loading');  ?> <img src="<?php echo RES_FILE_PATH;  ?>/images/loading.gif" style="margin 5px;" /></div>',
			onRenderComplete : function(items) {
				//here we filter verlauf data

				//1. get checked shortcuts
				var selected_shortcuts = new Array();

				$('.listcoursechecks_main_div input:checked').each(function() {
					check2();
				});
			}
		});

		$('#modal_delete').dialog({
			autoOpen : false,
			modal : true,
			resizable : false,
			width : 500,
			buttons : {
				"<?php echo $this->translate('yesconfirm'); ?>" : function() {
					switch ($('#modal_redir_type').val()) {
						case 'D':
							window.location = appbase + 'patient/patdiagnoedit?id=<?php echo $_REQUEST['id']; ?>';
							break;
						case 'LE':
							window.location = appbase + 'patientformnew/xbdtactions?id=<?php echo $_REQUEST['id']; ?>';
							break;
						case 'M':
							window.location = appbase + 'patient/patientmedication?id=<?php echo $_REQUEST['id']; ?>';
							break;

						default:
							break;
					}
					$(this).dialog("close");
				},
				"<?php echo $this->translate('noconfirm'); ?>" : function() {
					$(this).dialog("close");
				}
			},
			close : function() {
				//reset message divs on close
				$('#modal_delete p').each(function() {
					$(this).hide();
				});

				$('#modal_delete').dialog('removebutton','Medications');
				$('#modal_delete').dialog('removebutton','Diagnosis');
			}
		});

		$('#delete_btm_med').dialog({
			autoOpen : false,
			modal : true,
			resizable : false,
			width : 500,
			buttons : {
				"<?php echo $this->translate('yesconfirm'); ?>" : function() {
					revert_medication($('#btm_medi_revert').val());
					$(this).dialog("close");
				},
				"<?php echo $this->translate('noconfirm'); ?>" : function() {
					$(this).dialog("close");
				}
			}
		});

		<?php if($this->show_mmi == "1"):?>
		var healthinsuranceik = "<?php echo $this->kassen_no; ?>";
		var client = '<?php echo $this->clientid ?>';
		$('.course_med_name').live('change', function() {
			var input_row = parseInt($(this).attr('id').substr(('name').length));
		}).liveSearch({
			url: 'pharmaindex/getproductsmedils?ik_no='+healthinsuranceik+'&sm=0&client='+client+'&searchtext=',
			id: 'livesearch_admission_medications',
			aditionalWidth: '300',
			noResultsDelay: '900',
			typeDelay: '900',
			returnRowId: function (input) {return parseInt($(input).attr('id').substr(('name').length));}
		});
		<?php endif; ?>
		
		
		$('.course_med_name_treatment_care').live('change', function() {
			var input_row = parseInt($(this).attr('id').substr(('name').length));
		}).liveSearch({
//				url: 'pharmaindex/getproductsmedils?ik_no='+healthinsuranceik+'&sm=0&client='+client+'&searchtext=',
			url: 'ajax/medicationstreatmentcare?q=',
			id: 'livesearch_admission_medications',
			aditionalWidth: '300',
			noResultsDelay: '900',

				typeDelay: '900',
			returnRowId: function (input) {return parseInt($(input).attr('id').substr(('name').length));}
		});
		
		
		
		$('.todo_selectbox').chosen({
			placeholder_text_single: translate('please select'),
			placeholder_text_multiple : translate('please select'),
			multiple:1,
			width:'250px',
			style: "padding-top:10px",
			"search_contains": true,
			no_results_text: translate('noresultfound')
		});
		
		//transform the select
		chosenizeSelectShortcut($('.selectShortcut'));
			
	});

	function revert_medication(ids) {
		$.ajax({
			type : 'POST',
			url : 'ajax/revertbtmmedication',
			data : {
				course : ids
			},
			success : function(data) {
				var data_obj = jQuery.parseJSON(data);

				if (data_obj.error) {
					alert(data_obj.error);
				}
			}
		});
	}

	function load_medi(that) {
		var medi_data = that.val().split('-');
		var element_row = that.attr('rel');

		//clear inputs
		$('#medi_name' + element_row).val('');
		$('#dosage' + element_row).val('');
		$('#comments' + element_row).val('');
		$('#ListNew').block({
			message : "<h1>" + jsTranslate['loadingpleasewait'] + "</h1>",
			css : {
				border : 'none',
				padding : '15px',
				backgroundColor : '#000',
				'-webkit-border-radius' : '10px',
				'-moz-border-radius' : '10px',
				opacity : .5,
				color : '#fff'
			}
		});

		$.ajax({
			type : "POST",
			url : "patientcourse/requestmedicationdata?id=<?php echo $_REQUEST['id']; ?>&mid=" + medi_data[0] + "&mmid=" + medi_data[1],async : true,success : function(response) {
				var obj = $.parseJSON(response);

				$('#medi_name' + element_row).val('' + obj.medi_name + '');
				$('#medi_change' + element_row).val('' + obj.medi_change + '');
				$('#medi_replace' + element_row).val('' + obj.medi_replace + '');
				$('#dosage' + element_row).val('' + obj.dosage + '');
				$('#comments' + element_row).val('' + obj.comments + '');
				$('#delete' + element_row).val('' + obj.id + '');
				$('#delete' + element_row).attr('name','delete[' + obj.id + ']');
				$('#medi_id' + element_row).val('' + obj.medication_master_id + '');
				$('#drid' + element_row).val('' + obj.id + '');
				$('#medication-content-' + element_row).show('slow');
				$('#ListNew').unblock();
				selectdignosis('<?php echo $_REQUEST['id']; ?>',new Number(element_row + 1));

				$('#medi_change' + element_row).datepicker({
					dateFormat : 'dd.mm.yy',
					showOn : "both",
					buttonImage : $('#calImg').attr('src'),
					buttonImageOnly : true,
					changeMonth : true,
					changeYear : true,
					nextText : '',
					prevText : ''
				});
				$('#medi_change' + element_row).mask("99.99.9999");
			}
		});
	}
	
	function selectMedications(mid, row, mmi_handler)
	{
		$('#name'+row).val($('#medi_me_'+mid).val());
		//TODO-3365 Carmen 24.08.2020
		if(js_pharmaindex_settings.takinghint == 'yes')
		{
		//ISPC 2554 Carmen 16.06.2020
		//if(module_takinghint == '1')
  	    //{
			$('#komment'+row).val($('#medi_TAKINGHINT_'+mid).val());
  	    //}
		}
		else
		{
			$('#komment'+row).val('');
		}
		//--
		
		//TODO-3365 Carmen 24.08.2020
		if(js_pharmaindex_settings.drug == 'yes')
		{
			inputExtra =  $('#medi_wirkstoffe_'+mid).val();//ISPC-2329
		}
		else
		{
			inputExtra =  '';//ISPC-2329
		}
		//inputExtraAtc =  $('#medi_ATC_'+mid).val();//ISPC-2554 pct.3
		//inputExtraAtc =  '';//ISPC-2554 pct.3
		//TODO-3365 Carmen 24.08.2020
		if(js_pharmaindex_settings.atc == 'yes')
		{
			inputExtraAtc =  $('#medi_ATC_'+mid).val();//ISPC-2554 pct.3
		}
		else
		{
			inputExtraAtc =  '';
		}
		
		inputExtraPzn =  $('#medi_PZN_'+mid).val();//ISPC-2329 Ancuta 03.04.2020
		inputExtraDBF_id =  $('#medi_DBF_ID_'+mid).val();//ISPC-2329 Ancuta 03.04.2020
		
		//TODO-3365 Carmen 24.08.2020
		if(js_pharmaindex_settings.dosage_form == 'yes')
		{
			inputExtraDosage_form =  $('#medi_DOSAGEFORMID_'+mid).val();//ISPC-2554 Carmen 14.05.2020
		}
		else
		{
			inputExtraDosage_form =  '';//ISPC-2554 Carmen 14.05.2020
		}
		//TODO-3365 Carmen 24.08.2020
		if(js_pharmaindex_settings.unit == 'yes')
		{
			inputExtraUnit =  $('#medi_UNIT_'+mid).val();//ISPC-2554 Carmen 14.05.2020
		}
		else
		{
			inputExtraUnit =  '';//ISPC-2554 Carmen 14.05.2020
		}

		appendto(row, $('#medi_me_'+mid).val());
		
	}
</script>

<div style="display: none;">
	<img id="calImg" src="<?php echo RES_FILE_PATH;  ?>/images/calendar.png" alt="Popup" class="trigger" style="margin: 7px; float: left;">
</div>

<div class="tab_container">

	<br />
	<div id="MainContent">

		<div class="verlauf_bar verlauf_bar_top">
			<ul>
				<li class="verlauf_li_name"><?php echo $this->translate('patientcoursedocs')?></li>
				<li class="verlauf_li_scroll"><a href="javascript:scroll(99999999,9999999)" id="downscroll"><span>Zum Ende der Seite scrollen</span><img
						src="<?php echo RES_FILE_PATH;  ?>/images/gobottom.png" alt="" /></a></li>
				<li class="verlauf_li_filter_apply"><a href="javascript:void(0)" id="verlauf_filter_apply" class="verlauf_filter_apply"
					title="<?php echo $this->translate('Apply user filter')?>"><img src="<?php echo RES_FILE_PATH;  ?>/images/filter_apply.png" /><input
						type="hidden" id="filter_apply_b" value="" /></a></li>
				<li class="verlauf_li_filter_remove"><a href="javascript:void(0)" id="verlauf_filter_remove" class="verlauf_filter_remove"
					title="<?php echo $this->translate('Remove user filter')?>"><img src="<?php echo RES_FILE_PATH;  ?>/images/filter_remove.png" /><input
						type="hidden" id="filter_remove_b" value="" /></a></li>
				<li class="verlauf_li_filter"><a href="javascript:void(0)" id="verlauf_filter_options"><span><?php echo $this->translate('Add filter')?></span><img
						class="filter_display_img" src="<?php echo RES_FILE_PATH;  ?>/images/filter_add.png" /><input type="hidden" id="filter_block_int" value="" /></a></li>
				<li class="verlauf_li_print"><a href="patientcourse/printcourse?id=<?echo $this->pid ?>" target="_blank"><span><?php echo $this->translate('Verlauf print')?></span><img
						src="<?php echo RES_FILE_PATH;  ?>/images/print.gif" /></a></li>
			</ul>
		</div>
		<div class="CheckBoxes filter_block" style="display:<?php echo $this->style ?>">
			<div class="listcoursechecks_main_div">

				<?php
				$cntr = '1';
				foreach($this->course_checks_arr as $k_course_chk=> $v_course_chk):
                    
                    //what is this $chkcntr and $view ??? did not removed maybe i'm wrong..
                    if (isset($view) && is_object($view)) {
                        $chkcntr = $view->checkcounter;
                    } else {
                        $chkcntr = 0;
                    }

					
					$ischecked="";
					$isbold = "";
					$isitalic = '';
					$isunderline = '';
					$cheks = 0;

					if($v_course_chk['chk'] ==1)
					{
					  $ischecked = "checked='checked'";
					  $cheks = 1;
					}

					 if($v_course_chk['isbold']==1)
					 {
					   $isbold = "bold";
					 }

					 if($v_course_chk['isitalic']==1)
					 {
					   $isitalic = "italic";
					 }

					 if($v_course_chk['isunderline']==1)
					 {
					   $isunderline = "underline";
					 }
				?>
					<label> <input name="<?php echo $v_course_chk['cletter'];  ?>" id="cletter_<?php echo $cntr; ?>" type="checkbox" value="1" class="course_filter"
					onclick="checkboxurl(this,0); save_filter(this)" <?php echo $ischecked; ?> /> <font color="#<?php echo $v_course_chk['font_color']; ?>" style="font-style:<?php echo $isitalic; ?>; font-weight:<?php echo $isbold; ?>; text-decoration:<?php echo $isunderline; ?>;"><?php echo $v_course_chk['ctype'];  ?></font>
				</label>
				<?php $cntr++; endforeach;  ?>
				<label> <input name="wrong" id="wrong" type="checkbox" value="1" onclick="checkboxurl(this,1); save_filter(this)" <?php echo $ischecked; ?> />
					<?php echo $this->translate('wrongfilter') ?>
				</label>
			</div>

			<div class="listcoursechecks_main_div">
				<?php if($this->hasSharedShortcuts):  ?>
				<label> <input name="_shared" id="shared" type="checkbox" value="1" onclick="checkboxurl(this,0)" /> <font><?php echo $this->translate('hide_owned_entryes');  ?></font>
				</label>
				<?php endif;  ?>
			</div>
			<div class="listcoursechecks_main_div">
				<?php if($this->hasSharedShortcuts):  ?>
				<label> <input name="_owned" id="owned" type="checkbox" value="1" onclick="checkboxurl(this,0)" /> <font><?php echo $this->translate('hide_other_client_entryes');  ?></font>
				</label>
				<?php endif;  ?>
			</div>
		</div>

		<br />
		<?php if($this->verlauf_sort_type == 't'):  ?>
		<div class="clearer"></div>
		<form action="<?php echo $this->act ?>" method="post" name="frmcourse" id="frmcourse" autocomplete="off">
			<input type="hidden" id="1" name="triggerformid" value="1" />

			<div class="ListNew" style="display:<?php echo $this->coursestyle ?>" id="ListNew">
				<div class="LeftContent01 left" id="focusdate">
					<?php echo $this->curr_date ?>
				</div>
				<div class="RightContent01 left">
					<span class="err">
						<?php echo $this->error_shortcut; ?>
						<?php echo $this->error_date; ?>
					</span>

					<?php echo $this->gridcoursetaks; ?>
				</div>
				<div class="ClrBoth"></div>
				<div class="ClrBoth"></div>
				<p>
					<input type="button" name="btnsubmit" id="btnsubmit-save" value="<?php echo $this->translate('save') ?>" class="button"
						onclick="checkdischargednew('frmcourse')">
				</p>
			</div>
		</form>
	<?php endif;  ?>

<div id="ListBox" class="clearer"  style="display:<?php echo $this->style ?>" >
<?php $blockcounter = '1'; ?>
<?php

$cds_date_increm = 0; 		//ISPC-2604 Lore 21.10.2020

foreach($this->course_data as $k_course => $v_course):
$wrongfilterclass = "";
$greyclass = "";
$remoteclass = "";

$enc_course = end ( $v_course ['summary'] );
if (is_array ( $enc_course ) && $enc_course ['alien']) {
	$remoteclass = "source_entry";
}


if ($v_course['wrong'] == 1)
{
        $wrongfilterclass = "wrongfilter";
        $greyclass = "greyclass";
}

if (!empty($v_course['source_ipid']))
{
        $has_source = 'source_entry';
        $hide_wrong = '1';
}
else
{
        $has_source = '';
	$hide_wrong = '0';
}
?>
	 <!-- ISPC-2604 Lore 20.10.2020 -->	
	 <?php	if ($this->module_divider_verlauf == "1" ):  ?>
	 	 <?php	if ($v_course['c_date_dt'] != $this->course_data[$k_course-1]['c_date_dt']  ) :  ?>
	 	 <?php 
	 	 	$prev = $this->course_data[$k_course-1]['c_date_dt'];
 
			// find next date 
			$current_date = $v_course['c_date_dt'];
			foreach($this->course_data as $ck=>$cvalue){
				if($current_date != $cvalue['c_date_dt'] && $ck > $k_course ){
					$next = $cvalue['c_date_dt'];
					break;
				} else {
					$next = "";
				}
			}
  	 ?>
			 <div class="course_date_sep  parentdiv"  id="sep_<?php echo $v_course['c_date_dt']; ?>" >
				<div class="cds_date">
					<span  rel="<?php echo $v_course['c_date_dt']; ?>" ><?php echo $v_course['c_date_dt']  ?></span>
						<div class="buttons">
							<?php	if ($k_course != 0) :  ?>
							<button   name="up" class="up goToVblock"  data-go2date="<?php echo $prev; ?>" ></button>
							<?php endif;  ?>
							<?php	if (strlen($next) > 0 ) :  ?>
							<button   name="down" class="down goToVblock"  data-go2date="<?php echo $next; ?>" ></button>
							<?php endif;  ?>
							
						</div>
				</div>
				<?php $cds_date_increm++; ?>
			</div>
		<?php endif;  ?>
	<?php endif;  ?>
	
	
	
	<div
				class="row clearer parentdiv iefirst master_row <?php echo $wrongfilterclass; ?> <?php echo $greyclass; ?> <?php echo $has_source; ?> <?php echo $remoteclass;?>"
				id="maindiv_<?php echo $blockcounter; ?>" style="width: 99.9%;">
				<div class="colLeft iesecond ">
			<?php if($this->verlauf_action == 'a'):  ?>
			<div>								<!-- TODO-3283 Lore 17.07.2020 -->
				<span class="entry_date_block" style="font-weight: bold;color:#000000;" ><?php echo $v_course['date_dt']  ?>, <?php echo $v_course['date_hm']  ?></span>
				<!-- create_date -->
			</div>
			<?php elseif($this->verlauf_action == 'd'):  ?>

			<?php $done_date = strtotime($v_course['date_dt'].' '.$v_course['date_hm'].':00')  ?>
			<?php $entry_date = strtotime($v_course['c_date_dt'].' '.$v_course['c_date_hm'].':00')  ?>
			<?php if( $done_date != $entry_date ):?>
			<div>
						<span class="done_date_block" title="<?php echo $this->translate('done_date_label');?>"><?php echo $v_course['date_dt']  ?>, <?php echo $v_course['date_hm']  ?> </span>
						<!-- done_date -->
						<span class="entry_date_block"  title="<?php echo $this->translate('entry_date_label');?>"><?php echo $v_course['c_date_dt']  ?>, <?php echo $v_course['c_date_hm']  ?></span>
						<!-- create_date -->

					</div>
			<?php else:?>
				<span class="done_date_block"  title="<?php echo $this->translate('done_date_label');?>" ><?php echo $v_course['date_dt']  ?>, <?php echo $v_course['date_hm']  ?> </span>
					<!-- done_date -->
			<?php endif;  ?>

			<?php endif;  ?>
				<span  class="course_user_block"><?php echo trim($v_course['user_tname']." ".$v_course['user_lname'])  ?>, <?php echo $v_course['user_fname']  ?></span>
				<br />
				</div>
				<div class="colRight iethird">
					<div class="PatDisBlkleft">
			<?php if($this->userid == $v_course['user'] || $this->usertype == "SA" || ($this->ca_delete_permissions == '1')): ?><!--ISPC-2876,Elena,15.04.2021 -->
				<?php if($hide_wrong == '0' && !$v_course['main_tabname']):  ?> <!-- ISPC-2691 Carmen 04.11.2020 -->
				<?php $cid = $v_course['cid']; echo $this->formCheckbox('wrongmain', $v_course['wrong'], array("onclick" => "openPopup(this,$blockcounter)", "id" => "$blockcounter", "class" => "divcheckbox"), array('1')); ?>
				<?php endif;  ?>
			<?php endif;  ?>
			</div>
					<div class="PatDisBlkRight">
				<?php if(!empty($v_course['summary'])):  ?>
					<?php foreach($v_course['summary'] as $k_summary => $v_summary):  ?>
<?php
	if ($v_summary['isserialized'] != 1) :
		 $v_summary['course_title'] = stripslashes(nl2br(str_replace(">", "&gt;", str_replace("<", "&lt;", $v_summary['course_title']))));
	endif;

	if ($v_summary['isbold'] == 1):
		$v_summary['isbold'] = "bold";
	endif;
	if ($v_summary['isitalic'] == 1):
		$v_summary['isitalic'] = "italic";
	endif;

	if ($v_summary['isunderline'] == 1):
		$v_summary['isunderline'] = "underline";
	endif;

	if (empty($v_summary['source_ipid'])):
		$letterclass = $v_summary['course_type'] . " _owned ";
		$shared = false;
	else:
		$letterclass = "_shared";
		$shared = true;
	endif;


	if ($v_summary['course_type'] == "W")
	{
		// New collor for DONE todos
		$done_todo_color = '009900';//TODO-3086 Ancuta 08.04.2020  

		$clientusers_old = $this->users_todo;
		//$clientusers_new = $this->usersnewtodos;
		$clientusers_new = $this->usersnewtodos_flat;

	 	$course = explode("|---------|", $v_summary['course_title']);

	 	if (count($course) <= 1)
	    {
			$course = explode("|", $v_summary['course_title']);
	 	}

		$courseusr = trim($course[1]);
		if ($courseusr != '0')
	 	{
			if(is_numeric($courseusr))
			{
		    	$course_user = $clientusers_old[trim($course[1])];
			}
			else
			{
				$courseusrs = explode(",", $courseusr);
			
				if(count($courseusrs) > 1)
				{
					$courseusrsname = array();
					foreach($courseusrs as $idcourseseusr)
					{
						$courseusrsname[] = $clientusers_new[$idcourseseusr];
					}
					$course_user = implode('; ', $courseusrsname);
				}
				else
				{	
					$course_user = $clientusers_new[trim($course[1])];
				}
	         }
		}
		else
		{		
			$course_user = '-';
		}

		if(in_array($v_summary['id'], $this->patcompltodocourseids))
		{
				$coursetext = explode(',',$course[4]);
				$supltext = "";
				$username = $this->allusers_details[$this->patcompltodosdata[$v_summary['id']]['complete_user']]['last_name'] . " " . $this->allusers_details[$this->patcompltodosdata[$v_summary['id']]['complete_user']]['first_name']; 
				if(count($coursetext) > 1)
				{					
					for($nrelem=4; $nrelem<count($course); $nrelem++)
					{
						$coursetext = explode(',',$course[$nrelem]);
						$supltext .= "<br />&nbsp; ".$coursetext[1];
					}
				}
				else
				{
					$supltext .= "<br />&nbsp; Erledigt von " . $username . " am " . date('d.m.Y', strtotime($this->patcompltodosdata[$v_summary['id']]['complete_date']));					
				}	
					$v_summary['font_color'] = $done_todo_color;//TODO-3086 Ancuta 08.04.2020  	
					$v_summary['course_title'] = "<font style='color: #".$done_todo_color."; font-style: italic;'>&nbsp; geplante Maßnahme: " . html_entity_decode($course[0]) . " | " . $course_user . " | " . $course[2].$supltext."</font>";//TODO-3086 Ancuta 08.04.2020  	
					if($this->patcompltodosdata[$v_summary['id']]['complete_comment'])
					{
						$v_summary['course_title'] .= "<br />&nbsp; <font style='color: #000;'>Kommentar bei Erledigung : </font>" . "<font style='color: #000; font-weight: normal;'>". $this->patcompltodosdata[$v_summary['id']]['complete_comment'] ."</font>";
					}					
		}
		else
		{
			if(count($course)>4)
			{
				$supltext1 = "";
				$supltext2 = "";
				for($nrelem=4; $nrelem<count($course); $nrelem++)
				{
					$coursetext = explode(',',$course[$nrelem]);
					$supltextarr = explode('<br />', $coursetext[1]);
					$supltext1 .= "<br />&nbsp; <i>" . $supltextarr[0] . "</i><br />";
					if(count($supltextarr) > 1)
					{
						$supltext2 .= "<font style='color: #000;'>Kommentar bei Erledigung : </font>" . "<font style='color: #000; font-weight: normal;'>". $todo_comment.$supltextarr[1]."</font>";
					}
					else
					{
						$supltext2 .= "";
					}
					//$supltext .= "<br />&nbsp; <i>".$coursetext[1]."</i>";
				}

					$v_summary['font_color'] = $done_todo_color;//TODO-3086 Ancuta 08.04.2020  	
					$v_summary['course_title'] = "<font style='color: #".$done_todo_color."; font-style: italic;'>&nbsp; geplante Maßnahme: " . html_entity_decode($course[0]) . " | " . $course_user . " | " . $course[2].$supltext1."</font>".$supltext2;//TODO-3086 Ancuta 08.04.2020  	
			}
			else
			{
				$v_summary['course_title'] = "&nbsp; geplante Maßnahme: " . html_entity_decode($course[0]) . " | " . $course_user . " | " . $course[2];
			}
		}
	}
	elseif ($v_summary['course_type'] == "D" || $v_summary['course_type'] == "H" || $v_summary['course_type'] == "HS")
	{
	       $course = explode("|", $v_summary['course_title']);


	       if (count($course) == 3)
	       {
		       $icd = $course[1];
		       $diagnosis_name = $course[2];

		       $v_summary['course_title'] = $icd . ' | ' . $diagnosis_name;
	       }
	}
	elseif ($v_summary['course_type'] == "LE" && $this->module_le == "1")
	{
	       $course = explode("|____|", $v_summary['course_title']);

	       if (count($course) == 5)
	       {
		       $action_id = $course[1];
		       $action_name = $course[2];
		       $action_user = $this->users_le[trim($course[3])];
		       $action_datetime = $course[4];

		       $v_summary['course_title'] = $action_id . ' | ' . $action_name. ' | ' . $action_user. ' | ' . $action_datetime;
	       }
	}
	elseif ($v_summary['course_type'] == "SB")
	{
	       $client_sb_users = $this->sb_users;

	       $course = explode("|__|", $v_summary['course_title']);

	       $course_sb_usr = trim($course[0]);

	       if ($course_sb_usr > 0 && is_numeric($course_sb_usr))
	       {
		       $course_user = $client_sb_users[trim($course[0])];
		       $v_summary['course_title'] = "Sanitätshausbestellung an: " . $course_user . " <br/> " . $course[1];
	       }
	}
	elseif ($v_summary['course_type'] == "M" || $v_summary['course_type'] == "I" || $v_summary['course_type'] == "N" || $v_summary['course_type'] == "Q" || $v_summary['course_type'] == "P")
	{
		if(strpos($v_summary['course_title'], 'Änderung:') !== false || strpos($v_summary['course_title'], 'Ein Medikationseintrag wurde editiert:') !== false)
		{
			$separator = htmlentities('->');
			$tmp_arr = explode($separator, $v_summary['course_title']);
			
			if(count($tmp_arr) == '2')
			{
				// first remove <b></b> which where saved in db
				$tmp_arr[1] = strip_tags(html_entity_decode($tmp_arr[1]));
				
				
				$tmp_arr[1] = '<b>'.$tmp_arr[1].'</b>';
				$v_summary['course_title'] = implode($separator, $tmp_arr);
			}
		}
		else
		{
			//ISPC - 2366
			$separator = htmlentities('|');
			$tmp_arr = explode($separator, $v_summary['course_title']);
			if($v_summary['course_type'] == "M" || $v_summary['course_type'] == "N" || $v_summary['course_type'] == "I")
			{

				unset($tmp_arr[3]);//ISPC-2329
				unset($tmp_arr[4]);//ISPC-2554 pct.3				
				unset($tmp_arr[5]);//ISPC-2329 Ancuta 03.04.2020				
				unset($tmp_arr[6]);//ISPC-2329 Ancuta 03.04.2020
				unset($tmp_arr[7]);//ISPC-2554 Carmen 14.05.2020				
				unset($tmp_arr[8]);//ISPC-2554 Carmen 14.05.2020				
			}
			
			if(trim($tmp_arr[1]) == '')
			{
				unset($tmp_arr[1]);
			}
			else
			{
				//$tmp_arr[1] = 'Dosierung: '.$tmp_arr[1];
				$tmp_arr[1] = $tmp_arr[1];
			}

			if(trim($tmp_arr[2]) == '')
			{
				unset($tmp_arr[2]);
			}
			else
			{
				//$tmp_arr[2] = 'Kommentar: '.$tmp_arr[2];
				$tmp_arr[2] = $tmp_arr[2];
			}
			
			$v_summary['course_title'] = implode($separator, $tmp_arr);

		}
	}
	elseif ($v_summary['course_type'] == "BP" )
	{
		if(strpos($v_summary['course_title'], 'Änderung:') !== false || strpos($v_summary['course_title'], 'Ein Medikationseintrag wurde editiert:') !== false)
		{
			$separator = htmlentities('->');
			$tmp_arr = explode($separator, $v_summary['course_title']);
			
			if(count($tmp_arr) == '2')
			{
				// first remove <b></b> which where saved in db
				$tmp_arr[1] = strip_tags(html_entity_decode($tmp_arr[1]));
				
				
				$tmp_arr[1] = '<b>'.$tmp_arr[1].'</b>';
				$v_summary['course_title'] = implode($separator, $tmp_arr);
			}
		}
		else
		{
			//ISPC - 2366
			$separator = htmlentities('|');
			$tmp_arr = explode($separator, $v_summary['course_title']);

			if(trim($tmp_arr[1]) != '')
			{
				//$tmp_arr[1] = 'Kommentar: '.$tmp_arr[1];
				$tmp_arr[1] = $tmp_arr[1];
			}

			$v_summary['course_title'] = implode($separator, $tmp_arr);
		}
	}

	if ($v_summary['tabname'] == "discharge")
	{
		$v_summary['course_title'] = '<span style="background:#FC7272;">' . $v_summary['course_title'] . '</span>';
	}

	if ($v_summary['tabname'] == "deleted_discharge")
	{
		$v_summary['course_title'] = '<span style="background:#FC7272;"><strike>' . $v_summary['course_title'] . '</strike></span>';
	}


	if ($v_summary['tabname'] == "receiptupload_deleted")
	{
		$v_summary['course_title'] = '<span style="color:#FF0000;">' . $v_summary['course_title'] . '</span>';
	}

	$wrongcheck = "";
	if ($v_summary['wrong'] != 1)
	{	$course_type = $v_summary['course_type'];
		$v_summary['course_type'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_type'] . '</font>';

		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		$wrongfilterclass = "";
	}

	$wrongcheck = "";
	if ($v_summary['wrong'] == 1)
	{
		$wrongcheck = 'checked=checked';
	}


	$pid = $this->pid;

	if ($v_summary['tabname'] == "fileupload")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">Datei ' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . ' wurde angeh&auml;ngt</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">Datei ' . $v_summary['course_title'] . ' wurde angeh&auml;ngt</font>';
		}
	}
	if ($v_summary['tabname'] == "receiptupload")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . ' </font>';			
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] .' </font>';
		}
	}


	if ($v_summary['tabname'] == "discharge_planning")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/dischargeplanning?id=' . $pid . '">Entlassungsplanung hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "kvno_doctor_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/kvnodoctorform?kvno_doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsbogen Arzt hinzugefügt.</a>' . '</font>';
		
	}

	if ($v_summary['tabname'] == "lvn_doctor_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/leverkusendoctorform?kvno_doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsbogen Arzt hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "bayern_doctorvisit")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/bayerndoctorvisit?bayern_doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsformular Bayern hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "sakvno_doctor_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/sakvnodoctorform?kvno_doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsbogen Arzt hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "wl_doctor_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/wldoctorform?kvno_doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsbogen Arzt hinzugefügt.</a>' . '</font>';
	}


    if ($this->clientModules[173]) 
    {
        if ($v_summary['tabname'] == "contact_form")
	    {
            $__course_title_bottom_cf = isset($v_summary['__course_title_bottom_cf']) ?  '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['__course_title_bottom_cf'] . '</font>' : "";
            //$__course_title_form_type_name = isset($v_summary['__form_type_name']) ?  '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['__form_type_name'] . '</font><br/>' : "";

		    $v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' 
                . '<a href="patientform/contactform?cid=' . $v_summary['recordid'] . '&id=' . $pid . '">' 
                //. $__course_title_form_type_name
                . $v_summary['course_title']
                . $__course_title_bottom_cf 
                . ' . </a>' 
                . '</font>';

            if (isset($v_summary['__pdf']) && ! empty($v_summary['__pdf'])) {
                $__pdf = reset($v_summary['__pdf']);
                if ( ! empty($__pdf['recordid']) && ! in_array($__pdf['recordid'], $this->delids_array)) {
                    $v_summary['course_title'] .= '<a class="verlauf_contactform_download_pdf" href="stats/patientfileupload?doc_id=' . $__pdf['recordid'] . '&id=' . $pid . '" title="'.$__pdf['course_title'].'"></a>';
                }
            }
			//TODO-3843 Ancuta 12.02.2021
			$v_summary['course_title'] .='<br/>'.$v_summary['__course_title_recorddata'];
			// -- 

 
        } 
        elseif ($v_summary['tabname'] == "contact_form_no_link") 
        {
            $__course_title_bottom_cf = isset($v_summary['__course_title_bottom_cf']) ? $v_summary['__course_title_bottom_cf'] : "";
            $v_summary['course_title'] .= $__course_title_bottom_cf;

            if (isset($v_summary['__pdf']) && ! empty($v_summary['__pdf']) ) {
                $__pdf = reset($v_summary['__pdf']);
                if ( ! empty($__pdf['recordid']) && ! in_array($__pdf['recordid'], $this->delids_array)) {
                    $v_summary['course_title'] .= '<a class="verlauf_contactform_download_pdf" href="stats/patientfileupload?doc_id=' . $__pdf['recordid'] . '&id=' . $pid . '" title="'.$__pdf['course_title'].'"></a>';
                }
            }
        } elseif ($v_summary['tabname'] == "contact_form_nosave_pdf_print") {

            $__course_title_bottom_cf = isset($v_summary['__course_title_bottom_cf']) ?  '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['__course_title_bottom_cf'] . '</font>' : "";

            $v_summary['course_title'] .= $__course_title_bottom_cf;

            if ( ! empty($v_summary['recordid']) && ! in_array($v_summary['recordid'], $this->delids_array)) {
                $v_summary['course_title'] .= '<a class="verlauf_contactform_download_pdf" href="stats/patientfileupload?doc_id=' 
                    . $v_summary['recordid'] 
                    . '&id=' . $pid 
                    . '"></a>';
            }
        }
        
    } else {
        //this was before ispc-2071
        if ($v_summary['tabname'] == "contact_form")
        {
            $v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/contactform?cid=' . $v_summary['recordid'] . '&id=' . $pid . '">'.$v_summary['course_title'].'.</a>' . '</font>';
        }
        
    }

    if ($v_summary['tabname'] == "contact_form_save")
    {
        if(!in_array($v_summary['recordid'],$this->delids_array))
        {
            $v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
        }
        else
        {
            $v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
        }
    }

    if ($v_summary['tabname'] == "contact_form_moved_to_date")
    {
        if ($v_summary['isserialized'] == 0 ) {
           $v_summary['course_title'] .= $v_summary['recorddata']; 
        } else {
            //if you want a better scroll, change the save to a isserialized, and save ids and extra stuff, and on view unserialize and scrollTo using js
        }
    }


	if (($v_summary['tabname'] == "kvno_assesment" && stripos($v_summary['course_title'], 'angelegt') !== false) || $v_summary['tabname'] == 'new_kvno_assesment')
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/kvnoassessment?id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}


	if ($v_summary['tabname'] == "kvno_assesment_new")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}

	if ($v_summary['tabname'] == "entrance_assesment_new")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == "entrance_assessment_from")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/entranceassessment?id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	
	if ($v_summary['tabname'] == "kinder_entrance_assesment_new")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == "kinder_entrance_assessment_from")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/kinderentranceassessment?id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}
	






	if ($v_summary['tabname'] == "rp_assessment")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
 	}



	if ($v_summary['tabname'] == "recording_assesment")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "reassesment")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}


	if ($v_summary['tabname'] == "kvno_nurse_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/kvnonurseform?kvno_nurse_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsbogen Pflege hinzugefügt.</a>' . '</font>';
	}


	if ($v_summary['tabname'] == "lvn_nurse_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/leverkusennurseform?kvno_nurse_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsbogen Pflege hinzugefügt.</a>' . '</font>';
	}


	if ($v_summary['tabname'] == "visit_koordination_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/visitkoordinationform?koordination_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsformular Koordination hinzugefügt.</a>' . '</font>';
	}


	if ($v_summary['tabname'] == "wl_nurse_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/wlnurseform?kvno_nurse_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsbogen Pflege hinzugefügt.</a>' . '</font>';
	}


	if ($v_summary['tabname'] == "sakvno_nurse_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/sakvnonurseform?kvno_nurse_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsbogen Pflege hinzugefügt.</a>' . '</font>';
	}





	if ($v_summary['tabname'] == "kvnoanlage7form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/kvnoanlage7form?kvno_anlage_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Besuchsbogen KVNO Anlage 7  hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "dgpanlage7form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/dgpanlage7form?kvno_anlage_id=' . $v_summary['recordid'] . '&id=' . $pid . '">DGP-Kerndatensatz - Besuchsbogen Anlage 7  hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "dgpkernform")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/dgpkernform?dgp_kern_id=' . $v_summary['recordid'] . '&id=' . $pid . '">DGP-Kerndatensatz  - Kerndatensatz für Palliativpatienten  hinzugefügt.</a>' . '</font>';
	}

	/* ISPC-1775,ISPC-1678 */
	if ($v_summary['tabname'] == "new_hospiz_register_created")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientnew/hospizregister?id=' . $pid . '">DGP-Kerndatensatz  - Kerndatensatz für Palliativpatienten  hinzugefügt.</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "new_hospiz_register_edited")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientnew/hospizregister?id=' . $pid . '">DGP-Kerndatensatz  - Kerndatensatz für Palliativpatienten  wurde editiert.</a>' . '</font>';
	}
	/* ISPC-1994 */
	if ($v_summary['tabname'] == "new_hospiz_register_v3_created")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientnew/hospizregisterv3?id=' . $pid . '">DGP-Kerndatensatz  - Kerndatensatz für Palliativpatienten  hinzugefügt.</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "new_hospiz_register_v3_edited")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientnew/hospizregisterv3?id=' . $pid . '">DGP-Kerndatensatz  - Kerndatensatz für Palliativpatienten  wurde editiert.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "dgpsapvform")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/dgpsapvform?dgp_sapv_id=' . $v_summary['recordid'] . '&id=' . $pid . '">DGP-Kerndatensatz  - SAPV-Struktur-Modul  hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "ruhen")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/saruhenform?ruhen_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Ruhen der Teilnahme hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "feststellung")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/safeststellung?feststellung_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Feststellung des Nichtvorliegens der Teilnahmevorraussetzung  hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "genehmigungs")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/sagenehmig?genehmig_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Genehmigungsformular hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "anlage4awl")
	{
		if(!$v_summary['recordid'])
		{	
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patient/anlage4awl?id=' . $pid . '">Anlage 4a wurde erstellt</a>' . '</font>
				<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="anlage" />';
		}
		else
		{
			if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Anlage 4a wurde erstellt</a>' . '</font>
				<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="anlage" />';
			}else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Anlage 4a wurde erstellt' . '</font>
				<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="anlage" />';
			}
		}
	}

	if ($v_summary['tabname'] == "anlage4wl")
	{
		if(!$v_summary['recordid'])
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patient/anlage4wl?id=' . $pid . '">Anlage 4 wurde erstellt</a>' . '</font>
			<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="anlage"/>';
		}
		else
		{
			if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Anlage 4 wurde erstellt</a>' . '</font>
				<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="anlage"/>';
			}else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Anlage 4 wurde erstellt' . '</font>
				<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="anlage"/>';
			}
		}
	}

	if ($v_summary['tabname'] == "kvnoanlage3a")
	{
		if(!$v_summary['recordid'])
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patient/kvnoanlage3a?id=' . $pid . '">Anlage 3a wurde erstellt</a>' . '</font>
			<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="kvnoanlage3a"/>';
		}
		else
		{
			if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Anlage 3a wurde erstellt</a>' . '</font>
				<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="kvnoanlage3a"/>';
			}
			else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Anlage 3a wurde erstellt' . '</font>
				<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="kvnoanlage3a"/>';
			}
		}
	}

	if ($v_summary['tabname'] == "kvnoanlage3b")
	{
		if(!$v_summary['recordid'])
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patient/kvnoanlage3b?id=' . $pid . '">Anlage 3b wurde erstellt</a>' . '</font>
			<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="kvnoanlage3b"/>';
		}
		else
		{
			if(!in_array($v_summary['recordid'],$this->delids_array))
			{

				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Anlage 3b wurde erstellt</a>' . '</font>
				<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="kvnoanlage3b"/>';
			}
			else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Anlage 3b wurde erstellt' . '</font>
				<input type="hidden" name="type" id="type_[[id]]" class="anlage" value="kvnoanlage3b"/>';
			}
		}
	}

	if ($v_summary['tabname'] == "drletter")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein <a href="patient/doctorletter?id=' . $pid . '&lid=' . $v_summary['recordid'] . '&pdf=1">Brief</a> wurde erstellt' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein Brief wurde erstellt' . '</font>';
		}
	}

	if ($v_summary['tabname'] == "drletterfaxvor")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein <a href="patient/doctorletter?id=' . $pid . '&lid=' . $v_summary['recordid'] . '&type=4&pdf=1">Brief</a> wurde erstellt' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein Brief wurde erstellt' . '</font>';
		}
	}

	if ($v_summary['tabname'] == "drlettertodes")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein <a href="patient/doctorletter?id=' . $pid . '&lid=' . $v_summary['recordid'] . '&type=7&pdf=1">Brief</a> wurde erstellt' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein Brief wurde erstellt' . '</font>';
		}
	}

	if ($v_summary['tabname'] == "drletter_erstverordnung_zapv")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein <a href="patient/doctorletter?id=' . $pid . '&lid=' . $v_summary['recordid'] . '&type=23&pdf=1">Brief</a> wurde erstellt' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein Brief wurde erstellt' . '</font>';
		}
	}	
	
	if ($v_summary['tabname'] == "drletter_folgeverordnung_zapv")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein <a href="patient/doctorletter?id=' . $pid . '&lid=' . $v_summary['recordid'] . '&type=24&pdf=1">Brief</a> wurde erstellt' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein Brief wurde erstellt' . '</font>';
		}
	}

	if ($v_summary['tabname'] == "wl_doctor_letter")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein <a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Brief</a> wurde erstellt' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Ein Brief wurde erstellt' . '</font>';
		}
	}
	if ($v_summary['tabname'] == "MdkSchne")
	{
		if(!$v_summary['recordid'])
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/mdkschneform?id=' . $pid . '">MDK Schnellbegutachtungsbogen</a> wurde erstellt' . '</font>';
		}
		else
		{
			if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">MDK Schnellbegutachtungsbogen</a> wurde erstellt' . '</font>';
			}
			else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'MDK Schnellbegutachtungsbogen wurde erstellt' . '</font>';
			}
		}
	}
	if ($v_summary['tabname'] == "MdkSchne_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/mdkschneform?id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "FinalDocumentation_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patient/formfive?id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}


	if ($v_summary['tabname'] == "Stammblattsapv")
	{
		if(!$v_summary['recordid'] )
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/stammblattsapv?id=' . $pid . '">Stammblatt</a> wurde erstellt' . '</font>';
		}
		else
		{
		 if(!in_array($v_summary['recordid'],$this->delids_array))
		 {
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Stammblatt</a> wurde erstellt' . '</font>';
		 }
		 else
		 {
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Stammblatt wurde erstellt' . '</font>';
		 }
		}
	}

	if ($v_summary['tabname'] == "Stammblatt5")
	{
		if(!$v_summary['recordid'])
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/stammblatt5?id=' . $pid . '">Stammblatt V</a> wurde erstellt' . '</font>';
		}
		else
		{
		 if(!in_array($v_summary['recordid'],$this->delids_array))
			 {
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Stammblatt V</a> wurde erstellt' . '</font>';
			 }
		 else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Stammblatt V wurde erstellt' . '</font>';
			}
		}
	}

	if ($v_summary['tabname'] == "Stammblatt4")
	{
		if(!$v_summary['recordid'])
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/stammblatt4?id=' . $pid . '">Stammblatt IV</a> wurde erstellt' . '</font>';
		}
		else
		{
		 if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Stammblatt IV</a> wurde erstellt' . '</font>';
			}
		else
			{	
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Stammblatt IV wurde erstellt' . '</font>';
			}
		}
	}

	if ($v_summary['tabname'] == "Stammblatt7")
	{
		if(!$v_summary['recordid'])
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/stammblatt7?id=' . $pid . '">Stammblatt VII</a> wurde erstellt' . '</font>';
		}
		else
		{
		 if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Stammblatt VII</a> wurde erstellt' . '</font>';
			}
		else
			{	
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Stammblatt VII wurde erstellt' . '</font>';
			}
		}
	}

	if ($v_summary['tabname'] == "PatientStammblattsapv")
	{
		if(!$v_summary['recordid'])
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/patientstammblattsapv?id=' . $pid . '">Patientenstammblatt </a> wurde erstellt' . '</font>';
		}
		else
		{
		if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">Patientenstammblatt </a> wurde erstellt' . '</font>';
			}
		else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Patientenstammblatt wurde erstellt' . '</font>';
			}
		}
	}

	if ($v_summary['tabname'] == "patient_death")
	{
		$course_title = '<span  style="background: none repeat scroll 0 0 #FC7272;" > ' . $course_title . ' </span>';
	}

	if ($v_summary['tabname'] == "formone")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . 'Formular <a href="patient/formone?id=' . $pid . '">SAPV-Einzelfallevaluation</a> wurde erstellt.' . '</font>';
	}

	if ($v_summary['tabname'] == "bre_recording_report")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/recordingreport?id=' . $pid . '&fid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "nie_recording_report")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/nierecordingform?id=' . $pid . '&fid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "sapv_questionnaire")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/sapvquestionnaire?id=' . $pid . '&qid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "shsapv_questionnaire")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/shsapvquestionnaire?id=' . $pid . '&qid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "hospiz_questionnaire")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/hospizquestionnaire?id=' . $pid . '&qid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}
	//ISPC-2647 Lore 05.08.2020
	if ($v_summary['tabname'] == "hospiz_questionnaire_nord")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/hospizquestionnairenord?id=' . $pid . '&qid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}
	//.


	if ($v_summary['tabname'] == "SisAmbulant_save")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
		
	if ($v_summary['tabname'] == "mdk_schne_instance")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}

	if ($v_summary['tabname'] == "FinalDocumentation_instance")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' .  $v_summary['course_title'] . '</font>';
		}
	}	

	if ($v_summary['tabname'] == "barthelscorepdf")
	{	
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == "barthelscore_form_save")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/barthelscore?&id=' . $pid . '&fid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "zapv_assessment_admission")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/zapvassessment?form_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "zapv_assessment_ii_admission")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/zapvassessment?form_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "save_zapv_assessment_ii_admission")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "zapv_assessment_consulting")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/zapvberatungassessment?form_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "zapv_assessment_ii_consulting")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/zapvberatungassessment?form_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "save_zapv_assessment_ii_consulting")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}





	if ($v_summary['tabname'] == "zapv_assessment_end")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/zapvendeassessment?form_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}


	if ($v_summary['tabname'] == "wl_anlage7")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patient/palliativversorgunga7?id=' . $pid . '">Formular Anlage 7 hinzugefügt.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "questionnaireb")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/questionnaireb?id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}
	
	if ($v_summary['tabname'] == "questionnairec")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/questionnairec?id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "wound_documentation")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/wounddocumentation?id=' . $pid . '&fid=' . $v_summary['recordid'] . '  ">'.$v_summary['course_title'].'.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "Anlage5Nie_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/anlage5?id=' . $pid . '">'.$v_summary['course_title'].'.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "muster13upload")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title']  . '</font>';
		}

	}
	/*if ($v_summary['tabname'] == "muster13")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title']  . '</font>';
		}
	}

	if ($v_summary['tabname'] == "muster13_pre")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
*/
	if ($v_summary['tabname'] == "muster13_save")
	{
		//ISPC-2530  Elena 15-20.01.2021 (2)
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/muster132020?prid=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}




	if ($v_summary['tabname'] == "muster4")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == "muster4_pre")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == "painquestionnaire_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/painquestionnaire?id=' . $pid . '&formid=' . $v_summary['recordid'] . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "painquestionnaire_save")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
    
    if ($v_summary['tabname'] == "painquestionnaire_save")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
   if ($v_summary['tabname'] == "fallprotocolform_save")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == "daystructure_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/daystructure?id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "daystructure_save")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] .  '</font>';
		}
	}

	if ($v_summary['tabname'] == "careservices_save")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] .  '</font>';
		}
	}

	if ($v_summary['tabname'] == "muster_63_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patient/verordnungtp?id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "muster_63_instance")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] .  '</font>';
		}
	}
	if ($v_summary['tabname'] == "careregulation_save")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] .  '</font>';
		}
	}
	if ($v_summary['tabname'] == "anlage2_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/anlage2?fid=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "anlage2_save")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "anlage2_pdf")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == "vdek_anlage_2_pdf")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}

	if ($v_summary['tabname'] == "anlage3nordrhein_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/anlage3nordrhein?fid=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "anlage3nordrhein_pdf")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title']  . '</font>';
		}
	}
	
	if ($v_summary['tabname'] == "anlage3nordrhein_save")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}
	


	if ($v_summary['tabname'] == "lmu_pmba_psysoz")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . html_entity_decode($v_summary['course_title']). '</font>';
	}
	if ($v_summary['tabname'] == "nutritionformular")
	{ 
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}


	if ($v_summary['tabname'] == "muster_63kinder_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/verordnungtpkinder?id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "muster_63kinder_instance")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] .  '</font>';
		}
	}


	if ($v_summary['tabname'] == "emergency_plan_sapv24")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/emergencyplansapv24?id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "emergencyplansapv24")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}

	/*ISPC-2736 Lore 12.11.2020*/
	if ($v_summary['tabname'] == "emergency_plan_sapv_ii")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/emergencyplansapvii?id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
	}
	if ($v_summary['tabname'] == "emergencyplansapvii")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}



	if ($v_summary['tabname'] == "ambulant_sis_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/sisambulant?form_id=' . $v_summary['recordid'] . '&id=' . $pid . '">'.$v_summary['course_title'].'.</a>' . '</font>';
	}

    if ($v_summary['tabname'] == WlAssessment::PATIENT_COURSE_TABNAME)
    {
        $v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/wlassessment?wlassessment_id=' . $v_summary['recordid'] . '&id=' . $pid . '">'.$v_summary['course_title'].'.</a>' . '</font>';
    }
    if ($v_summary['tabname'] == MamboAssessment::PATIENT_COURSE_TABNAME)
    {
        $v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="mambo/assessment?assessment_id=' . $v_summary['recordid'] . '&id=' . $pid . '">'.$v_summary['course_title'].'.</a>' . '</font>';
    }

	if ($v_summary['tabname'] == SisStationary::PATIENT_COURSE_TABNAME_SAVE)
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/sisstationary?form_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}

	if ($v_summary['tabname'] == SisStationary::PATIENT_FILE_TABNAME)
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}

	if ($v_summary['tabname'] == "complaintform_pdf")
	{	
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}

	if ($v_summary['tabname'] == "complaintform_save_action")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/complaintform?id=' . $pid . '&formular_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == "besd_survey_save")
	{	
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == "besd_survey")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/besdsurvey?id=' . $pid . '&bsid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

	if ($v_summary['tabname'] == PatientNutritionalStatus::PATIENT_COURSE_TABNAME_SAVE)
	{	
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == PatientNutritionalStatus::PATIENT_COURSE_TABNAME)
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/must?id=' . $pid . '&msid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}

		if ($v_summary['tabname'] == PatientTreatmentPlan::PATIENT_COURSE_TABNAME_SAVE)
	{	
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	if ($v_summary['tabname'] == PatientTreatmentPlan::PATIENT_COURSE_TABNAME)
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/treatmentplan?id=' . $pid . '&fsid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}
	//ISPC-2564 Carmen 25.06.2020
	if ($v_summary['tabname'] == PatientRass::PATIENT_COURSE_TABNAME)
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/patientrass?id=' . $pid . '&msid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
	}
	//--
	
	//Maria:: Migration CISPC to ISPC 22.07.2020 :: Start
    if ($v_summary['tabname'] == 'lmu_teammeeting')
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientform/weeklymeeting?id=' . $pid . '&fid=' . $v_summary['recordid'] . '">Wöchentliche multiprofessionelle Teambesprechung - ' . $v_summary['course_title'] . '</a>' . '</font><br>'.$v_summary['recorddata'];
	}
	
	if ($v_summary['tabname'] == FormBlockKeyValue::PATIENT_COURSE_TAB_TALKCONTENT)
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font><br>'.$v_summary['recorddata'];
	}
	if ($v_summary['tabname'] == FormBlockKeyValue::PATIENT_COURSE_TAB_PALLIATIV_ASSESSMENT)
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font><br>'.$v_summary['recorddata'];
	}
	if ($v_summary['tabname'] == FormBlockKeyValue::PATIENT_COURSE_TAB_CLINIC_SOAP)
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font><br>'.$v_summary['recorddata'];
	}
	if ($v_summary['tabname'] == FormBlockKeyValue::PATIENT_COURSE_TAB_CLINIC_SHIFT)
	{
		$v_summary['course_title'] = $v_summary['recorddata'];
	}
	if ($v_summary['tabname'] == FormBlockKeyValue::PATIENT_COURSE_TAB_CLINIC_MEASURE)
	{
		$v_summary['course_title'] = $v_summary['recorddata'];
	}
	//Maria:: Migration CISPC to ISPC 22.07.2020 :: END	
	
	
    //ispc-2291
    switch ($v_summary['tabname']) {

        case FormBlockPuncture::PATIENT_COURSE_TABNAME:
        case FormBlockInfusion::PATIENT_COURSE_TABNAME:
        case FormBlockInfusiontimes::PATIENT_COURSE_TABNAME:
        case FormBlockAdverseevents::PATIENT_COURSE_TABNAME:
            $v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' .  $v_summary['course_title'] .  '</font>';
            break;

		case 'patient_rubin_iadl_saved':
		case 'patient_rubin_mmst_saved':
		case 'patient_rubin_tug_saved':
		case 'patient_rubin_demtect_saved':
//ISPC-2492 Lore 02.12.2019
		case 'patient_rubin_carerelated_saved':
//ISPC-2493 Lore 03.12.2019
		case 'patient_rubin_carepatient_saved':

//ISPC-2494
		case 'standarddocumentation_save':

		case 'patient_rubin_whoqol_saved':

		case 'patient_demstepcare_npi_saved':
		case 'patient_demstepcare_bdi_saved':
		case 'patient_demstepcare_gds_saved':

			if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
			}
			else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
			}
            break;

		case 'patient_demstepcare_cmai_saved':
		case 'patient_demstepcare_badl_saved':
		case 'patient_demstepcare_cmscale_saved':
		case 'patient_demstepcare_nosger_saved':
		case 'patient_demstepcare_dscdsv_saved':
		case 'patient_demstepcare_dsv_saved':

			if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
			}
			else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
			}
            break;

		case 'patient_rubin_mna_saved':
			if(!in_array($v_summary['recordid'],$this->delids_array))
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
			}
			else
			{
				$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
			}
            break;


		/*
		 * No edit is needed for existing forms	(Ancuta 12.07.2019 )
		case 'patient_rubin_mmst':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/mmst?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;

		case 'patient_rubin_iadl':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/iadl?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;
		case 'patient_rubin_whoqol':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/whoqol?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;

		case 'patient_rubin_tug':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/tug?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;

		case 'patient_rubin_demtect':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/demtect?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;

		case 'patient_rubin_carerelated':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/carerelated?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;
		case 'patient_rubin_carepatient':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/carepatient?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;


		case 'patient_rubin_mna':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/rubin?id=' . $pid . '&msid='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>' . '</font>';
            break;

		case 'patient_demstepcare_bdi':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/bdi?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;
		case 'patient_demstepcare_gds':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/gds?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;
		case 'patient_demstepcare_npi':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/npi?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;
		*/


		case 'patient_demstepcare_cmai':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/cmai?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;

		case 'patient_demstepcare_nosger':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/nosger?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;

		case 'patient_demstepcare_demstepcare':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/demstepcare?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;
		case 'patient_demstepcare_dsv':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/dsv?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;

//ISPC-2509 Lore 06.01.2020
		case 'patient_demstepcare_dscdsv':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/dscdsv?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;

		case 'patient_demstepcare_badl':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/badl?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;
		case 'patient_demstepcare_cmscale':
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="rubin/cmscale?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '</a>' . '</font>';
            break;
        //TODO-4035 Nico 12.04.2021
        case 'contactform_usershortcut':
            if(strlen($v_summary['recorddata'])){
                $json=json_decode($v_summary['recorddata'],1);
                if(is_array($json) && isset($json['html'])){
                    $v_summary['course_title']=$json['html'];
                }
            }
            break;
    }


	if ($v_summary['tabname'] == 'patient_rubin_mna_saved')
	{	
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}

	if ($v_summary['tabname'] == 'munster4new_pre_pdf')
	{	
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
 	if ($v_summary['tabname'] == 'munster4new_pdf')
	{	
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
 
	// ISPC-2432
	if ($v_summary['tabname'] == "mePatient_uploaded_img_from_device")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';"> ' . $v_summary['course_title'] . '</font>';
		}
	}


	//ISPC-2882 Ancuta 22.04.2021
	if ($v_summary['tabname'] == "anlage2_kinder_save")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/anlage2kinder?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>'.'</font>';
	}

	//ISPC-2921 Ancuta 28.05.2021 START
	if ($v_summary['tabname'] == "careplanning_form")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/careplanning?id=' . $pid . '&plan_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>'.'</font>';
	}
	if ($v_summary['tabname'] == "careplanning_save")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	//ISPC-2921 Ancuta 28.05.2021 END

	//ISPC-2909 Ancuta 01.06.2021 START
	if ($v_summary['tabname'] == "privatecontactform")
	{
		$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="patientformnew/privatecontactform?id=' . $pid . '&form_id='.$v_summary['recordid'].'">' . $v_summary['course_title'] . '.</a>'.'</font>';
	}
	if ($v_summary['tabname'] == "privatecontactform_save" || $v_summary['tabname'] == "privatecontactform_pdf")
	{
		if(!in_array($v_summary['recordid'],$this->delids_array))
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . '<a href="stats/patientfileupload?doc_id=' . $v_summary['recordid'] . '&id=' . $pid . '">' . $v_summary['course_title'] . '.</a>' . '</font>';
		}
		else
		{
			$v_summary['course_title'] = '<font color="#' . $v_summary['font_color'] . '" style="font-style:' . $v_summary['isitalic'] . ';font-weight:' . $v_summary['isbold'] . ';text-decoration:' . $v_summary['isunderline'] . ';">' . $v_summary['course_title'] . '</font>';
		}
	}
	//ISPC-2909 Ancuta 01.06.2021 END



	// LEAVE THIS AT THE BOTTOM
	if ($v_summary['alien'] == "1" && $v_summary['isserialized'] == 0 &&  !empty($v_summary['recorddata'])) {
		$v_summary['course_title'] .='<br/>'.$v_summary['recorddata']; 
	}
 


	if($remoteclass){
		$v_summary ['course_title'] = SystemsSync::removeCourseLinks ( $v_summary ['course_title']);
	}

	if($shared && !$remoteclass){
		$v_summary ['course_title'] = PatientCourse::remove_course_links ( $v_summary ['course_title']);
	}


?>
					<div class="iefourth row clearer ListOuter <?php echo $letterclass; ?>">
							<div>
								<div class="colleft2_inpwid " style="display: none;">
									<input type="checkbox" name="wrong[<?php echo $v_summary['id']; ?>]" class="block_<?php echo $blockcounter; ?>"
										id="<?php echo $v_summary['id']; ?>" value="1" <?php echo $wrongcheck; ?> /> <input type="hidden" value="<?php echo $course_type;  ?>"
										id="course_type_<?php echo $v_summary['id']; ?>" name="courses_types[]" class="courses_types_<?php echo $blockcounter; ?>"
										rel="<?php echo $v_summary['recordid']; ?>" /> &nbsp;
								</div>
								<div class="LeftChar greyfontclass wrc_<?php echo $blockcounter; ?>" id="wrc_<?php echo $v_summary['id'];  ?>" <?php if(strlen($v_summary['font_color']) > 0 && $v_summary['font_color'] != "ffffff"):?> style="background: #<?php echo $v_summary['font_color'];  ?>;" <?php endif; ?>><?php echo $v_summary['course_type'];  ?>
								</div>
								<div class="iesix colRight2 greyfontclass wrt_<?php echo $blockcounter; ?>" id="wrt_<?php echo $v_summary['id'];  ?>"><?php echo $v_summary['course_title'];  ?></div>
								<div class="clearer"></div>

								<input type="hidden" name="oldcolor" id="old_<?php echo $v_summary['id'];  ?>" value="<?php echo $v_summary['font_color'];  ?>" />
							</div>
						</div>
					<?php endforeach;  ?>
				<?php endif;  ?>
				<div class="clearer"></div>
						<div class="ListCourseSumm" id="wrongcomment_<?php echo $blockcounter; ?>"><?php echo $this->escape($v_course['wrongcomment']);  ?></div>
					</div>
					<div class="clearer"></div>
				</div>
			</div>
<?php $blockcounter++;  ?>
<?php endforeach; ?>
</div>
<?php
if ($this->verlauf_facebook_load == 'y' && $_REQUEST['page'] <= $this->max_pages && $_REQUEST['page'] != '0'):
	if (empty($_REQUEST['page'])):
		$page = '1';
	else:
		$_REQUEST['page']++;
		$page = $_REQUEST['page'];
	endif;
?>
		<?php if($this->max_pages != '0'):  ?>
		<div class="navigation" id="navigation">
			<a href="patientcourse/patientcourse?id=<?php echo $_REQUEST['id']; ?>&page=<?php echo $page; ?>&mod=minimal" class="next_link_button"></a>
		</div>
		<?php endif;  ?>
<?php endif;  ?>

		<div class="ClrBoth"></div>

	<?php if($this->verlauf_sort_type == 'b'):  ?>
		<form action="<?php echo $this->act ?>" method="post" name="frmcourse" id="frmcourse" autocomplete="off">
			<input type="hidden" id="1" name="triggerformid" value="1" />

			<div class="ListNew" style="display:<?php echo $this->coursestyle ?>" id="ListNew">
				<div class="LeftContent01 left" id="focusdate">
					<?php echo $this->curr_date ?>
				</div>
				<div class="RightContent01 left">
					<span class="err">
						<?php echo $this->error_shortcut; ?>
						<?php echo $this->error_date; ?>
					</span>

					<?php echo $this->gridcoursetaks; ?>
				</div>
				<div class="ClrBoth"></div>
				<div class="ClrBoth"></div>
				<p>
					<input type="button" name="btnsubmit" id="btnsubmit-save-b" value="<?php echo $this->translate('save') ?>" class="button"
						onclick="checkdischargednew('frmcourse')">
				</p>
			</div>
		</form>
	<?php endif;  ?>
 	<div class="verlauf_bar verlauf_bar_bottom">
			<ul>
				<li class="verlauf_li_name"></li>
				<li class="verlauf_li_scroll"><a href="javascript:scroll(0,0)" id="btmscroll"><span>Zum Anfang der Seite scrollen</span><img
						src="<?php echo RES_FILE_PATH;  ?>/images/top.png" alt="" /></a></li>
				<li class="verlauf_li_filter_apply"><a href="javascript:void(0)" id="verlauf_filter_apply_bottom" class="verlauf_filter_apply"
					title="<?php echo $this->translate('Apply user filter')?>"><img src="<?php echo RES_FILE_PATH;  ?>/images/filter_apply.png" /><input
						type="hidden" id="filter_apply" value="" /></a></li>
				<li class="verlauf_li_filter_remove"><a href="javascript:void(0)" id="verlauf_filter_remove_bottom" class="verlauf_filter_remove"
					title="<?php echo $this->translate('Remove user filter')?>"><img src="<?php echo RES_FILE_PATH;  ?>/images/filter_remove.png" /><input
						type="hidden" id="filter_remove" value="" /></a></li>
				<li class="verlauf_li_filter"><a href="javascript:void(0)" id="verlauf_filter_options_bottom"><span><?php echo $this->translate('Add filter')?></span><img
						class="filter_display_img" src="<?php echo RES_FILE_PATH;  ?>/images/filter_add.png" /><input type="hidden" id="filter_block_bt_int" value="" /></a></li>
				<!-- <li class="verlauf_li_filter"><a href="javascript:void(0)" id="verlauf_filter_options_bottom"><span><?php echo $this->translate('Add filter')?></span><img src="<?php echo RES_FILE_PATH;  ?>/images/filter_add.png" /><input type="hidden" id="filter_block_bt_int" value="" /></a></li>-->
				<li class="verlauf_li_print"><a href="patientcourse/printcourse?id=<?echo $this->pid ?>" target="_blank"><span><?php echo $this->translate('Verlauf print')?></span><img
						src="<?php echo RES_FILE_PATH;  ?>/images/print.gif" /></a></li>
			</ul>
		</div>

		<div class="CheckBoxes filter_block_bt" style="display:<?php echo $this->style ?>">
			<div class="listcoursechecks_main_div">

				<?php
				$cntr = '1';
				foreach($this->course_checks_arr as $k_course_chk=> $v_course_chk):

                    //what is this $chkcntr and $view ??? did not removed maybe i'm wrong..
                    if (isset($view) && is_object($view)) {
                        $chkcntr = $view->checkcounter;
                    } else {
                        $chkcntr = 0;
                    }

					$ischecked="";
					$isbold = "";
					$isitalic = '';
					$isunderline = '';
					$cheks = 0;

					if($v_course_chk['chk'] ==1)
					{
					  $ischecked = "checked='checked'";
					  $cheks = 1;
					}

					 if($v_course_chk['isbold']==1)
					 {
					   $isbold = "bold";
					 }

					 if($v_course_chk['isitalic']==1)
					 {
					   $isitalic = "italic";
					 }

					 if($v_course_chk['isunderline']==1)
					 {
					   $isunderline = "underline";
					 }
				?>
					<label> <input name="<?php echo $v_course_chk['cletter'];  ?>" id="cletter_<?php echo $cntr; ?>" type="checkbox" class="course_filter" value="1"
					onclick="checkboxurl(this,0); save_filter(this)" <?php echo $ischecked; ?> /> <font color="#<?php echo $v_course_chk['font_color']; ?>" style="font-style:<?php echo $isitalic; ?>; font-weight:<?php echo $isbold; ?>; text-decoration:<?php echo $isunderline; ?>;"><?php echo $v_course_chk['ctype'];  ?></font>
				</label>
				<?php $cntr++; endforeach;  ?>
				<label> <input name="wrong" id="wrong" type="checkbox" value="1" class="course_filter" onclick="checkboxurl(this,1); save_filter(this)"
					<?php echo $ischecked; ?> />
					<?php echo $this->translate('wrongfilter') ?>
				</label>
			</div>

			<div class="listcoursechecks_main_div">
				<?php if($this->hasSharedShortcuts):  ?>
				<label> <input name="_shared" id="shared" type="checkbox" value="1" onclick="checkboxurl(this,0)" /> <font><?php echo $this->translate('hide_owned_entryes');  ?></font>
				</label>
				<?php endif;  ?>
			</div>
			<div class="listcoursechecks_main_div">
				<?php if($this->hasSharedShortcuts):  ?>
				<label> <input name="_owned" id="shared" type="checkbox" value="1" onclick="checkboxurl(this,0)" /> <font><?php echo $this->translate('hide_other_client_entryes');  ?></font>
				</label>
				<?php endif;  ?>
			</div>
		</div>
		<div class="shortcutlist">
		<?php echo $this->cshortcuts ?>
	</div>
	</div>
</div>

<script type="text/javascript">
		var callcheck2 = <?php echo $this->callcheck2 ?>;

		<?php if($this->verlauf_sort_type == 'b'): ?>
		$('html,body').animate({scrollTop: $("#btmscroll").offset().top}, 500, 'easeOutCubic');
		<?php endif; ?>
		
 		//ISPC-2604 Ancuta 21.10.20202 	
		$(document).ready(function(){
			
			$(document).off('click',".goToVblock").on('click',".goToVblock", function(){
				var goDate = $(this).data('go2date');
				
				var blocs = $('#ListBox').find('.course_date_sep');
				
				$.each(blocs, function() {
					var block = $(this)[0];
					var inputs = $(block).find('span');
					$.each(inputs, function() {
						if( $(this).attr('rel') == goDate) {
				 			$("html, body") .animate({
		 				        scrollTop: $(this).offset().top - 100
		 				    } );
						}
					})
				});
			})
			
			
		});
 		// --
 

</script>

<div id="modal_delete">
	<p id="delete_medis" style="display: none;">
		<?php echo $this->translate('medis_redirect'); ?>
	</p>
	<p id="delete_diag" style="display: none;">
		<?php echo $this->translate('diag_redirect'); ?>
	</p>
	
	<p id="delete_xbdt_action" style="display: none;">
		<?php echo $this->translate('xbdt_action_redirect'); ?>
	</p>
	<p id="delete_medis_diag" style="display: none;"></p>
	<input type="hidden" value="" id="modal_redir_type" name="modal_redir_type" />
</div>
<input type="hidden" value="<?php echo $this->pid; ?>" id="patientid" />

<div id="delete_btm_med">
	<p>
		<?php echo $this->translate('revert_btm_medi_to_source'); ?>
		<input type="hidden" name="btm_medi_revert" value="" id="btm_medi_revert" />
	</p>
</div>