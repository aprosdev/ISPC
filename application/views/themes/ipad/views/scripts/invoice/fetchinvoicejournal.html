<input type="hidden" id="current_page" value="<?php echo $this->current_page?>" />
<input type="hidden" id="sortby" value="<?php echo $this->orderby?>" />
<input type="hidden" id="sortdir" value="<?php echo $this->sort?>" />
<?php
	$patient_details = $this->patient_details;


$sh_internal_invoice = $this->sh_internal_invoice_status;
?>
<table class="invoice_journal_list datatable">
	<thead>
		<tr>
			<th  class="col-0 columns" >
				<span class="thtitle"><?php echo $this->translate('#'); ?></span>
				<span class="colsorting">

				</span>
			</th>
			<th  class="col-1 columns" >
				<span class="thtitle"><?php echo $this->translate('invoice_number') ?></span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_nr" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_nr" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
			<th  class="col-2 columns" >
				<span class="thtitle"><?php echo $this->translate('invoice_date') ?></span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_date" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_date" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
			<th  class="col-3 columns" >
				<span class="thtitle"><?php echo $this->translate('invoice_status_type') ?> * </span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_stype" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_stype" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
			
			<?php if($sh_internal_invoice != "only_sh_internal") :?>
			<th  class="col-4 columns" >
				<span class="thtitle"><?php echo $this->translate('invoice_hi_name') ?></span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_hi" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_hi" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
			<?php endif; ?>
			
			<?php if($sh_internal_invoice == "include_sh_internal"):?>
			
			<th  class="col-5 columns" >
				<span class="thtitle"><?php echo $this->translate('invoice_patient or user') ?></span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_pat" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_pat" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
			
			<?php elseif($sh_internal_invoice == "only_sh_internal"):?>
			<th  class="col-5 columns" >
				<span class="thtitle"><?php echo $this->translate('invoice_user_sh') ?></span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_user" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_user" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
			
			<?php else:?>
			<th  class="col-5 columns" >
				<span class="thtitle"><?php echo $this->translate('invoice_patient') ?></span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_pat" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_pat" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
			<?php endif; ?>
			<!-- ISPC-2312 Lore 08.12.2020 -->
			<th  class="col-5 columns" >
				<span class="thtitle"><?php echo $this->translate('birthd') ?></span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_birthd" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_birthd" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
			<th  class="col-6 columns" >
				<span class="thtitle"><?php echo $this->translate('invoice_type') ?></span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_type" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_type" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
			<th  class="col-7 columns" >
				<span class="thtitle"><?php echo $this->translate('invoice_amount') ?></span>
				<span class="colsorting">
					<a href="javascript: void(0)" class="inv_journal_sort colsortasc" rel="inv_amount" title="asc"><img  src="<?php echo RES_FILE_PATH; ?>/images/up-arrow.png" alt="" /></a>
					<a href="javascript: void(0)"  class="inv_journal_sort colsortdesc" rel="inv_amount" title="desc"><img  src="<?php echo RES_FILE_PATH; ?>/images/down-arrow.png" alt="" /></a>
				</span>
			</th>
		</tr>
	</thead>
	<tbody>
		<?php if($this->master_invoices_data):  ?>
			<?php $i=1; foreach($this->master_invoices_data as $k_inv => $v_inv):  ?>
			<tr>
				<td class="col-0">
					<?php echo $i;  ?>
				</td>
				<td class="col-1">
					<?php
					if ($v_inv['inv_type'] == 'client_invoices')
					{
					       $link = APP_BASE . 'invoice/editinvoice?invoiceid=' . $v_inv['id'] . '&pdfquick=1';
					}
					if ($v_inv['inv_type'] == 'bayern_invoices')
					{
					       $link = APP_BASE . 'invoice/editbayerninvoice?invoiceid=' . $v_inv['id'] . '&pdf=1';
					}
					else if ($v_inv['inv_type'] == 'hi_invoice')
					{
						$link = APP_BASE . 'invoice/healthinsuranceinvoices?invoiceid='.$v_inv['id'].'&pdfquick=1';
					}
					else if ($v_inv['inv_type'] == 'u_invoice')
					{
						$link = APP_BASE . 'invoice/clientusersinvoices?invoiceid='.$v_inv['id'].'&pdfquick=1';
					}
					else if ($v_inv['inv_type'] == 'bw_invoice')
					{
					       $link = APP_BASE . 'invoice/performancerecord?iid=' . $v_inv['id'] . '&mode=pdfs&pdfquick=1';
					}
					else if ($v_inv['inv_type'] == 'bre_invoice')
					{
					       $link = APP_BASE . 'patientform/bresapvperformance?iid=' . $v_inv['id'] . '&mode=pdfs&pdfquick=1';
					}
					else if ($v_inv['inv_type'] == 'bre_hospiz_invoices')
					{
						if($v_inv['storno'] != '1')
						{
							$link = APP_BASE . 'invoice/editbrehospizsapvinvoice?invoiceid=' . $v_inv['id'] . '&pdf=1';
						}
						else
						{
							$link = APP_BASE . 'invoice/editbrehospizsapvinvoice?invoiceid=' . $v_inv['id'] . '&pdf=1&stornopdf=1';
						}
					}
					else if ($v_inv['inv_type'] == 'sgbv_invoice')
					{
					       $link = APP_BASE . 'invoice/socialcoderecord?iid=' . $v_inv['id'] . '&mode=pdfs&pdfquick=1';
					}
					else if ($v_inv['inv_type'] == 'medipumps_invoice')
					{
						$link = APP_BASE . 'invoice/medipumpscontrol?iid='.$v_inv['id'].'&mode=pdfs&pdfquick=1&single='.$v_inv['t_type'];
					}
					else if ($v_inv['inv_type'] == 'he_invoice')
					{
						$link = APP_BASE . 'invoice/editheinvoice?invoiceid='.$v_inv['id'].'&&pdf=1';
					}
					else if ($v_inv['inv_type'] == 'sgbxi_invoice')
					{
						$link = APP_BASE . 'invoice/sgbxiinvoice?iid=' . $v_inv['id'] . '&mode=pdfs&pdfquick=1';
					}
					else if ($v_inv['inv_type'] == "sh_invoice")
					{
						$link = APP_BASE.'invoicenew/shanlage14invoice?iid=' . $v_inv['id'] . '&only_invoice=1&patient='.$v_inv['epid'].'&sapvid='.$v_inv['sapv'].'&type=pdf';
					}
					else if ($v_inv['inv_type'] == "bayern_invoices_new")
					{
						$link = APP_BASE.'invoicenew/bayernsapvinvoice?iid=' . $v_inv['id'] . '&only_invoice=1&patient='.$v_inv['epid'].'&sapvid='.$v_inv['sapv'].'&type=pdf';
					}
					else if ($v_inv['inv_type'] == "sh_internal_invoice")
					{
						if($v_inv['storno'] != '1')
						{
							$link = APP_BASE.'invoicenew/shinternalinvoice?iid=' . $v_inv['id'] . '&only_invoice=1&user='.$v_inv['user'].'&list='.date('Y-m', strtotime($v_inv['invoice_date'])).'&type=pdf';
						}	else {
							$link = APP_BASE.'invoicenew/shinternalinvoice?iid=' . $v_inv['id'] . '&only_invoice=1&user='.$v_inv['user'].'&list='.date('Y-m', strtotime($v_inv['invoice_date'])).'&stornopdf=1&stornoid='.$v_inv['record_id'].'&type=pdf';
						}
					}
					?>
					<a href="<?php echo $link;  ?>"><?php echo $v_inv['prefix'].' '. $v_inv['invoice_nr'];  ?></a>
				</td>
				<td class="col-2">
					<?php if($v_inv['completed_date'] != '0000-00-00 00:00:00' || date('Y-m-d', strtotime($v_inv['completed_date'])) != '1970-01-01'): echo date('d.m.Y', strtotime($v_inv['completed_date'])); else: echo " - ";  endif; ?>
				</td>
				<td class="col-3">
					<a href="javascript:void(0);" class="<?php if($v_inv['storno'] == '0'): ?>set_storno<?php else: ?>del_storno<?php endif; ?>" rel="<?php echo $v_inv['inv_type'].'-'.$v_inv['id'];  ?><?php if($v_inv['storno'] == '1'): ?>-1<?php endif; ?>" title="<?php echo $v_inv['invoice_number'];  ?>" >
					<?php if ($v_inv['storno'] == 0): ?>
						<?php echo $this->translate('non_storno'); ?>
					<?php else: ?>
						<?php echo $this->translate('storno'); ?>
					<?php endif; ?>
					</a>

				</td>
				<?php if($sh_internal_invoice != "only_sh_internal") :?>
				<td>
					<?php echo $v_inv['health_insurance'];  ?>
				</td>
				<?php endif; ?>
				
				
				
				<td>
					<?php echo $v_inv['user_name'];	?>
					<?php echo $v_inv['patient_name'];?>
				</td>
				<!-- ISPC-2312 Lore 08.12.2020 -->
				<td> <?php echo $v_inv['birthd']; ?></td>
				
				<td><?php echo $v_inv['invoice_type_translated'];  ?></td>
				<td class="col-7"><?php echo number_format($v_inv['invoice_total'], '2', ',', '.'); $total += $v_inv['invoice_total'];  ?> &euro;&nbsp;&nbsp;</td>
			</tr>
			<?php $i++; endforeach;  ?>
		<?php else:  ?>
			<tr>
				<td colspan="<?php if($sh_internal_invoice == "only_sh_internal") :?> 8 <? else: ?> 9 <? endif;?>" >
					<?php echo $this->translate('no_results_found');  ?>
				</td>
			</tr>
		<?php endif;  ?>
			<tr>
				<td colspan="<?php if($sh_internal_invoice == "only_sh_internal") :?> 7 <? else: ?>8 <? endif;?>" class="journal_footer_row">
					<?php echo $this->translate('journal_total_ammount');  ?>&nbsp;&nbsp;
				</td>
				<td class="journal_footer_row_sum">
					<?php echo number_format($total, '2', ',', '.');  ?>&nbsp;&euro;&nbsp;&nbsp;
				</td>
			</tr>
	</tbody>

</table>
