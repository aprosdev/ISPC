<?php
	 $this->headLink()->appendStylesheet(RES_FILE_PATH.'/css/page-css/muster2b.css');

	$this->headScript ()->appendFile (RES_FILE_PATH . '/javascript/dateUtil.js');
	$this->headScript()->appendFile(RES_FILE_PATH.'/javascript/autogrow/jquery.elastic.js');
	$this->headScript()->appendFile(RES_FILE_PATH.'/javascript/jquery.blockUI.js');

?>
<script type="text/javascript">
$(document).ready(function() {
	
	$('.stamp_alert').hide();
	
	/*----------------------------------------------------------------------------------------------------------*/
	/*---------------------------------------- Stamp Info ------------------------------------------------------*/
		/*----------------------------------------------------------------------------------------------------------*/
		$('#stampusers').live('change', function() {
			$('#user_stamp_block span').replaceWith('');
			$('#user_stamp_block textarea').replaceWith('');

			$.get(appbase + 'ajax/userstampinfo?stamp-info=' + $(this).val(), function(result) {

				if (result != 0) {
					var resultx = jQuery.parseJSON(result);

					var user_lanr = resultx.lanr;
					var user_bsnr = resultx.bsnr;

					/*$('#Veror63_NameBetrinInpt').val(user_bsnr);
					$('#Veror63_NamearztnInpt').val(user_lanr);*/

					$('#user_stamp_block span').replaceWith('');
					$('#user_stamp_block textarea').replaceWith('');

					var row1 = resultx.row1;
					var row2 = resultx.row2;
					var row3 = resultx.row3;
					var row4 = resultx.row4;
					var row5 = resultx.row5;
					var row6 = resultx.row6;
					var row7 = resultx.row7;

					var user_stamp = '<span>' + row1 + '<br/>' + row2 + '<br/>' + row3 + '<br/>' + row4 + '<br/>' + row5 + '<br/>' + row6 + '<br/>' + row7 + '</span>';
					var user_stamp_hidden = '<textarea name="stamp_block" style="display: none">' + row1 + '<br/>' + row2 + '<br/>' + row3 + '<br/>' + row4 + '<br/>' + row5 + '<br/>' + row6 + '<br/>' + row7 + '</textarea>';

					$('#user_stamp_block').append(user_stamp + user_stamp_hidden);


				} else {
					$('.stamp_alert').show('fast').delay(1000).hide('slow');
				}

			});
			return false;
		});
	
		/* ==================================textarea 1 ====================================== */
// 		var maximus_input_1  = 76;
		var maximus_input_1  = 55;
		var text_length1 = 0;
		var text_remaining1 = 0;
			 
		var nr_text1 = $('#accessible_hospitals').val().length;
		var text_max1 = maximus_input_1;
		var	text_max1 = maximus_input_1 - nr_text1;
		
		//console.log("t1maxallowed: "+maximus_input_1+" current:"+nr_text1+" text_max:"+text_max1);
		
		if(text_max1 < 0 )
		{
			$('#textarea_feedback1').html((-text_max1 )+ ' <?php echo $this->translate('characters over limit') ?>');	
			$('#textarea_feedback1').css("color", "red");
		}
		else
		{
			$('#textarea_feedback1').html(text_max1 + ' <?php echo $this->translate('characters remaining') ?>');
			$('#textarea_feedback1').css("color", "green");
		}
		    
		$('#accessible_hospitals').keyup(function(){
			text_length1 = $('#accessible_hospitals').val().length;
			text_remaining1 = maximus_input_1 - text_length1;

			if(text_remaining1 <0)
		    {
				$('#textarea_feedback1').html((-text_remaining1)+ ' <?php echo $this->translate('characters over limit') ?>');
				$('#textarea_feedback1').css("color", "red");	
			}
			else
			{
				$('#textarea_feedback1').html(text_remaining1 + ' <?php echo $this->translate('characters remaining') ?>');
				$('#textarea_feedback1').css("color", "green");
			}
		});

		/*----------------------------------------------------------------------------------------------------------*/
		
		/* ==================================textarea 2 ====================================== */
// 		var maximus_input_2  = 330;
		var maximus_input_2  = 275;
		var text_length2 = 0;
		var text_remaining2 = 0;
			 
		var nr_text2 = $('#relevante_diagnoses').val().length;
		var text_max2 = maximus_input_2;
		var	text_max2 = maximus_input_2 - nr_text2;
		
		//console.log("t2maxallowed: "+maximus_input_2+" current:"+nr_text2+" text_max:"+text_max2);
		
		if(text_max2 < 0 )
		{
			$('#textarea_feedback2').html((-text_max2 )+ ' <?php echo $this->translate('characters over limit') ?>');	
			$('#textarea_feedback2').css("color", "red");
		}
		else
		{
			$('#textarea_feedback2').html(text_max2 + ' <?php echo $this->translate('characters remaining') ?>');
			$('#textarea_feedback2').css("color", "green");
		}
		    
		$('#relevante_diagnoses').keyup(function(){
			text_length2 = $('#relevante_diagnoses').val().length;
			text_remaining2 = maximus_input_2 - text_length2;

			if(text_remaining2 <0)
		    {
				$('#textarea_feedback2').html((-text_remaining2)+ ' <?php echo $this->translate('characters over limit') ?>');
				$('#textarea_feedback2').css("color", "red");	
			}
			else
			{
				$('#textarea_feedback2').html(text_remaining2 + ' <?php echo $this->translate('characters remaining') ?>');
				$('#textarea_feedback2').css("color", "green");
			}
		});

		/*----------------------------------------------------------------------------------------------------------*/

		/* ==================================textarea 3 ====================================== */
// 		var maximus_input_3  = 430;
		var maximus_input_3  = 360;
		var text_length3 = 0;
		var text_remaining3 = 0;
			 
		var nr_text3 = $('#investigation_results').val().length;
		var text_max3 = maximus_input_3;
		var	text_max3 = maximus_input_3 - nr_text3;
		
		//console.log("t3maxallowed: "+maximus_input_3+" current:"+nr_text3+" text_max:"+text_max3);
		
		if(text_max3 < 0 )
		{
			$('#textarea_feedback3').html((-text_max3 )+ ' <?php echo $this->translate('characters over limit') ?>');	
			$('#textarea_feedback3').css("color", "red");
		}
		else
		{
			$('#textarea_feedback3').html(text_max3 + ' <?php echo $this->translate('characters remaining') ?>');
			$('#textarea_feedback3').css("color", "green");
		}
		    
		$('#investigation_results').keyup(function(){
			text_length3 = $('#investigation_results').val().length;
			text_remaining3 = maximus_input_3 - text_length3;

			if(text_remaining3 <0)
		    {
				$('#textarea_feedback3').html((-text_remaining3)+ ' <?php echo $this->translate('characters over limit') ?>');
				$('#textarea_feedback3').css("color", "red");	
			}
			else
			{
				$('#textarea_feedback3').html(text_remaining3 + ' <?php echo $this->translate('characters remaining') ?>');
				$('#textarea_feedback3').css("color", "green");
			}
		});

		/*----------------------------------------------------------------------------------------------------------*/

		/* ==================================textarea 4 ====================================== */
// 		var maximus_input_4  = 300;
		var maximus_input_4  = 180;
		var text_length4 = 0;
		var text_remaining4 = 0;
			 
		var nr_text4 = $('#measures_to_date').val().length;
		var text_max4 = maximus_input_4;
		var	text_max4 = maximus_input_4 - nr_text4;
		
		//console.log("t4maxallowed: "+maximus_input_4+" current:"+nr_text4+" text_max:"+text_max4);
		
		if(text_max4 < 0 )
		{
			$('#textarea_feedback4').html((-text_max4 )+ ' <?php echo $this->translate('characters over limit') ?>');	
			$('#textarea_feedback4').css("color", "red");
		}
		else
		{
			$('#textarea_feedback4').html(text_max4 + ' <?php echo $this->translate('characters remaining') ?>');
			$('#textarea_feedback4').css("color", "green");
		}
		    
		$('#measures_to_date').keyup(function(){
			text_length4 = $('#measures_to_date').val().length;
			text_remaining4 = maximus_input_4 - text_length4;

			if(text_remaining4 <0)
		    {
				$('#textarea_feedback4').html((-text_remaining4)+ ' <?php echo $this->translate('characters over limit') ?>');
				$('#textarea_feedback4').css("color", "red");	
			}
			else
			{
				$('#textarea_feedback4').html(text_remaining4 + ' <?php echo $this->translate('characters remaining') ?>');
				$('#textarea_feedback4').css("color", "green");
			}
		});

		/*----------------------------------------------------------------------------------------------------------*/

		/* ==================================textarea 5 ====================================== */
		var maximus_input_5  = 180;
		var text_length5 = 0;
		var text_remaining5 = 0;
			 
		var nr_text5 = $('#other_notes').val().length;
		var text_max5 = maximus_input_5;
		var	text_max5 = maximus_input_5 - nr_text5;
		
		//console.log("t5maxallowed: "+maximus_input_5+" current:"+nr_text5+" text_max:"+text_max5);
		
		if(text_max5 < 0 )
		{
			$('#textarea_feedback5').html((-text_max5 )+ ' <?php echo $this->translate('characters over limit') ?>');	
			$('#textarea_feedback5').css("color", "red");
		}
		else
		{
			$('#textarea_feedback5').html(text_max5 + ' <?php echo $this->translate('characters remaining') ?>');
			$('#textarea_feedback5').css("color", "green");
		}
		    
		$('#other_notes').keyup(function(){
			text_length5 = $('#other_notes').val().length;
			text_remaining5 = maximus_input_5 - text_length5;

			if(text_remaining5 <0)
		    {
				$('#textarea_feedback5').html((-text_remaining5)+ ' <?php echo $this->translate('characters over limit') ?>');
				$('#textarea_feedback5').css("color", "red");	
			}
			else
			{
				$('#textarea_feedback5').html(text_remaining5 + ' <?php echo $this->translate('characters remaining') ?>');
				$('#textarea_feedback5').css("color", "green");
			}
		});

		/*----------------------------------------------------------------------------------------------------------*/

		
		/* ==================================textarea 6 ====================================== */
		var maximus_input_6  = 200;
		var maximus_input_6  = 180;
		var text_length6 = 0;
		var text_remaining6 = 0;
			 
		var nr_text6 = $('#submitted_results').val().length;
		var text_max6 = maximus_input_6;
		var	text_max6 = maximus_input_6 - nr_text6;
		
		//console.log("t6maxallowed: "+maximus_input_6+" current:"+nr_text6+" text_max:"+text_max6);
		
		if(text_max6 < 0 )
		{
			$('#textarea_feedback6').html((-text_max6 )+ ' <?php echo $this->translate('characters over limit') ?>');	
			$('#textarea_feedback6').css("color", "red");
		}
		else
		{
			$('#textarea_feedback6').html(text_max6 + ' <?php echo $this->translate('characters remaining') ?>');
			$('#textarea_feedback6').css("color", "green");
		}
		    
		$('#submitted_results').keyup(function(){
			text_length6 = $('#submitted_results').val().length;
			text_remaining6 = maximus_input_6 - text_length6;

			if(text_remaining6 <0)
		    {
				$('#textarea_feedback6').html((-text_remaining6)+ ' <?php echo $this->translate('characters over limit') ?>');
				$('#textarea_feedback6').css("color", "red");	
			}
			else
			{
				$('#textarea_feedback6').html(text_remaining6 + ' <?php echo $this->translate('characters remaining') ?>');
				$('#textarea_feedback6').css("color", "green");
			}
		});

		/*----------------------------------------------------------------------------------------------------------*/

		$('.form_btnsubmit').click(function(event) {
			event.preventDefault();
			var error = 0;
			var text1 = $('#accessible_hospitals').val().length;
			var text2 = $('#relevante_diagnoses').val().length;
			var text3 = $('#investigation_results').val().length;
			var text4 = $('#measures_to_date').val().length;
			var text5 =	$('#other_notes').val().length;
			var text6 =	$('#submitted_results').val().length;
			
			if(text1 > 76)
			{
				alert("<?php  echo $this->translate('You have reached your maximum limit of characters allowed ' ) ?> Nächsterreichbare, geeignete Krankenhäuser" );
				error++;
			}
			
			if(text2 > 330)
			{
				alert("<?php  echo $this->translate('You have reached your maximum limit of characters allowed ' ) ?> Diagnose" );
				error++;
			}
							
			if(text3 > 430){
				alert("<?php  echo $this->translate('You have reached your maximum limit of characters allowed ' ) ?> Untersuchungsergebnisse" );
				error++;
			}			
						
			if(text4 > 300){
				alert("<?php  echo $this->translate('You have reached your maximum limit of characters allowed ' ) ?> Bisherige Maßnahmen(z.B. Medikation)" );
				error++;
			}
			
			if(text5 > 180){
				alert("<?php  echo $this->translate('You have reached your maximum limit of characters allowed ' ) ?> Fragestellung/Hinwise(z.B. Allergie)" );
				error++;
			}
			
			if(text6 > 200){
				alert("<?php  echo $this->translate('You have reached your maximum limit of characters allowed ' ) ?> Mitgegeben Befunde" );
				error++;
			}
			
				setTimeout(function () {$('input[type=submit], input[type=button]').attr('disabled', true);}, 150);
				setTimeout(function () {$('input[type=submit], input[type=button]').attr('disabled', false);}, 12000);
				 var status = $(this).attr('rel');
				$('#post_status').val(status);
	
				if(status == 'save'){
	
				 } else{
	
				 }
				
				if(error == 0)
				{
				$('#muster2b').submit();
				}
		});

	
});

</script>
<form id="muster2b" action="" method="post">
  <div id="CalImg" style="display: none;"> <img id="calImg" src="<? echo RES_FILE_PATH;  ?>/images/calendar.png" alt="Popup" class="trigger"> </div>
  <? echo $this->patientinfo ?>
  <? echo $this->tabmenus ?>
  <div class="tab_container">
	
<div id="muster2b">
<div id="muster2b_main" class="pallnetz_topform">
	<label id="muster2b_Kraner" for="Krankenkasse">Krankenkasse bzw. Kostenträger</label> <br />
    
		<input id="muster2b_KraneInpt" name="krankenkasse" value="<? echo $this->insurance_company_name ?>" class="insurnace"  type="text" /> 
		<div class="blackline"></div>
        <div id="muster2b_NameVorVer" class="formleftdiv">
        <label id="muster2b_NameVorVeOuter" for="Name">Name, Vorname des Versicherten</label><br />
		<textarea name="patient_name" id="muster2b_NameVorVeInpt" cols="45" rows="2" class="textArea"><? echo $this->patientname ?></textarea></div>
		<div id="muster2b_NameGeb" class="formrightdiv" ><label id="muster2b_NameGeLbl" for="geb">geb. am</label><br />
        <input type="text" name="geb" id="muster2b_NameGeInpt" value="<? echo $this->birthdate ?>" /></div>
		<div class="ClrBoth"></div><br /><div class="blackline" id="muster2b_NameBlckLine"></div>
        <div id="muster2b_NameKassnr" class="formShortDiv">
		<label id="muster2b_NameKassnLbl" for="Kassen-Nr.">Kostenträgerkennung</label><br />
		<input name="kassen_nr" type="text" id="muster2b_NameKassnInpt" value="<? echo $this->kvnumber ?>" /></div>
		<div class="VerLine" id="muster2b_NameVerline"></div>
        <div class="formShortDiv" id="muster2b_NameVerNr">
        <label for="Versicherten-Nr" id="muster2b_NameVerNTxt">Versicherten-Nr.</label><br />
        <input id="muster2b_NameVerNInpt" name="versicherten_nr" type="text" value="<? echo $this->insurance_no ?>" /></div>
        <div class="VerLine" id="muster2b_NameVerlin2"></div>
        <div id="muster2b_NameStatus" class="formShortDiv">
        <label id="muster2b_NameStatuLbl" for="Status">Status</label><br />
        <input name="status" id="muster2b_NameStatInpt" type="text" value="<? echo $this->insurance_status ?>"  /></div><div class="ClrBoth"></div>
        <div class="blackline" id="muster2b_NameBlacLine"></div>
        <div class="formShortDiv" id="muster2b_NameBetrinr">
        <label id="muster2b_NameBetrinLbl" for="Vertragsarzt-Nr.">Betriebsstätten-Nr.</label><br />
        <input name="betriebsstatten_nr" id="muster2b_NameBetrinInpt" type="text" value="<? echo $this->betriebsstatten_nr ?>" /></div><div id="muster2b_NameVerlin3" class="VerLine"></div>
        <div id="muster2b_Namearztnr" class="formShortDiv">
        <label id="muster2b_NamearztnLbl" for="VK gültig bis">Arzt-Nr.</label>
        <br />
        <input id="muster2b_NamearztnInpt" name="arzt_nr" type="text" value="<? echo $this->arzt_nr?>"  /></div>	
        <div class="VerLine" id="muster2b_NameaVerline"></div>
        <div id="muster2b_NameDatum" class="formShortDiv"><label id="muster2b_NameDatuLbl" for="Datum">Datum</label><br /><input name="topdatum" id="muster2b_NameDatuInpt" type="text" value="<? echo date('d.m.Y')?>" /></div>
        </div>
        <div class="Pallnetz_RightHeadingDiv">
        <div class="leftheading"><h2><strong>Verordnung von<br />
            Krankenhausbehandlung</strong></h2></div>
        <div class="rightheading"><h2><strong>2</strong></h2></div>
                    <div class="ClrBoth"></div>
         <div style="width:100%;"><h3 style=" font-style:italic; color: #000;">(Nur bei medizinischer Notwendigkeit zulässig)</h3></div>
            <div class="verorRightDiv">
            <div class="veror50">
            <input type="checkbox" name="physician_treatment" value="1" size="2" <? if($this->physician_treatment == '1'): ?> checked="checked" <? endif;  ?>/>
            <label>Belegarzt-behandlung</label>
            </div>
            <div class="veror50">
            <input type="checkbox" name="emergency" value="1" size="2" <? if($this->emergency == '1'): ?> checked="checked" <? endif;  ?>/>
            <label>Notfall</label>
            </div>
            </div>
            <div class="verorRightDiv">
            <div class="veror50">
            <input type="checkbox" name="accident_accidental" value="1" size="2" <? if($this->accident_accidental == '1'): ?> checked="checked" <? endif;  ?>/>
            <label>Unfall, Unfallfolgen</label>
            </div>
            <div class="veror50">
            <input type="checkbox" name="service_related_injury" value="1" size="2" <? if($this->service_related_injury == '1'): ?> checked="checked" <? endif;  ?>/>
            <label>Versorgungs-<br />leiden(BVG)</label>
            </div>
            </div>
            <div class="ClrBoth"></div>
            <br />
            <br />
            <div class="verorrightbox">
            	<table style="width: 100%">
       				<tr>
       					<td style="width: 95%;"><h3 style="color:#000; font-weight: normal; margin-left: 5px;">Nächsterreichbare, geeignete Krankenhäuser</h3></td>
       				</tr>
       				<tr>
       					<td><textarea name="accessible_hospitals" id="accessible_hospitals" cols="" rows="1"><? echo $this->accessible_hospitals; ?></textarea></td>
       				</tr>
       			</table>
       		<div id="textarea_feedback1"></div>
           </div>
           </div>
           <div class="ClrBoth"></div><br />
       		
       		<div id="muster2b_main" class="pallnetz_middleform">
       		
       		<div class="verContentOuter">
       			<table style="width: 100%">
       				<tr>
       					<td style="width: 95%;"><h3 style="color:#000; font-weight: normal; margin-left: 5px;">Diagnose</h3></td>
       				</tr>
       				<tr>
       					<td><textarea id="relevante_diagnoses" name="relevante_diagnoses" cols="" rows="7"><? if($this->relevante_diagnoses): echo $this->relevante_diagnoses; else: echo $this->relevante_Input; endif; ?></textarea></td>
       				</tr>
       			</table>
       		<div id="textarea_feedback2" style="width: 50%; float: left"></div><div id="textarea_feedback2red" style="width: 50%; float: left"></div>
       		</div>
       		</div>
       		<div class="Pallnetz_RightmiddleDiv">
       	 		<div class="verorbottombox" style="height:160px;">
  					<div class="stamp_alert"><?php echo $this->translate("no stamp information")?></div>
  					<div id="user_stamp_block" style="display: block; height: 110px;">
  						<span></span>
  					</div>
  				</div>
  				<div style="margin-left: 10px; height: 21px;">Vertragsarztstempel/Unterschrift des Arztes</div>  			
			</div>
       		<div class="ClrBoth"></div>
       		<div style="width: 370; float: left;"></div>
       		<?php if ($this->showselect == 1): ?>
				<?php if($this->multiplestamps_option === true): ?>
					<div style="width: 340; float:right;">
						<label>Arztstempel</label>
						<select id="stampusers" name="stampusers">
						<option value=""><?php echo $this->translate('selectuserstamp')?></option>
						<?php foreach($this->users_mstamps as $user=>$stamp):?>
						 <optgroup label="<?php echo $stamp['user_name'];?>" value="<?php echo $stamp['user_id'];?>">
						 	<?php foreach( $stamp['user_stamps'] as $stamp_id => $stamp_name):?>
						 		<option value="<?php echo $stamp['user_id'];?>-<?php echo $stamp_id;?>" ><?php echo $stamp_name;?></option>
						 	<?php endforeach;?>
						 </optgroup>
						<?php endforeach;?>
						</select>
					</div>
				<?php else: ?>
				<div style="width: 340; float: right;">
					<label>Arztstempel</label>
				<?php echo $this->formSelect('stampusers', $this->users, null, $this->users); ?>
				</div>
			<?php endif; ?>

			<?php endif; ?>
       		
       		<div class="ClrBoth"></div><br />
       <div class="container_middle">
       		<table style="width: 100%;">
       			<tr>
       				<td class="underlinedtd"></td>
       			</tr>
       			<tr>
       				<td style="height: 30px; padding-left: 20px; vertical-align: middle;"><h3 style="font-style:italic; color: #000;">Bitte dem Patienten gesondert mitgeben!</h3></td>
       			</tr>
       			</table>
       </div>  
 
       <div class="ClrBoth"></div>
	   <div class="container_bottom">       		
       		<div class="verContentOuter">
       			<table style="width: 100%">
       				<tr>
       					<td style="width: 95%;"><h3 style="color:#000; font-weight: normal; margin-left: 5px;">Untersuchungsergebnisse</h3></td>
       				</tr>
       				<tr>
       					<td><textarea id="investigation_results" name="investigation_results" cols="" rows="3"><? echo $this->investigation_results; ?></textarea></td>
       				</tr>
       			</table>
       			<div id="textarea_feedback3"></div>
       		</div>
    	</div>
	   <div class="ClrBoth"></div>
	   <div class="container_bottom">       		
       		<div class="verContentOuter">
       			<table style="width: 100%">
       				<tr>
       					<td style="width: 95%;"><h3 style="color:#000; font-weight: normal; margin-left: 5px;">Bisherige Maßnahmen(z.B. Medikation)</h3></td>
       				</tr>
       				<tr>
       					<td><textarea id="measures_to_date" name="measures_to_date" cols="" rows="3"><? echo $this->measures_to_date; ?></textarea></td>
       				</tr>
       			</table>
       		<div id="textarea_feedback4"></div>	
       		</div>
    	</div>
    	<div class="ClrBoth"></div>
	   <div class="container_bottom">       		
       		<div class="verContentOuter">
       			<table style="width: 100%">
       				<tr>
       					<td style="width: 95%;"><h3 style="color:#000; font-weight: normal; margin-left: 5px;">Fragestellung/Hinwise(z.B. Allergie)</h3></td>
       				</tr>
       				<tr>
       					<td><textarea id="other_notes" name="other_notes" cols="" rows="3"><? echo $this->other_notes; ?></textarea></td>
       				</tr>
       			</table>
       			<div id="textarea_feedback5"></div>
       		</div>
       		</div>
       		
       		<div class="ClrBoth"></div>
	   <div class="container_bottom">       		
       		<div class="verContentOuter">
       			<table style="width: 100%">
       				<tr>
       					<td style="width: 95%;"><h3 style="color:#000; font-weight: normal; margin-left: 5px;">Mitgegeben Befunde</h3></td>
       				</tr>
       				<tr>
       					<td><textarea id="submitted_results" name="submitted_results" cols="" rows="3"><? echo $this->submitted_results; ?></textarea></td>
       				</tr>
       			</table>
       			<div id="textarea_feedback6"></div>
       		</div>
    	</div>
    	
    	<div class="ClrBoth"></div>
    	<div class="closediv"></div>

    	<div class="ClrBoth"></div><br />
    	<div class="bottomdiv"><h3 style="color:#000; font-weight: normal; margin-left: 5px;">Ausfertigung für Krankenhausarzt! Vertraulich!</h3></div>
    	

  <div class="ClrBoth"></div><br />
  <input type="hidden" name="saved_id" value="<?php echo $this->id;  ?>"/>
  <input type="hidden" name="post_status"  id="post_status" value=""/>
  <input type="submit" name="save"          rel="save"          id="btnsubmit_save"         value="<?php echo $this->translate('save'); ?>"  class="form_btnsubmit btnsubmit_usersessions" />
  <input type="submit" name="pdf_print"     rel="pdf_print"     id="pdf_btnsubmit"     value="<?php echo $this->translate('PDF erstellen und unter Dokumente ablegen') ?>"  class="form_btnsubmit btnsubmit_usersessions" />
  <input type="submit" name="pdf_pre_print" rel="pdf_pre_print" id="pdf_pre_btnsubmit" value="<?php echo $this->translate('generatepdf pre') ?>"  class="form_btnsubmit btnsubmit_usersessions" />
  <?php if($this->id): ?>
  	<input type="submit" name="reset" rel="reset" id="reset" value="<?php echo $this->translate('reset and create new instance') ?>"  class="form_btnsubmit btnsubmit_usersessions" />
  <?php endif;?>
  
  </div></div>
</form>

<!--  form_files -->
<?php if(!empty($this->muster_files_history)):?>
	<fieldset>
		<legend><?php echo $this->translate('muster_files_history'); ?></legend>
		<?php if(!empty($this->muster_files_history)):?>
			<table class="datatable">
				<tr>
					<th>#</th>
					<th><?php echo $this->translate('title'); ?></th>
					<th><?php echo $this->translate('user'); ?></th>
					<th class="date_col"><?php echo $this->translate('date'); ?></th>
				</tr>
				<?php $i = 1;
				foreach ($this->muster_files_history as $k_contact_file => $muster_file): ?>
					<tr>
						<td><a href="<?php echo APP_BASE . 'stats/patientfileupload?doc_id='.$muster_file['id'].'&id='.$_REQUEST['id'];?>"><?php echo $i; ?></a></td>
						<td><a href="<?php echo APP_BASE . 'stats/patientfileupload?doc_id='.$muster_file['id'].'&id='.$_REQUEST['id'];?>"><?php echo $muster_file['title']; ?></a></td>
						<td><a href="<?php echo APP_BASE . 'stats/patientfileupload?doc_id='.$muster_file['id'].'&id='.$_REQUEST['id'];?>"><?php echo $this->users_data[$muster_file['create_user']]['user_title'].' '.$this->users_data[$muster_file['create_user']]['last_name'].', '.$this->users_data[$muster_file['create_user']]['first_name']; ?></a></td>
						<td><a href="<?php echo APP_BASE . 'stats/patientfileupload?doc_id='.$muster_file['id'].'&id='.$_REQUEST['id'];?>"><?php echo date('d.m.Y H:i', strtotime($muster_file['create_date'])); ?></a></td>
					</tr>
				<?php $i++; endforeach; ?>
			</table>
		<?php else:?>
		<table class="datatable">
			<tr>
				<td colspan="4"><?php echo $this->translate('no_muster_history_found');?></td>
			</tr>
		</table>
		<?php endif;?>
		
	</fieldset>
<?php endif;?>
