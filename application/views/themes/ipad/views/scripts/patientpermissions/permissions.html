<script type="text/javascript">

	function checkedall(allid)
	{

		hdn = document.getElementsByName('hiddmodid[]');
		if(allid.name=='can_add[]')
		{
			if(allid.checked==true)
			{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('canadd['+hdn[i].value+']'))
					{
						document.getElementsByName('canadd['+hdn[i].value+']')[0].checked = true;
					}
				}
			}else{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('canadd['+hdn[i].value+']'))
					{
						document.getElementsByName('canadd['+hdn[i].value+']')[0].checked = false;
					}
				}
			}
		}

		if(allid.name=='can_edit[]')
		{
			if(allid.checked==true)
			{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('canedit['+hdn[i].value+']'))
					{
						document.getElementsByName('canedit['+hdn[i].value+']')[0].checked = true;
					}
				}
			}else{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('canedit['+hdn[i].value+']'))
					{
						document.getElementsByName('canedit['+hdn[i].value+']')[0].checked = false;
					}
				}
			}
		}
		if(allid.name=='can_delete[]')
		{
			if(allid.checked==true)
			{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('candelete['+hdn[i].value+']'))
					{
						document.getElementsByName('candelete['+hdn[i].value+']')[0].checked = true;
					}
				}
			}else{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('candelete['+hdn[i].value+']'))
					{
						document.getElementsByName('candelete['+hdn[i].value+']')[0].checked = false;
					}
				}
			}
		}
		if(allid.name=='can_view[]')
		{
			if(allid.checked==true)
			{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('canview['+hdn[i].value+']'))
					{
						document.getElementsByName('canview['+hdn[i].value+']')[0].checked = true;
					}
				}
			}else{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('canview['+hdn[i].value+']'))
					{
						document.getElementsByName('canview['+hdn[i].value+']')[0].checked = false;
					}
				}
			}
		}
	}
	function checkedall_m(allid)
	{

		hdn = document.getElementsByName('m_hiddmodid[]');
		if(allid.name=='m_can_add[]')
		{
			if(allid.checked==true)
			{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('m_canadd['+hdn[i].value+']'))
					{
						document.getElementsByName('m_canadd['+hdn[i].value+']')[0].checked = true;
					}
				}
			}else{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('m_canadd['+hdn[i].value+']'))
					{
						document.getElementsByName('m_canadd['+hdn[i].value+']')[0].checked = false;
					}
				}
			}
		}

		if(allid.name=='m_can_edit[]')
		{
			if(allid.checked==true)
			{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('m_canedit['+hdn[i].value+']'))
					{
						document.getElementsByName('m_canedit['+hdn[i].value+']')[0].checked = true;
					}
				}
			}else{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('m_canedit['+hdn[i].value+']'))
					{
						document.getElementsByName('m_canedit['+hdn[i].value+']')[0].checked = false;
					}
				}
			}
		}
		if(allid.name=='m_can_delete[]')
		{
			if(allid.checked==true)
			{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('m_candelete['+hdn[i].value+']'))
					{
						document.getElementsByName('m_candelete['+hdn[i].value+']')[0].checked = true;
					}
				}
			}else{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('m_candelete['+hdn[i].value+']'))
					{
						document.getElementsByName('m_candelete['+hdn[i].value+']')[0].checked = false;
					}
				}
			}
		}
		if(allid.name=='m_can_view[]')
		{
			if(allid.checked==true)
			{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('m_canview['+hdn[i].value+']'))
					{
						document.getElementsByName('m_canview['+hdn[i].value+']')[0].checked = true;
					}
				}
			}else{
				for(i=0; i<hdn.length;i++)
				{
					if(document.getElementsByName('m_canview['+hdn[i].value+']'))
					{
						document.getElementsByName('m_canview['+hdn[i].value+']')[0].checked = false;
					}
				}
			}
		}
	}
</script>
<Br />
<form action="" method="post" name="frmuser" id="frmuser" >
	<div id="user_group_error" class="err"><? echo $this->error_message ?></div>
	<table width="30%">
		<tr >
			<td colspan="2" valign="top">&nbsp;</td>
		</tr>
		 </table>
	<div class="grid">
		<table class="datatable" border="0">
			<tr>
				<th>ID</th>
				<th><? echo $this->translate('modulename')?></th>
				<th><input name="can_view[]" type="checkbox" onclick="checkedall(this)" value="" />&nbsp;<? echo $this->translate("canview"); ?></th>
				<th><input name="can_edit[]" type="checkbox" onclick="checkedall(this)" value="" />&nbsp;<? echo $this->translate("canedit"); ?></th>
			</tr>
			<?php echo $this->menusgrid; ?>
			<tr>
				<td colspan="4" valign="top">
					<a class="button"  href="patientnew/patientdetails?id=<?php echo $_REQUEST['id']; ?>" style="padding: 0;"><?php echo $this->translate('backtolist') ?></a>
				<input name="submit" id="submit" type="submit" class="button" value="<? echo $this->translate('submit')?>" />
				</td>
			</tr>
		</table>
	</div>
</form>
<form action="" method="post" name="frmuser" id="frmuser2" >
	<div class="grid">

		<table class="datatable" border="0">

			<tr>
				<th>#</td>
				<th><? echo $this->translate('modulename') ?></th>
				<th><input name="m_can_view[]" type="checkbox" onclick="checkedall_m(this)" value="" />&nbsp;<? echo $this->translate("canview"); ?></th>
				<th><input name="m_can_edit[]" type="checkbox" onclick="checkedall_m(this)" value="" />&nbsp;<? echo $this->translate("canedit"); ?></th>
			</tr>
			<?
			$count = 1;
			$varcount = 0;
			foreach ($this->misc_modules as $key => $val)
			{
				$misc_perms = $this->misc_modules_perms;

				if($misc_perms[$val['id']]['disabled'] != '1'):
				?>
				<tr class="row">
					<td valign="top"><?= $count ?> <input type="hidden" value="1" id="misc_modules" name="misc_modules" /> </td>

					<td valign="top"><?= $this->translate($val['module']) ?>
						<input type="hidden" name="m_hiddmodid[]" id="hdnmoduleid" value="<?= $val['id'] ?>"  />
					</td>

					<td valign="top">
						<input name="m_canview[<?= $val['id'] ?>]" type="checkbox" value="1" <? if ($misc_perms[$val['id']]['canview'] == '1') { echo 'checked="checked"'; } ?> />
					</td>

					<td valign="top">
						<input name="m_canedit[<?= $val['id'] ?>]" type="checkbox" value="1" <? if ($misc_perms[$val['id']]['canedit'] == '1') { echo 'checked="checked"'; } ?> />
					</td>
				</tr>
			<? $count++;$varcount++; endif; } ?>
			<?php if($varcount != '0'):  ?>
			<tr>
				<td colspan="4" valign="top" align="left">
					<a class="button"  href="groupdefault/clientgroupmasterlist" style="padding: 0;"><?php echo $this->translate('backtolist') ?></a>
					<input name="submit" id="submit" type="submit" class="button" value="<? echo $this->translate('submit') ?>" />
				</td>
			</tr>
			<?php else:  ?>
			<tr>
				<td colspan="4" valign="top" align="left">
					<?php echo $this->translate('no_misc_modules');  ?>
				</td>
			</tr>
			<?php endif;  ?>
		</table>
	</div>
</form>